


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > TypeUtils</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.alibaba.fastjson2.util</a>
</div>

<h1>Coverage Summary for Class: TypeUtils (com.alibaba.fastjson2.util)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">TypeUtils</td>
<td class="coverageStat">
  <span class="percent">
    11.1%
  </span>
  <span class="absValue">
    (5/45)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    10.8%
  </span>
  <span class="absValue">
    (161/1488)
  </span>
</td>
</tr>
  <tr>
    <td class="name">TypeUtils$Cache</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    13%
  </span>
  <span class="absValue">
    (6/46)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    10.9%
  </span>
  <span class="absValue">
    (162/1489)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.alibaba.fastjson2.util;
&nbsp;
&nbsp;import com.alibaba.fastjson2.*;
&nbsp;import com.alibaba.fastjson2.reader.*;
&nbsp;
&nbsp;import java.lang.reflect.*;
&nbsp;import java.math.BigDecimal;
&nbsp;import java.math.BigInteger;
&nbsp;import java.time.*;
&nbsp;import java.util.*;
&nbsp;import java.util.concurrent.*;
&nbsp;import java.util.concurrent.atomic.AtomicBoolean;
&nbsp;import java.util.concurrent.atomic.AtomicInteger;
&nbsp;import java.util.concurrent.atomic.AtomicLong;
&nbsp;import java.util.concurrent.atomic.AtomicReferenceFieldUpdater;
&nbsp;import java.util.function.Function;
&nbsp;
<b class="fc">&nbsp;public class TypeUtils {</b>
&nbsp;    public static final Class CLASS_JSON_OBJECT_1x;
&nbsp;    public static final Field FIELD_JSON_OBJECT_1x_map;
&nbsp;    public static final Class CLASS_JSON_ARRAY_1x;
&nbsp;
<b class="fc">&nbsp;    public static final Class CLASS_SINGLE_SET = Collections.singleton(1).getClass();</b>
<b class="fc">&nbsp;    public static final Class CLASS_SINGLE_List = Collections.singletonList(1).getClass();</b>
<b class="fc">&nbsp;    public static final Class CLASS_UNMODIFIABLE_COLLECTION = Collections.unmodifiableCollection(new ArrayList&lt;&gt;()).getClass();</b>
<b class="fc">&nbsp;    public static final Class CLASS_UNMODIFIABLE_LIST = Collections.unmodifiableList(new ArrayList&lt;&gt;()).getClass();</b>
<b class="fc">&nbsp;    public static final Class CLASS_UNMODIFIABLE_SET = Collections.unmodifiableSet(new HashSet&lt;&gt;()).getClass();</b>
<b class="fc">&nbsp;    public static final Class CLASS_UNMODIFIABLE_SORTED_SET = Collections.unmodifiableSortedSet(new TreeSet&lt;&gt;()).getClass();</b>
<b class="fc">&nbsp;    public static final Class CLASS_UNMODIFIABLE_NAVIGABLE_SET = Collections.unmodifiableNavigableSet(new TreeSet&lt;&gt;()).getClass();</b>
&nbsp;
&nbsp;    public static double parseDouble(byte[] in, int off, int len) throws NumberFormatException {
<b class="nc">&nbsp;        boolean isNegative = false;</b>
<b class="nc">&nbsp;        boolean signSeen = false;</b>
&nbsp;        int decExp;
&nbsp;        byte c;
<b class="nc">&nbsp;        int end = off + len;</b>
&nbsp;
&nbsp;        parseNumber:
&nbsp;        try {
&nbsp;            // throws NullPointerException if null
<b class="nc">&nbsp;            if (len == 0) {</b>
<b class="nc">&nbsp;                throw new NumberFormatException(&quot;empty String&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            int i = off;</b>
<b class="nc">&nbsp;            switch (in[i]) {</b>
&nbsp;                case &#39;-&#39;:
<b class="nc">&nbsp;                    isNegative = true;</b>
&nbsp;                case &#39;+&#39;:
<b class="nc">&nbsp;                    i++;</b>
<b class="nc">&nbsp;                    signSeen = true;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            char[] digits = new char[len];</b>
&nbsp;
<b class="nc">&nbsp;            int nDigits = 0;</b>
<b class="nc">&nbsp;            boolean decSeen = false;</b>
<b class="nc">&nbsp;            int decPt = 0;</b>
<b class="nc">&nbsp;            int nLeadZero = 0;</b>
<b class="nc">&nbsp;            int nTrailZero = 0;</b>
&nbsp;
&nbsp;            skipLeadingZerosLoop:
<b class="nc">&nbsp;            while (i &lt; end) {</b>
<b class="nc">&nbsp;                c = in[i];</b>
<b class="nc">&nbsp;                if (c == &#39;0&#39;) {</b>
<b class="nc">&nbsp;                    nLeadZero++;</b>
<b class="nc">&nbsp;                } else if (c == &#39;.&#39;) {</b>
<b class="nc">&nbsp;                    if (decSeen) {</b>
<b class="nc">&nbsp;                        throw new NumberFormatException(&quot;multiple points&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decPt = i - off;</b>
<b class="nc">&nbsp;                    if (signSeen) {</b>
<b class="nc">&nbsp;                        decPt -= 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decSeen = true;</b>
&nbsp;                } else {
&nbsp;                    break skipLeadingZerosLoop;
&nbsp;                }
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
&nbsp;            digitLoop:
<b class="nc">&nbsp;            while (i &lt; end) {</b>
<b class="nc">&nbsp;                c = in[i];</b>
<b class="nc">&nbsp;                if (c &gt;= &#39;1&#39; &amp;&amp; c &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                    digits[nDigits++] = (char) c;</b>
<b class="nc">&nbsp;                    nTrailZero = 0;</b>
<b class="nc">&nbsp;                } else if (c == &#39;0&#39;) {</b>
<b class="nc">&nbsp;                    digits[nDigits++] = (char) c;</b>
<b class="nc">&nbsp;                    nTrailZero++;</b>
<b class="nc">&nbsp;                } else if (c == &#39;.&#39;) {</b>
<b class="nc">&nbsp;                    if (decSeen) {</b>
<b class="nc">&nbsp;                        throw new NumberFormatException(&quot;multiple points&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decPt = i - off;</b>
<b class="nc">&nbsp;                    if (signSeen) {</b>
<b class="nc">&nbsp;                        decPt -= 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decSeen = true;</b>
&nbsp;                } else {
&nbsp;                    break digitLoop;
&nbsp;                }
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
<b class="nc">&nbsp;            nDigits -= nTrailZero;</b>
&nbsp;
<b class="nc">&nbsp;            boolean isZero = (nDigits == 0);</b>
<b class="nc">&nbsp;            if (isZero &amp;&amp; nLeadZero == 0) {</b>
<b class="nc">&nbsp;                break parseNumber; // go throw exception</b>
&nbsp;            }
<b class="nc">&nbsp;            if (decSeen) {</b>
<b class="nc">&nbsp;                decExp = decPt - nLeadZero;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                decExp = nDigits + nTrailZero;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if ((i &lt; end) &amp;&amp; (((c = in[i]) == &#39;e&#39;) || (c == &#39;E&#39;))) {</b>
<b class="nc">&nbsp;                int expSign = 1;</b>
<b class="nc">&nbsp;                int expVal = 0;</b>
<b class="nc">&nbsp;                int reallyBig = Integer.MAX_VALUE / 10;</b>
<b class="nc">&nbsp;                boolean expOverflow = false;</b>
<b class="nc">&nbsp;                switch (in[++i]) {</b>
&nbsp;                    case &#39;-&#39;:
<b class="nc">&nbsp;                        expSign = -1;</b>
&nbsp;                    case &#39;+&#39;:
<b class="nc">&nbsp;                        i++;</b>
&nbsp;                }
<b class="nc">&nbsp;                int expAt = i;</b>
&nbsp;                expLoop:
<b class="nc">&nbsp;                while (i &lt; end) {</b>
<b class="nc">&nbsp;                    if (expVal &gt;= reallyBig) {</b>
<b class="nc">&nbsp;                        expOverflow = true;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    c = in[i++];</b>
<b class="nc">&nbsp;                    if (c &gt;= &#39;0&#39; &amp;&amp; c &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                        expVal = expVal * 10 + ((int) c - (int) &#39;0&#39;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        i--;           // back up.</b>
<b class="nc">&nbsp;                        break expLoop; // stop parsing exponent.</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                int expLimit = FloatingDecimal.BIG_DECIMAL_EXPONENT + nDigits + nTrailZero;</b>
<b class="nc">&nbsp;                if (expOverflow || (expVal &gt; expLimit)) {</b>
<b class="nc">&nbsp;                    decExp = expSign * expLimit;</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    decExp = decExp + expSign * expVal;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (i == expAt) {</b>
<b class="nc">&nbsp;                    break parseNumber; // certainly bad</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (i &lt; end &amp;&amp; (i != end - 1)) {</b>
<b class="nc">&nbsp;                break parseNumber; // go throw exception</b>
&nbsp;            }
<b class="nc">&nbsp;            if (isZero) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            return doubleValue(isNegative, decExp, digits, nDigits);</b>
<b class="nc">&nbsp;        } catch (StringIndexOutOfBoundsException e) {</b>
&nbsp;        }
<b class="nc">&nbsp;        throw new NumberFormatException(&quot;For input string: \&quot;&quot; + new String(in, off, len) + &quot;\&quot;&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static double parseDouble(char[] in, int off, int len) throws NumberFormatException {
<b class="nc">&nbsp;        boolean isNegative = false;</b>
<b class="nc">&nbsp;        boolean signSeen = false;</b>
&nbsp;        int decExp;
&nbsp;        char c;
<b class="nc">&nbsp;        int end = off + len;</b>
&nbsp;
&nbsp;        parseNumber:
&nbsp;        try {
&nbsp;            // throws NullPointerException if null
<b class="nc">&nbsp;            if (len == 0) {</b>
<b class="nc">&nbsp;                throw new NumberFormatException(&quot;empty String&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            int i = off;</b>
<b class="nc">&nbsp;            switch (in[i]) {</b>
&nbsp;                case &#39;-&#39;:
<b class="nc">&nbsp;                    isNegative = true;</b>
&nbsp;                case &#39;+&#39;:
<b class="nc">&nbsp;                    i++;</b>
<b class="nc">&nbsp;                    signSeen = true;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            char[] digits = new char[len];</b>
&nbsp;
<b class="nc">&nbsp;            int nDigits = 0;</b>
<b class="nc">&nbsp;            boolean decSeen = false;</b>
<b class="nc">&nbsp;            int decPt = 0;</b>
<b class="nc">&nbsp;            int nLeadZero = 0;</b>
<b class="nc">&nbsp;            int nTrailZero = 0;</b>
&nbsp;
&nbsp;            skipLeadingZerosLoop:
<b class="nc">&nbsp;            while (i &lt; end) {</b>
<b class="nc">&nbsp;                c = in[i];</b>
<b class="nc">&nbsp;                if (c == &#39;0&#39;) {</b>
<b class="nc">&nbsp;                    nLeadZero++;</b>
<b class="nc">&nbsp;                } else if (c == &#39;.&#39;) {</b>
<b class="nc">&nbsp;                    if (decSeen) {</b>
<b class="nc">&nbsp;                        throw new NumberFormatException(&quot;multiple points&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decPt = i - off;</b>
<b class="nc">&nbsp;                    if (signSeen) {</b>
<b class="nc">&nbsp;                        decPt -= 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decSeen = true;</b>
&nbsp;                } else {
&nbsp;                    break skipLeadingZerosLoop;
&nbsp;                }
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
&nbsp;            digitLoop:
<b class="nc">&nbsp;            while (i &lt; end) {</b>
<b class="nc">&nbsp;                c = in[i];</b>
<b class="nc">&nbsp;                if (c &gt;= &#39;1&#39; &amp;&amp; c &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                    digits[nDigits++] = c;</b>
<b class="nc">&nbsp;                    nTrailZero = 0;</b>
<b class="nc">&nbsp;                } else if (c == &#39;0&#39;) {</b>
<b class="nc">&nbsp;                    digits[nDigits++] = c;</b>
<b class="nc">&nbsp;                    nTrailZero++;</b>
<b class="nc">&nbsp;                } else if (c == &#39;.&#39;) {</b>
<b class="nc">&nbsp;                    if (decSeen) {</b>
<b class="nc">&nbsp;                        throw new NumberFormatException(&quot;multiple points&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decPt = i - off;</b>
<b class="nc">&nbsp;                    if (signSeen) {</b>
<b class="nc">&nbsp;                        decPt -= 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decSeen = true;</b>
&nbsp;                } else {
&nbsp;                    break digitLoop;
&nbsp;                }
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
<b class="nc">&nbsp;            nDigits -= nTrailZero;</b>
&nbsp;
<b class="nc">&nbsp;            boolean isZero = (nDigits == 0);</b>
<b class="nc">&nbsp;            if (isZero &amp;&amp; nLeadZero == 0) {</b>
<b class="nc">&nbsp;                break parseNumber; // go throw exception</b>
&nbsp;            }
<b class="nc">&nbsp;            if (decSeen) {</b>
<b class="nc">&nbsp;                decExp = decPt - nLeadZero;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                decExp = nDigits + nTrailZero;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if ((i &lt; end) &amp;&amp; (((c = in[i]) == &#39;e&#39;) || (c == &#39;E&#39;))) {</b>
<b class="nc">&nbsp;                int expSign = 1;</b>
<b class="nc">&nbsp;                int expVal = 0;</b>
<b class="nc">&nbsp;                int reallyBig = Integer.MAX_VALUE / 10;</b>
<b class="nc">&nbsp;                boolean expOverflow = false;</b>
<b class="nc">&nbsp;                switch (in[++i]) {</b>
&nbsp;                    case &#39;-&#39;:
<b class="nc">&nbsp;                        expSign = -1;</b>
&nbsp;                    case &#39;+&#39;:
<b class="nc">&nbsp;                        i++;</b>
&nbsp;                }
<b class="nc">&nbsp;                int expAt = i;</b>
&nbsp;                expLoop:
<b class="nc">&nbsp;                while (i &lt; end) {</b>
<b class="nc">&nbsp;                    if (expVal &gt;= reallyBig) {</b>
<b class="nc">&nbsp;                        expOverflow = true;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    c = in[i++];</b>
<b class="nc">&nbsp;                    if (c &gt;= &#39;0&#39; &amp;&amp; c &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                        expVal = expVal * 10 + ((int) c - (int) &#39;0&#39;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        i--;           // back up.</b>
<b class="nc">&nbsp;                        break expLoop; // stop parsing exponent.</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                int expLimit = FloatingDecimal.BIG_DECIMAL_EXPONENT + nDigits + nTrailZero;</b>
<b class="nc">&nbsp;                if (expOverflow || (expVal &gt; expLimit)) {</b>
<b class="nc">&nbsp;                    decExp = expSign * expLimit;</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    decExp = decExp + expSign * expVal;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (i == expAt) {</b>
<b class="nc">&nbsp;                    break parseNumber; // certainly bad</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (i &lt; end &amp;&amp; (i != end - 1)) {</b>
<b class="nc">&nbsp;                break parseNumber; // go throw exception</b>
&nbsp;            }
<b class="nc">&nbsp;            if (isZero) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            return doubleValue(isNegative, decExp, digits, nDigits);</b>
<b class="nc">&nbsp;        } catch (StringIndexOutOfBoundsException e) {</b>
&nbsp;        }
<b class="nc">&nbsp;        throw new NumberFormatException(&quot;For input string: \&quot;&quot; + new String(in, off, len) + &quot;\&quot;&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static float parseFloat(byte[] in, int off, int len) throws NumberFormatException {
<b class="nc">&nbsp;        boolean isNegative = false;</b>
<b class="nc">&nbsp;        boolean signSeen = false;</b>
&nbsp;        int decExp;
&nbsp;        byte c;
<b class="nc">&nbsp;        int end = off + len;</b>
&nbsp;
&nbsp;        parseNumber:
&nbsp;        try {
&nbsp;            // throws NullPointerException if null
<b class="nc">&nbsp;            if (len == 0) {</b>
<b class="nc">&nbsp;                throw new NumberFormatException(&quot;empty String&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            int i = off;</b>
<b class="nc">&nbsp;            switch (in[i]) {</b>
&nbsp;                case &#39;-&#39;:
<b class="nc">&nbsp;                    isNegative = true;</b>
&nbsp;                case &#39;+&#39;:
<b class="nc">&nbsp;                    i++;</b>
<b class="nc">&nbsp;                    signSeen = true;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            char[] digits = new char[len];</b>
&nbsp;
<b class="nc">&nbsp;            int nDigits = 0;</b>
<b class="nc">&nbsp;            boolean decSeen = false;</b>
<b class="nc">&nbsp;            int decPt = 0;</b>
<b class="nc">&nbsp;            int nLeadZero = 0;</b>
<b class="nc">&nbsp;            int nTrailZero = 0;</b>
&nbsp;
&nbsp;            skipLeadingZerosLoop:
<b class="nc">&nbsp;            while (i &lt; end) {</b>
<b class="nc">&nbsp;                c = in[i];</b>
<b class="nc">&nbsp;                if (c == &#39;0&#39;) {</b>
<b class="nc">&nbsp;                    nLeadZero++;</b>
<b class="nc">&nbsp;                } else if (c == &#39;.&#39;) {</b>
<b class="nc">&nbsp;                    if (decSeen) {</b>
<b class="nc">&nbsp;                        throw new NumberFormatException(&quot;multiple points&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decPt = i - off;</b>
<b class="nc">&nbsp;                    if (signSeen) {</b>
<b class="nc">&nbsp;                        decPt -= 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decSeen = true;</b>
&nbsp;                } else {
&nbsp;                    break skipLeadingZerosLoop;
&nbsp;                }
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
&nbsp;            digitLoop:
<b class="nc">&nbsp;            while (i &lt; end) {</b>
<b class="nc">&nbsp;                c = in[i];</b>
<b class="nc">&nbsp;                if (c &gt;= &#39;1&#39; &amp;&amp; c &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                    digits[nDigits++] = (char) c;</b>
<b class="nc">&nbsp;                    nTrailZero = 0;</b>
<b class="nc">&nbsp;                } else if (c == &#39;0&#39;) {</b>
<b class="nc">&nbsp;                    digits[nDigits++] = (char) c;</b>
<b class="nc">&nbsp;                    nTrailZero++;</b>
<b class="nc">&nbsp;                } else if (c == &#39;.&#39;) {</b>
<b class="nc">&nbsp;                    if (decSeen) {</b>
<b class="nc">&nbsp;                        throw new NumberFormatException(&quot;multiple points&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decPt = i - off;</b>
<b class="nc">&nbsp;                    if (signSeen) {</b>
<b class="nc">&nbsp;                        decPt -= 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decSeen = true;</b>
&nbsp;                } else {
&nbsp;                    break digitLoop;
&nbsp;                }
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
<b class="nc">&nbsp;            nDigits -= nTrailZero;</b>
&nbsp;
<b class="nc">&nbsp;            boolean isZero = (nDigits == 0);</b>
<b class="nc">&nbsp;            if (isZero &amp;&amp; nLeadZero == 0) {</b>
<b class="nc">&nbsp;                break parseNumber; // go throw exception</b>
&nbsp;            }
<b class="nc">&nbsp;            if (decSeen) {</b>
<b class="nc">&nbsp;                decExp = decPt - nLeadZero;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                decExp = nDigits + nTrailZero;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if ((i &lt; end) &amp;&amp; (((c = in[i]) == &#39;e&#39;) || (c == &#39;E&#39;))) {</b>
<b class="nc">&nbsp;                int expSign = 1;</b>
<b class="nc">&nbsp;                int expVal = 0;</b>
<b class="nc">&nbsp;                int reallyBig = Integer.MAX_VALUE / 10;</b>
<b class="nc">&nbsp;                boolean expOverflow = false;</b>
<b class="nc">&nbsp;                switch (in[++i]) {</b>
&nbsp;                    case &#39;-&#39;:
<b class="nc">&nbsp;                        expSign = -1;</b>
&nbsp;                    case &#39;+&#39;:
<b class="nc">&nbsp;                        i++;</b>
&nbsp;                }
<b class="nc">&nbsp;                int expAt = i;</b>
&nbsp;                expLoop:
<b class="nc">&nbsp;                while (i &lt; end) {</b>
<b class="nc">&nbsp;                    if (expVal &gt;= reallyBig) {</b>
<b class="nc">&nbsp;                        expOverflow = true;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    c = in[i++];</b>
<b class="nc">&nbsp;                    if (c &gt;= &#39;0&#39; &amp;&amp; c &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                        expVal = expVal * 10 + ((int) c - (int) &#39;0&#39;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        i--;           // back up.</b>
<b class="nc">&nbsp;                        break expLoop; // stop parsing exponent.</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                int expLimit = FloatingDecimal.BIG_DECIMAL_EXPONENT + nDigits + nTrailZero;</b>
<b class="nc">&nbsp;                if (expOverflow || (expVal &gt; expLimit)) {</b>
<b class="nc">&nbsp;                    decExp = expSign * expLimit;</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    decExp = decExp + expSign * expVal;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (i == expAt) {</b>
<b class="nc">&nbsp;                    break parseNumber; // certainly bad</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (i &lt; end &amp;&amp; (i != end - 1)) {</b>
<b class="nc">&nbsp;                break parseNumber; // go throw exception</b>
&nbsp;            }
<b class="nc">&nbsp;            if (isZero) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            return floatValue(isNegative, decExp, digits, nDigits);</b>
<b class="nc">&nbsp;        } catch (StringIndexOutOfBoundsException e) {</b>
&nbsp;        }
<b class="nc">&nbsp;        throw new NumberFormatException(&quot;For input string: \&quot;&quot; + new String(in, off, len) + &quot;\&quot;&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static float parseFloat(char[] in, int off, int len) throws NumberFormatException {
<b class="nc">&nbsp;        boolean isNegative = false;</b>
<b class="nc">&nbsp;        boolean signSeen = false;</b>
&nbsp;        int decExp;
&nbsp;        char c;
<b class="nc">&nbsp;        int end = off + len;</b>
&nbsp;
&nbsp;        parseNumber:
&nbsp;        try {
&nbsp;            // throws NullPointerException if null
<b class="nc">&nbsp;            if (len == 0) {</b>
<b class="nc">&nbsp;                throw new NumberFormatException(&quot;empty String&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            int i = off;</b>
<b class="nc">&nbsp;            switch (in[i]) {</b>
&nbsp;                case &#39;-&#39;:
<b class="nc">&nbsp;                    isNegative = true;</b>
&nbsp;                case &#39;+&#39;:
<b class="nc">&nbsp;                    i++;</b>
<b class="nc">&nbsp;                    signSeen = true;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            char[] digits = new char[len];</b>
&nbsp;
<b class="nc">&nbsp;            int nDigits = 0;</b>
<b class="nc">&nbsp;            boolean decSeen = false;</b>
<b class="nc">&nbsp;            int decPt = 0;</b>
<b class="nc">&nbsp;            int nLeadZero = 0;</b>
<b class="nc">&nbsp;            int nTrailZero = 0;</b>
&nbsp;
&nbsp;            skipLeadingZerosLoop:
<b class="nc">&nbsp;            while (i &lt; end) {</b>
<b class="nc">&nbsp;                c = in[i];</b>
<b class="nc">&nbsp;                if (c == &#39;0&#39;) {</b>
<b class="nc">&nbsp;                    nLeadZero++;</b>
<b class="nc">&nbsp;                } else if (c == &#39;.&#39;) {</b>
<b class="nc">&nbsp;                    if (decSeen) {</b>
<b class="nc">&nbsp;                        throw new NumberFormatException(&quot;multiple points&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decPt = i - off;</b>
<b class="nc">&nbsp;                    if (signSeen) {</b>
<b class="nc">&nbsp;                        decPt -= 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decSeen = true;</b>
&nbsp;                } else {
&nbsp;                    break skipLeadingZerosLoop;
&nbsp;                }
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
&nbsp;            digitLoop:
<b class="nc">&nbsp;            while (i &lt; end) {</b>
<b class="nc">&nbsp;                c = in[i];</b>
<b class="nc">&nbsp;                if (c &gt;= &#39;1&#39; &amp;&amp; c &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                    digits[nDigits++] = c;</b>
<b class="nc">&nbsp;                    nTrailZero = 0;</b>
<b class="nc">&nbsp;                } else if (c == &#39;0&#39;) {</b>
<b class="nc">&nbsp;                    digits[nDigits++] = c;</b>
<b class="nc">&nbsp;                    nTrailZero++;</b>
<b class="nc">&nbsp;                } else if (c == &#39;.&#39;) {</b>
<b class="nc">&nbsp;                    if (decSeen) {</b>
<b class="nc">&nbsp;                        throw new NumberFormatException(&quot;multiple points&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decPt = i - off;</b>
<b class="nc">&nbsp;                    if (signSeen) {</b>
<b class="nc">&nbsp;                        decPt -= 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    decSeen = true;</b>
&nbsp;                } else {
&nbsp;                    break digitLoop;
&nbsp;                }
<b class="nc">&nbsp;                i++;</b>
&nbsp;            }
<b class="nc">&nbsp;            nDigits -= nTrailZero;</b>
&nbsp;
<b class="nc">&nbsp;            boolean isZero = (nDigits == 0);</b>
<b class="nc">&nbsp;            if (isZero &amp;&amp; nLeadZero == 0) {</b>
<b class="nc">&nbsp;                break parseNumber; // go throw exception</b>
&nbsp;            }
<b class="nc">&nbsp;            if (decSeen) {</b>
<b class="nc">&nbsp;                decExp = decPt - nLeadZero;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                decExp = nDigits + nTrailZero;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if ((i &lt; end) &amp;&amp; (((c = in[i]) == &#39;e&#39;) || (c == &#39;E&#39;))) {</b>
<b class="nc">&nbsp;                int expSign = 1;</b>
<b class="nc">&nbsp;                int expVal = 0;</b>
<b class="nc">&nbsp;                int reallyBig = Integer.MAX_VALUE / 10;</b>
<b class="nc">&nbsp;                boolean expOverflow = false;</b>
<b class="nc">&nbsp;                switch (in[++i]) {</b>
&nbsp;                    case &#39;-&#39;:
<b class="nc">&nbsp;                        expSign = -1;</b>
&nbsp;                    case &#39;+&#39;:
<b class="nc">&nbsp;                        i++;</b>
&nbsp;                }
<b class="nc">&nbsp;                int expAt = i;</b>
&nbsp;                expLoop:
<b class="nc">&nbsp;                while (i &lt; end) {</b>
<b class="nc">&nbsp;                    if (expVal &gt;= reallyBig) {</b>
<b class="nc">&nbsp;                        expOverflow = true;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    c = in[i++];</b>
<b class="nc">&nbsp;                    if (c &gt;= &#39;0&#39; &amp;&amp; c &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                        expVal = expVal * 10 + ((int) c - (int) &#39;0&#39;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        i--;           // back up.</b>
<b class="nc">&nbsp;                        break expLoop; // stop parsing exponent.</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                int expLimit = FloatingDecimal.BIG_DECIMAL_EXPONENT + nDigits + nTrailZero;</b>
<b class="nc">&nbsp;                if (expOverflow || (expVal &gt; expLimit)) {</b>
<b class="nc">&nbsp;                    decExp = expSign * expLimit;</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    decExp = decExp + expSign * expVal;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (i == expAt) {</b>
<b class="nc">&nbsp;                    break parseNumber; // certainly bad</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (i &lt; end &amp;&amp; (i != end - 1)) {</b>
<b class="nc">&nbsp;                break parseNumber; // go throw exception</b>
&nbsp;            }
<b class="nc">&nbsp;            if (isZero) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            return floatValue(isNegative, decExp, digits, nDigits);</b>
<b class="nc">&nbsp;        } catch (StringIndexOutOfBoundsException e) {</b>
&nbsp;        }
<b class="nc">&nbsp;        throw new NumberFormatException(&quot;For input string: \&quot;&quot; + new String(in, off, len) + &quot;\&quot;&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static double doubleValue(boolean isNegative, int decExp, char[] digits, int nDigits) {
<b class="nc">&nbsp;        int kDigits = Math.min(nDigits, FloatingDecimal.MAX_DECIMAL_DIGITS + 1);</b>
&nbsp;
<b class="nc">&nbsp;        int iValue = (int) digits[0] - (int) &#39;0&#39;;</b>
<b class="nc">&nbsp;        int iDigits = Math.min(kDigits, FloatingDecimal.INT_DECIMAL_DIGITS);</b>
<b class="nc">&nbsp;        for (int i = 1; i &lt; iDigits; i++) {</b>
<b class="nc">&nbsp;            iValue = iValue * 10 + (int) digits[i] - (int) &#39;0&#39;;</b>
&nbsp;        }
<b class="nc">&nbsp;        long lValue = (long) iValue;</b>
<b class="nc">&nbsp;        for (int i = iDigits; i &lt; kDigits; i++) {</b>
<b class="nc">&nbsp;            lValue = lValue * 10L + (long) ((int) digits[i] - (int) &#39;0&#39;);</b>
&nbsp;        }
<b class="nc">&nbsp;        double dValue = (double) lValue;</b>
<b class="nc">&nbsp;        int exp = decExp - kDigits;</b>
&nbsp;
<b class="nc">&nbsp;        if (nDigits &lt;= FloatingDecimal.MAX_DECIMAL_DIGITS) {</b>
<b class="nc">&nbsp;            if (exp == 0 || dValue == 0.0) {</b>
<b class="nc">&nbsp;                return (isNegative) ? -dValue : dValue; // small floating integer</b>
<b class="nc">&nbsp;            } else if (exp &gt;= 0) {</b>
<b class="nc">&nbsp;                if (exp &lt;= FloatingDecimal.MAX_SMALL_TEN) {</b>
<b class="nc">&nbsp;                    double rValue = dValue * FloatingDecimal.SMALL_10_POW[exp];</b>
<b class="nc">&nbsp;                    return (isNegative) ? -rValue : rValue;</b>
&nbsp;                }
<b class="nc">&nbsp;                int slop = FloatingDecimal.MAX_DECIMAL_DIGITS - kDigits;</b>
<b class="nc">&nbsp;                if (exp &lt;= FloatingDecimal.MAX_SMALL_TEN + slop) {</b>
<b class="nc">&nbsp;                    dValue *= FloatingDecimal.SMALL_10_POW[slop];</b>
<b class="nc">&nbsp;                    double rValue = dValue * FloatingDecimal.SMALL_10_POW[exp - slop];</b>
<b class="nc">&nbsp;                    return (isNegative) ? -rValue : rValue;</b>
&nbsp;                }
<b class="nc">&nbsp;            } else {</b>
<b class="nc">&nbsp;                if (exp &gt;= -FloatingDecimal.MAX_SMALL_TEN) {</b>
<b class="nc">&nbsp;                    double rValue = dValue / FloatingDecimal.SMALL_10_POW[-exp];</b>
<b class="nc">&nbsp;                    return (isNegative) ? -rValue : rValue;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (exp &gt; 0) {</b>
<b class="nc">&nbsp;            if (decExp &gt; FloatingDecimal.MAX_DECIMAL_EXPONENT + 1) {</b>
<b class="nc">&nbsp;                return (isNegative) ? Double.NEGATIVE_INFINITY : Double.POSITIVE_INFINITY;</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((exp &amp; 15) != 0) {</b>
<b class="nc">&nbsp;                dValue *= FloatingDecimal.SMALL_10_POW[exp &amp; 15];</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((exp &gt;&gt;= 4) != 0) {</b>
&nbsp;                int j;
<b class="nc">&nbsp;                for (j = 0; exp &gt; 1; j++, exp &gt;&gt;= 1) {</b>
<b class="nc">&nbsp;                    if ((exp &amp; 1) != 0) {</b>
<b class="nc">&nbsp;                        dValue *= FloatingDecimal.BIG_10_POW[j];</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                double t = dValue * FloatingDecimal.BIG_10_POW[j];</b>
<b class="nc">&nbsp;                if (Double.isInfinite(t)) {</b>
<b class="nc">&nbsp;                    t = dValue / 2.0;</b>
<b class="nc">&nbsp;                    t *= FloatingDecimal.BIG_10_POW[j];</b>
<b class="nc">&nbsp;                    if (Double.isInfinite(t)) {</b>
<b class="nc">&nbsp;                        return (isNegative) ? Double.NEGATIVE_INFINITY : Double.POSITIVE_INFINITY;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    t = Double.MAX_VALUE;</b>
&nbsp;                }
<b class="nc">&nbsp;                dValue = t;</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;        } else if (exp &lt; 0) {</b>
<b class="nc">&nbsp;            exp = -exp;</b>
<b class="nc">&nbsp;            if (decExp &lt; FloatingDecimal.MIN_DECIMAL_EXPONENT - 1) {</b>
<b class="nc">&nbsp;                return (isNegative) ? -0.0 : 0.0;</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((exp &amp; 15) != 0) {</b>
<b class="nc">&nbsp;                dValue /= FloatingDecimal.SMALL_10_POW[exp &amp; 15];</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((exp &gt;&gt;= 4) != 0) {</b>
&nbsp;                int j;
<b class="nc">&nbsp;                for (j = 0; exp &gt; 1; j++, exp &gt;&gt;= 1) {</b>
<b class="nc">&nbsp;                    if ((exp &amp; 1) != 0) {</b>
<b class="nc">&nbsp;                        dValue *= FloatingDecimal.TINY_10_POW[j];</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                double t = dValue * FloatingDecimal.TINY_10_POW[j];</b>
<b class="nc">&nbsp;                if (t == 0.0) {</b>
<b class="nc">&nbsp;                    t = dValue * 2.0;</b>
<b class="nc">&nbsp;                    t *= FloatingDecimal.TINY_10_POW[j];</b>
<b class="nc">&nbsp;                    if (t == 0.0) {</b>
<b class="nc">&nbsp;                        return (isNegative) ? -0.0 : 0.0;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    t = Double.MIN_VALUE;</b>
&nbsp;                }
<b class="nc">&nbsp;                dValue = t;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (nDigits &gt; FloatingDecimal.MAX_NDIGITS) {</b>
<b class="nc">&nbsp;            nDigits = FloatingDecimal.MAX_NDIGITS + 1;</b>
<b class="nc">&nbsp;            digits[FloatingDecimal.MAX_NDIGITS] = &#39;1&#39;;</b>
&nbsp;        }
<b class="nc">&nbsp;        FDBigInteger bigD0 = new FDBigInteger(lValue, digits, kDigits, nDigits);</b>
<b class="nc">&nbsp;        exp = decExp - nDigits;</b>
&nbsp;
<b class="nc">&nbsp;        long ieeeBits = Double.doubleToRawLongBits(dValue); // IEEE-754 bits of double candidate</b>
<b class="nc">&nbsp;        final int B5 = Math.max(0, -exp); // powers of 5 in bigB, value is not modified inside correctionLoop</b>
<b class="nc">&nbsp;        final int D5 = Math.max(0, exp); // powers of 5 in bigD, value is not modified inside correctionLoop</b>
<b class="nc">&nbsp;        bigD0 = bigD0.multByPow52(D5, 0);</b>
<b class="nc">&nbsp;        bigD0.makeImmutable();   // prevent bigD0 modification inside correctionLoop</b>
<b class="nc">&nbsp;        FDBigInteger bigD = null;</b>
<b class="nc">&nbsp;        int prevD2 = 0;</b>
&nbsp;
&nbsp;        correctionLoop:
&nbsp;        while (true) {
&nbsp;            // here ieeeBits can&#39;t be NaN, Infinity or zero
<b class="nc">&nbsp;            int binexp = (int) (ieeeBits &gt;&gt;&gt; FloatingDecimal.EXP_SHIFT);</b>
<b class="nc">&nbsp;            long bigBbits = ieeeBits &amp; FloatingDecimal.DOUBLE_SIGNIF_BIT_MASK;</b>
<b class="nc">&nbsp;            if (binexp &gt; 0) {</b>
<b class="nc">&nbsp;                bigBbits |= FloatingDecimal.FRACT_HOB;</b>
&nbsp;            } else { // Normalize denormalized numbers.
<b class="nc">&nbsp;                assert bigBbits != 0L : bigBbits; // doubleToBigInt(0.0)</b>
<b class="nc">&nbsp;                int leadingZeros = Long.numberOfLeadingZeros(bigBbits);</b>
<b class="nc">&nbsp;                int shift = leadingZeros - (63 - FloatingDecimal.EXP_SHIFT);</b>
<b class="nc">&nbsp;                bigBbits &lt;&lt;= shift;</b>
<b class="nc">&nbsp;                binexp = 1 - shift;</b>
&nbsp;            }
<b class="nc">&nbsp;            binexp -= FloatingDecimal.DOUBLE_EXP_BIAS;</b>
<b class="nc">&nbsp;            int lowOrderZeros = Long.numberOfTrailingZeros(bigBbits);</b>
<b class="nc">&nbsp;            bigBbits &gt;&gt;&gt;= lowOrderZeros;</b>
<b class="nc">&nbsp;            final int bigIntExp = binexp - FloatingDecimal.EXP_SHIFT + lowOrderZeros;</b>
<b class="nc">&nbsp;            final int bigIntNBits = FloatingDecimal.EXP_SHIFT + 1 - lowOrderZeros;</b>
&nbsp;
<b class="nc">&nbsp;            int B2 = B5; // powers of 2 in bigB</b>
<b class="nc">&nbsp;            int D2 = D5; // powers of 2 in bigD</b>
&nbsp;            int Ulp2;   // powers of 2 in halfUlp.
<b class="nc">&nbsp;            if (bigIntExp &gt;= 0) {</b>
<b class="nc">&nbsp;                B2 += bigIntExp;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                D2 -= bigIntExp;</b>
&nbsp;            }
<b class="nc">&nbsp;            Ulp2 = B2;</b>
&nbsp;            // shift bigB and bigD left by a number s. t.
&nbsp;            // halfUlp is still an integer.
&nbsp;            int hulpbias;
<b class="nc">&nbsp;            if (binexp &lt;= -FloatingDecimal.DOUBLE_EXP_BIAS) {</b>
&nbsp;                // This is going to be a denormalized number
&nbsp;                // (if not actually zero).
&nbsp;                // half an ULP is at 2^-(EXP_BIAS+EXP_SHIFT+1)
<b class="nc">&nbsp;                hulpbias = binexp + lowOrderZeros + FloatingDecimal.DOUBLE_EXP_BIAS;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                hulpbias = 1 + lowOrderZeros;</b>
&nbsp;            }
<b class="nc">&nbsp;            B2 += hulpbias;</b>
<b class="nc">&nbsp;            D2 += hulpbias;</b>
&nbsp;            // if there are common factors of 2, we might just as well
&nbsp;            // factor them out, as they add nothing useful.
<b class="nc">&nbsp;            int common2 = Math.min(B2, Math.min(D2, Ulp2));</b>
<b class="nc">&nbsp;            B2 -= common2;</b>
<b class="nc">&nbsp;            D2 -= common2;</b>
<b class="nc">&nbsp;            Ulp2 -= common2;</b>
&nbsp;            // do multiplications by powers of 5 and 2
<b class="nc">&nbsp;            FDBigInteger bigB = FDBigInteger.valueOfMulPow52(bigBbits, B5, B2);</b>
<b class="nc">&nbsp;            if (bigD == null || prevD2 != D2) {</b>
<b class="nc">&nbsp;                bigD = bigD0.leftShift(D2);</b>
<b class="nc">&nbsp;                prevD2 = D2;</b>
&nbsp;            }
&nbsp;
&nbsp;            FDBigInteger diff;
&nbsp;            int cmpResult;
&nbsp;            boolean overvalue;
<b class="nc">&nbsp;            if ((cmpResult = bigB.cmp(bigD)) &gt; 0) {</b>
<b class="nc">&nbsp;                overvalue = true; // our candidate is too big.</b>
<b class="nc">&nbsp;                diff = bigB.leftInplaceSub(bigD); // bigB is not user further - reuse</b>
<b class="nc">&nbsp;                if ((bigIntNBits == 1) &amp;&amp; (bigIntExp &gt; -FloatingDecimal.DOUBLE_EXP_BIAS + 1)) {</b>
&nbsp;                    // candidate is a normalized exact power of 2 and
&nbsp;                    // is too big (larger than Double.MIN_NORMAL). We will be subtracting.
&nbsp;                    // For our purposes, ulp is the ulp of the
&nbsp;                    // next smaller range.
<b class="nc">&nbsp;                    Ulp2 -= 1;</b>
<b class="nc">&nbsp;                    if (Ulp2 &lt; 0) {</b>
&nbsp;                        // rats. Cannot de-scale ulp this far.
&nbsp;                        // must scale diff in other direction.
<b class="nc">&nbsp;                        Ulp2 = 0;</b>
<b class="nc">&nbsp;                        diff = diff.leftShift(1);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;            } else if (cmpResult &lt; 0) {</b>
<b class="nc">&nbsp;                overvalue = false; // our candidate is too small.</b>
<b class="nc">&nbsp;                diff = bigD.rightInplaceSub(bigB); // bigB is not user further - reuse</b>
&nbsp;            } else {
&nbsp;                // the candidate is exactly right!
&nbsp;                // this happens with surprising frequency
&nbsp;                break correctionLoop;
&nbsp;            }
<b class="nc">&nbsp;            cmpResult = diff.cmpPow52(B5, Ulp2);</b>
<b class="nc">&nbsp;            if ((cmpResult) &lt; 0) {</b>
&nbsp;                // difference is small.
&nbsp;                // this is close enough
<b class="nc">&nbsp;                break correctionLoop;</b>
<b class="nc">&nbsp;            } else if (cmpResult == 0) {</b>
&nbsp;                // difference is exactly half an ULP
&nbsp;                // round to some other value maybe, then finish
<b class="nc">&nbsp;                if ((ieeeBits &amp; 1) != 0) { // half ties to even</b>
<b class="nc">&nbsp;                    ieeeBits += overvalue ? -1 : 1; // nextDown or nextUp</b>
&nbsp;                }
&nbsp;                break correctionLoop;
&nbsp;            } else {
&nbsp;                // difference is non-trivial.
&nbsp;                // could scale addend by ratio of difference to
&nbsp;                // halfUlp here, if we bothered to compute that difference.
&nbsp;                // Most of the time ( I hope ) it is about 1 anyway.
<b class="nc">&nbsp;                ieeeBits += overvalue ? -1 : 1; // nextDown or nextUp</b>
<b class="nc">&nbsp;                if (ieeeBits == 0 || ieeeBits == FloatingDecimal.DOUBLE_EXP_BIT_MASK) { // 0.0 or Double.POSITIVE_INFINITY</b>
<b class="nc">&nbsp;                    break correctionLoop; // oops. Fell off end of range.</b>
&nbsp;                }
&nbsp;                continue; // try again.
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (isNegative) {</b>
<b class="nc">&nbsp;            ieeeBits |= FloatingDecimal.DOUBLE_SIGN_BIT_MASK;</b>
&nbsp;        }
<b class="nc">&nbsp;        return Double.longBitsToDouble(ieeeBits);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static float floatValue(boolean isNegative, int decExponent, char[] digits, int nDigits) {
<b class="nc">&nbsp;        int kDigits = Math.min(nDigits, FloatingDecimal.SINGLE_MAX_DECIMAL_DIGITS + 1);</b>
<b class="nc">&nbsp;        int iValue = (int) digits[0] - (int) &#39;0&#39;;</b>
<b class="nc">&nbsp;        for (int i = 1; i &lt; kDigits; i++) {</b>
<b class="nc">&nbsp;            iValue = iValue * 10 + (int) digits[i] - (int) &#39;0&#39;;</b>
&nbsp;        }
<b class="nc">&nbsp;        float fValue = (float) iValue;</b>
<b class="nc">&nbsp;        int exp = decExponent - kDigits;</b>
&nbsp;
<b class="nc">&nbsp;        if (nDigits &lt;= FloatingDecimal.SINGLE_MAX_DECIMAL_DIGITS) {</b>
<b class="nc">&nbsp;            if (exp == 0 || fValue == 0.0f) {</b>
<b class="nc">&nbsp;                return (isNegative) ? -fValue : fValue; // small floating integer</b>
<b class="nc">&nbsp;            } else if (exp &gt;= 0) {</b>
<b class="nc">&nbsp;                if (exp &lt;= FloatingDecimal.SINGLE_MAX_SMALL_TEN) {</b>
<b class="nc">&nbsp;                    fValue *= FloatingDecimal.SINGLE_SMALL_10_POW[exp];</b>
<b class="nc">&nbsp;                    return (isNegative) ? -fValue : fValue;</b>
&nbsp;                }
<b class="nc">&nbsp;                int slop = FloatingDecimal.SINGLE_MAX_DECIMAL_DIGITS - kDigits;</b>
<b class="nc">&nbsp;                if (exp &lt;= FloatingDecimal.SINGLE_MAX_SMALL_TEN + slop) {</b>
<b class="nc">&nbsp;                    fValue *= FloatingDecimal.SINGLE_SMALL_10_POW[slop];</b>
<b class="nc">&nbsp;                    fValue *= FloatingDecimal.SINGLE_SMALL_10_POW[exp - slop];</b>
<b class="nc">&nbsp;                    return (isNegative) ? -fValue : fValue;</b>
&nbsp;                }
<b class="nc">&nbsp;            } else {</b>
<b class="nc">&nbsp;                if (exp &gt;= -FloatingDecimal.SINGLE_MAX_SMALL_TEN) {</b>
<b class="nc">&nbsp;                    fValue /= FloatingDecimal.SINGLE_SMALL_10_POW[-exp];</b>
<b class="nc">&nbsp;                    return (isNegative) ? -fValue : fValue;</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;        } else if ((decExponent &gt;= nDigits) &amp;&amp; (nDigits + decExponent &lt;= FloatingDecimal.MAX_DECIMAL_DIGITS)) {</b>
<b class="nc">&nbsp;            long lValue = (long) iValue;</b>
<b class="nc">&nbsp;            for (int i = kDigits; i &lt; nDigits; i++) {</b>
<b class="nc">&nbsp;                lValue = lValue * 10L + (long) ((int) digits[i] - (int) &#39;0&#39;);</b>
&nbsp;            }
<b class="nc">&nbsp;            double dValue = (double) lValue;</b>
<b class="nc">&nbsp;            exp = decExponent - nDigits;</b>
<b class="nc">&nbsp;            dValue *= FloatingDecimal.SMALL_10_POW[exp];</b>
<b class="nc">&nbsp;            fValue = (float) dValue;</b>
<b class="nc">&nbsp;            return (isNegative) ? -fValue : fValue;</b>
&nbsp;        }
<b class="nc">&nbsp;        double dValue = fValue;</b>
<b class="nc">&nbsp;        if (exp &gt; 0) {</b>
<b class="nc">&nbsp;            if (decExponent &gt; FloatingDecimal.SINGLE_MAX_DECIMAL_EXPONENT + 1) {</b>
<b class="nc">&nbsp;                return (isNegative) ? Float.NEGATIVE_INFINITY : Float.POSITIVE_INFINITY;</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((exp &amp; 15) != 0) {</b>
<b class="nc">&nbsp;                dValue *= FloatingDecimal.SMALL_10_POW[exp &amp; 15];</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((exp &gt;&gt;= 4) != 0) {</b>
&nbsp;                int j;
<b class="nc">&nbsp;                for (j = 0; exp &gt; 0; j++, exp &gt;&gt;= 1) {</b>
<b class="nc">&nbsp;                    if ((exp &amp; 1) != 0) {</b>
<b class="nc">&nbsp;                        dValue *= FloatingDecimal.BIG_10_POW[j];</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;        } else if (exp &lt; 0) {</b>
<b class="nc">&nbsp;            exp = -exp;</b>
<b class="nc">&nbsp;            if (decExponent &lt; FloatingDecimal.SINGLE_MIN_DECIMAL_EXPONENT - 1) {</b>
<b class="nc">&nbsp;                return (isNegative) ? -0.0f : 0.0f;</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((exp &amp; 15) != 0) {</b>
<b class="nc">&nbsp;                dValue /= FloatingDecimal.SMALL_10_POW[exp &amp; 15];</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((exp &gt;&gt;= 4) != 0) {</b>
&nbsp;                int j;
<b class="nc">&nbsp;                for (j = 0; exp &gt; 0; j++, exp &gt;&gt;= 1) {</b>
<b class="nc">&nbsp;                    if ((exp &amp; 1) != 0) {</b>
<b class="nc">&nbsp;                        dValue *= FloatingDecimal.TINY_10_POW[j];</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        fValue = Math.max(Float.MIN_VALUE, Math.min(Float.MAX_VALUE, (float) dValue));</b>
&nbsp;
<b class="nc">&nbsp;        if (nDigits &gt; FloatingDecimal.SINGLE_MAX_NDIGITS) {</b>
<b class="nc">&nbsp;            nDigits = FloatingDecimal.SINGLE_MAX_NDIGITS + 1;</b>
<b class="nc">&nbsp;            digits[FloatingDecimal.SINGLE_MAX_NDIGITS] = &#39;1&#39;;</b>
&nbsp;        }
<b class="nc">&nbsp;        FDBigInteger bigD0 = new FDBigInteger(iValue, digits, kDigits, nDigits);</b>
<b class="nc">&nbsp;        exp = decExponent - nDigits;</b>
&nbsp;
<b class="nc">&nbsp;        int ieeeBits = Float.floatToRawIntBits(fValue); // IEEE-754 bits of float candidate</b>
<b class="nc">&nbsp;        final int B5 = Math.max(0, -exp); // powers of 5 in bigB, value is not modified inside correctionLoop</b>
<b class="nc">&nbsp;        final int D5 = Math.max(0, exp); // powers of 5 in bigD, value is not modified inside correctionLoop</b>
<b class="nc">&nbsp;        bigD0 = bigD0.multByPow52(D5, 0);</b>
<b class="nc">&nbsp;        bigD0.makeImmutable();   // prevent bigD0 modification inside correctionLoop</b>
<b class="nc">&nbsp;        FDBigInteger bigD = null;</b>
<b class="nc">&nbsp;        int prevD2 = 0;</b>
&nbsp;
&nbsp;        correctionLoop:
&nbsp;        while (true) {
&nbsp;            // here ieeeBits can&#39;t be NaN, Infinity or zero
<b class="nc">&nbsp;            int binexp = ieeeBits &gt;&gt;&gt; FloatingDecimal.SINGLE_EXP_SHIFT;</b>
<b class="nc">&nbsp;            int bigBbits = ieeeBits &amp; FloatingDecimal.FLOAT_SIGNIF_BIT_MASK;</b>
<b class="nc">&nbsp;            if (binexp &gt; 0) {</b>
<b class="nc">&nbsp;                bigBbits |= FloatingDecimal.SINGLE_FRACT_HOB;</b>
&nbsp;            } else { // Normalize denormalized numbers.
<b class="nc">&nbsp;                assert bigBbits != 0 : bigBbits; // floatToBigInt(0.0)</b>
<b class="nc">&nbsp;                int leadingZeros = Integer.numberOfLeadingZeros(bigBbits);</b>
<b class="nc">&nbsp;                int shift = leadingZeros - (31 - FloatingDecimal.SINGLE_EXP_SHIFT);</b>
<b class="nc">&nbsp;                bigBbits &lt;&lt;= shift;</b>
<b class="nc">&nbsp;                binexp = 1 - shift;</b>
&nbsp;            }
<b class="nc">&nbsp;            binexp -= FloatingDecimal.FLOAT_EXP_BIAS;</b>
<b class="nc">&nbsp;            int lowOrderZeros = Integer.numberOfTrailingZeros(bigBbits);</b>
<b class="nc">&nbsp;            bigBbits &gt;&gt;&gt;= lowOrderZeros;</b>
<b class="nc">&nbsp;            final int bigIntExp = binexp - FloatingDecimal.SINGLE_EXP_SHIFT + lowOrderZeros;</b>
<b class="nc">&nbsp;            final int bigIntNBits = FloatingDecimal.SINGLE_EXP_SHIFT + 1 - lowOrderZeros;</b>
&nbsp;
<b class="nc">&nbsp;            int B2 = B5; // powers of 2 in bigB</b>
<b class="nc">&nbsp;            int D2 = D5; // powers of 2 in bigD</b>
&nbsp;            int Ulp2;   // powers of 2 in halfUlp.
<b class="nc">&nbsp;            if (bigIntExp &gt;= 0) {</b>
<b class="nc">&nbsp;                B2 += bigIntExp;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                D2 -= bigIntExp;</b>
&nbsp;            }
<b class="nc">&nbsp;            Ulp2 = B2;</b>
&nbsp;
&nbsp;            int hulpbias;
<b class="nc">&nbsp;            if (binexp &lt;= -FloatingDecimal.FLOAT_EXP_BIAS) {</b>
<b class="nc">&nbsp;                hulpbias = binexp + lowOrderZeros + FloatingDecimal.FLOAT_EXP_BIAS;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                hulpbias = 1 + lowOrderZeros;</b>
&nbsp;            }
<b class="nc">&nbsp;            B2 += hulpbias;</b>
<b class="nc">&nbsp;            D2 += hulpbias;</b>
&nbsp;
<b class="nc">&nbsp;            int common2 = Math.min(B2, Math.min(D2, Ulp2));</b>
<b class="nc">&nbsp;            B2 -= common2;</b>
<b class="nc">&nbsp;            D2 -= common2;</b>
<b class="nc">&nbsp;            Ulp2 -= common2;</b>
&nbsp;            // do multiplications by powers of 5 and 2
<b class="nc">&nbsp;            FDBigInteger bigB = FDBigInteger.valueOfMulPow52(bigBbits, B5, B2);</b>
<b class="nc">&nbsp;            if (bigD == null || prevD2 != D2) {</b>
<b class="nc">&nbsp;                bigD = bigD0.leftShift(D2);</b>
<b class="nc">&nbsp;                prevD2 = D2;</b>
&nbsp;            }
&nbsp;
&nbsp;            FDBigInteger diff;
&nbsp;            int cmpResult;
&nbsp;            boolean overvalue;
<b class="nc">&nbsp;            if ((cmpResult = bigB.cmp(bigD)) &gt; 0) {</b>
<b class="nc">&nbsp;                overvalue = true; // our candidate is too big.</b>
<b class="nc">&nbsp;                diff = bigB.leftInplaceSub(bigD); // bigB is not user further - reuse</b>
<b class="nc">&nbsp;                if ((bigIntNBits == 1) &amp;&amp; (bigIntExp &gt; -FloatingDecimal.FLOAT_EXP_BIAS + 1)) {</b>
<b class="nc">&nbsp;                    Ulp2 -= 1;</b>
<b class="nc">&nbsp;                    if (Ulp2 &lt; 0) {</b>
<b class="nc">&nbsp;                        Ulp2 = 0;</b>
<b class="nc">&nbsp;                        diff = diff.leftShift(1);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;            } else if (cmpResult &lt; 0) {</b>
<b class="nc">&nbsp;                overvalue = false; // our candidate is too small.</b>
<b class="nc">&nbsp;                diff = bigD.rightInplaceSub(bigB); // bigB is not user further - reuse</b>
&nbsp;            } else {
&nbsp;                break correctionLoop;
&nbsp;            }
<b class="nc">&nbsp;            cmpResult = diff.cmpPow52(B5, Ulp2);</b>
<b class="nc">&nbsp;            if ((cmpResult) &lt; 0) {</b>
<b class="nc">&nbsp;                break correctionLoop;</b>
<b class="nc">&nbsp;            } else if (cmpResult == 0) {</b>
<b class="nc">&nbsp;                if ((ieeeBits &amp; 1) != 0) { // half ties to even</b>
<b class="nc">&nbsp;                    ieeeBits += overvalue ? -1 : 1; // nextDown or nextUp</b>
&nbsp;                }
&nbsp;                break correctionLoop;
&nbsp;            } else {
<b class="nc">&nbsp;                ieeeBits += overvalue ? -1 : 1; // nextDown or nextUp</b>
<b class="nc">&nbsp;                if (ieeeBits == 0 || ieeeBits == FloatingDecimal.FLOAT_EXP_BIT_MASK) { // 0.0 or Float.POSITIVE_INFINITY</b>
<b class="nc">&nbsp;                    break correctionLoop; // oops. Fell off end of range.</b>
&nbsp;                }
&nbsp;                continue; // try again.
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (isNegative) {</b>
<b class="nc">&nbsp;            ieeeBits |= FloatingDecimal.FLOAT_SIGN_BIT_MASK;</b>
&nbsp;        }
<b class="nc">&nbsp;        return Float.intBitsToFloat(ieeeBits);</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    static class Cache {</b>
&nbsp;        volatile char[] chars;
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    static final Cache CACHE = new Cache();</b>
<b class="fc">&nbsp;    static final AtomicReferenceFieldUpdater&lt;Cache, char[]&gt; CHARS_UPDATER</b>
<b class="fc">&nbsp;            = AtomicReferenceFieldUpdater.newUpdater(Cache.class, char[].class, &quot;chars&quot;);</b>
&nbsp;
&nbsp;    public static Class&lt;?&gt; getMapping(Type type) {
<b class="nc">&nbsp;        if (type == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type.getClass() == Class.class) {</b>
<b class="nc">&nbsp;            return (Class&lt;?&gt;) type;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type instanceof ParameterizedType) {</b>
<b class="nc">&nbsp;            return getMapping(((ParameterizedType) type).getRawType());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type instanceof TypeVariable) {</b>
<b class="nc">&nbsp;            Type boundType = ((TypeVariable&lt;?&gt;) type).getBounds()[0];</b>
<b class="nc">&nbsp;            if (boundType instanceof Class) {</b>
<b class="nc">&nbsp;                return (Class) boundType;</b>
&nbsp;            }
<b class="nc">&nbsp;            return getMapping(boundType);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type instanceof WildcardType) {</b>
<b class="nc">&nbsp;            Type[] upperBounds = ((WildcardType) type).getUpperBounds();</b>
<b class="nc">&nbsp;            if (upperBounds.length == 1) {</b>
<b class="nc">&nbsp;                return getMapping(upperBounds[0]);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type instanceof GenericArrayType) {</b>
<b class="nc">&nbsp;            Type genericComponentType = ((GenericArrayType) type).getGenericComponentType();</b>
<b class="nc">&nbsp;            Class&lt;?&gt; componentClass = getClass(genericComponentType);</b>
<b class="nc">&nbsp;            return getArrayClass(componentClass);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return Object.class;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Date toDate(Object obj) {
<b class="nc">&nbsp;        if (obj == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Date) {</b>
<b class="nc">&nbsp;            return (Date) obj;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Instant) {</b>
<b class="nc">&nbsp;            Instant instant = (Instant) obj;</b>
<b class="nc">&nbsp;            return new Date(</b>
<b class="nc">&nbsp;                    instant.toEpochMilli());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof ZonedDateTime) {</b>
<b class="nc">&nbsp;            ZonedDateTime zdt = (ZonedDateTime) obj;</b>
<b class="nc">&nbsp;            return new Date(</b>
<b class="nc">&nbsp;                    zdt.toInstant().toEpochMilli());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof LocalDate) {</b>
<b class="nc">&nbsp;            LocalDate localDate = (LocalDate) obj;</b>
<b class="nc">&nbsp;            ZonedDateTime zdt = localDate.atStartOfDay(ZoneId.systemDefault());</b>
<b class="nc">&nbsp;            return new Date(</b>
<b class="nc">&nbsp;                    zdt.toInstant().toEpochMilli());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof LocalDateTime) {</b>
<b class="nc">&nbsp;            LocalDateTime ldt = (LocalDateTime) obj;</b>
<b class="nc">&nbsp;            ZonedDateTime zdt = ldt.atZone(ZoneId.systemDefault());</b>
<b class="nc">&nbsp;            return new Date(</b>
<b class="nc">&nbsp;                    zdt.toInstant().toEpochMilli());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof String) {</b>
<b class="nc">&nbsp;            return DateUtils.parseDate((String) obj);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Long || obj instanceof Integer) {</b>
<b class="nc">&nbsp;            return new Date(((Number) obj).longValue());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to Date from &quot; + obj.getClass());</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Instant toInstant(Object obj) {
<b class="nc">&nbsp;        if (obj == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Instant) {</b>
<b class="nc">&nbsp;            return (Instant) obj;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Date) {</b>
<b class="nc">&nbsp;            return ((Date) obj).toInstant();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof ZonedDateTime) {</b>
<b class="nc">&nbsp;            ZonedDateTime zdt = (ZonedDateTime) obj;</b>
<b class="nc">&nbsp;            return zdt.toInstant();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) obj;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
&nbsp;
&nbsp;            JSONReader jsonReader;
<b class="nc">&nbsp;            if (str.charAt(0) != &#39;&quot;&#39;) {</b>
<b class="nc">&nbsp;                jsonReader = JSONReader.of(&#39;&quot;&#39; + str + &#39;&quot;&#39;);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                jsonReader = JSONReader.of(str);</b>
&nbsp;            }
<b class="nc">&nbsp;            return jsonReader.read(Instant.class);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Map) {</b>
<b class="nc">&nbsp;            return (Instant) ObjectReaderImplInstant.INSTANCE.createInstance((Map) obj, 0L);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to Date from &quot; + obj.getClass());</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Object[] cast(Object obj, Type[] types) {
<b class="nc">&nbsp;        if (obj == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Object[] array = new Object[types.length];</b>
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Collection) {</b>
<b class="nc">&nbsp;            int i = 0;</b>
<b class="nc">&nbsp;            for (Object item : (Collection) obj) {</b>
<b class="nc">&nbsp;                int index = i++;</b>
<b class="nc">&nbsp;                array[index] = TypeUtils.cast(item, types[index]);</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;        } else {</b>
<b class="nc">&nbsp;            Class&lt;?&gt; objectClass = obj.getClass();</b>
<b class="nc">&nbsp;            if (objectClass.isArray()) {</b>
<b class="nc">&nbsp;                int length = Array.getLength(obj);</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; array.length &amp;&amp; i &lt; length; i++) {</b>
<b class="nc">&nbsp;                    Object item = Array.get(obj, i);</b>
<b class="nc">&nbsp;                    array[i] = TypeUtils.cast(item, types[i]);</b>
&nbsp;                }
<b class="nc">&nbsp;            } else {</b>
<b class="nc">&nbsp;                throw new JSONException(&quot;can not cast to types &quot; + JSON.toJSONString(types) + &quot; from &quot; + objectClass);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return array;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static String[] toStringArray(Object object) {
<b class="nc">&nbsp;        if (object == null || object instanceof String[]) {</b>
<b class="nc">&nbsp;            return (String[]) object;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (object instanceof Collection) {</b>
<b class="nc">&nbsp;            Collection collection = (Collection) object;</b>
<b class="nc">&nbsp;            String[] array = new String[collection.size()];</b>
<b class="nc">&nbsp;            int i = 0;</b>
<b class="nc">&nbsp;            for (Object item : (Collection) object) {</b>
<b class="nc">&nbsp;                int index = i++;</b>
<b class="nc">&nbsp;                array[index] = item == null || (item instanceof String) ? (String) item : item.toString();</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            return array;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Class&lt;?&gt; objectClass = object.getClass();</b>
<b class="nc">&nbsp;        if (objectClass.isArray()) {</b>
<b class="nc">&nbsp;            int length = Array.getLength(object);</b>
<b class="nc">&nbsp;            String[] array = new String[length];</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; array.length; i++) {</b>
<b class="nc">&nbsp;                Object item = Array.get(object, i);</b>
<b class="nc">&nbsp;                array[i] = item == null || (item instanceof String) ? (String) item : item.toString();</b>
&nbsp;            }
<b class="nc">&nbsp;            return array;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return cast(object, String[].class);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static &lt;T&gt; T cast(Object obj, Type type) {
<b class="nc">&nbsp;        if (type instanceof Class) {</b>
<b class="nc">&nbsp;            return (T) cast(obj, (Class) type);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        ObjectReaderProvider provider = JSONFactory.getDefaultObjectReaderProvider();</b>
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Collection) {</b>
<b class="nc">&nbsp;            ObjectReader objectReader = provider.getObjectReader(type);</b>
<b class="nc">&nbsp;            return (T) objectReader.createInstance((Collection) obj);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Map) {</b>
<b class="nc">&nbsp;            ObjectReader objectReader = provider.getObjectReader(type);</b>
<b class="nc">&nbsp;            return (T) objectReader.createInstance((Map) obj, 0L);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        String json = JSON.toJSONString(obj);</b>
<b class="nc">&nbsp;        return JSON.parseObject(json, type);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static &lt;T&gt; T cast(Object obj, Class&lt;T&gt; targetClass) {
<b class="nc">&nbsp;        return cast(obj, targetClass, JSONFactory.getDefaultObjectReaderProvider());</b>
&nbsp;    }
&nbsp;
&nbsp;    public static &lt;T&gt; T cast(Object obj, Class&lt;T&gt; targetClass, ObjectReaderProvider provider) {
<b class="nc">&nbsp;        if (obj == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (targetClass.isInstance(obj)) {</b>
<b class="nc">&nbsp;            return (T) obj;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (targetClass == Date.class) {</b>
<b class="nc">&nbsp;            return (T) toDate(obj);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (targetClass == Instant.class) {</b>
<b class="nc">&nbsp;            return (T) toInstant(obj);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (targetClass == String.class) {</b>
<b class="nc">&nbsp;            if (obj instanceof Character) {</b>
<b class="nc">&nbsp;                return (T) obj.toString();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return (T) JSON.toJSONString(obj);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (targetClass == AtomicInteger.class) {</b>
<b class="nc">&nbsp;            return (T) new AtomicInteger(toIntValue(obj));</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (targetClass == AtomicLong.class) {</b>
<b class="nc">&nbsp;            return (T) new AtomicLong(toLongValue(obj));</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (targetClass == AtomicBoolean.class) {</b>
<b class="nc">&nbsp;            return (T) new AtomicBoolean((Boolean) obj);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Map) {</b>
<b class="nc">&nbsp;            ObjectReader objectReader = provider.getObjectReader(targetClass);</b>
<b class="nc">&nbsp;            return (T) objectReader.createInstance((Map) obj, 0L);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Function typeConvert = provider.getTypeConvert(obj.getClass(), targetClass);</b>
<b class="nc">&nbsp;        if (typeConvert != null) {</b>
<b class="nc">&nbsp;            return (T) typeConvert.apply(obj);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof String) {</b>
<b class="nc">&nbsp;            String json = (String) obj;</b>
<b class="nc">&nbsp;            if (json.isEmpty() || &quot;null&quot;.equals(json)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
&nbsp;
&nbsp;            JSONReader jsonReader;
<b class="nc">&nbsp;            char first = json.trim().charAt(0);</b>
<b class="nc">&nbsp;            if (first == &#39;&quot;&#39; || first == &#39;{&#39; || first == &#39;[&#39;) {</b>
<b class="nc">&nbsp;                jsonReader = JSONReader.of(json);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                jsonReader = JSONReader.of(</b>
<b class="nc">&nbsp;                        JSON.toJSONString(json));</b>
&nbsp;            }
&nbsp;
&nbsp;            ObjectReader objectReader = JSONFactory
<b class="nc">&nbsp;                    .getDefaultObjectReaderProvider()</b>
<b class="nc">&nbsp;                    .getObjectReader(targetClass);</b>
<b class="nc">&nbsp;            return (T) objectReader.readObject(jsonReader, null, null, 0);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (targetClass.isEnum()) {</b>
<b class="nc">&nbsp;            if (obj instanceof Integer) {</b>
<b class="nc">&nbsp;                int ordinal = ((Integer) obj).intValue();</b>
<b class="nc">&nbsp;                ObjectReader objectReader = JSONFactory.getDefaultObjectReaderProvider().getObjectReader(targetClass);</b>
<b class="nc">&nbsp;                if (objectReader instanceof ObjectReaderImplEnum) {</b>
<b class="nc">&nbsp;                    Enum e = ((ObjectReaderImplEnum) objectReader).getEnumByOrdinal(ordinal);</b>
<b class="nc">&nbsp;                    return (T) e;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (obj instanceof Collection) {</b>
<b class="nc">&nbsp;            ObjectReader objectReader = provider.getObjectReader(targetClass);</b>
<b class="nc">&nbsp;            return (T) objectReader.createInstance((Collection) obj);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to &quot; + targetClass.getName() + &quot;, from &quot; + obj.getClass());</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    static final Map&lt;Class, String&gt; NAME_MAPPINGS = new IdentityHashMap&lt;&gt;();</b>
<b class="fc">&nbsp;    static final Map&lt;String, Class&gt; TYPE_MAPPINGS = new ConcurrentHashMap&lt;&gt;();</b>
&nbsp;
&nbsp;    static {
<b class="fc">&nbsp;        CLASS_JSON_OBJECT_1x = loadClass(&quot;com.alibaba.fastjson.JSONObject&quot;);</b>
&nbsp;        {
<b class="fc">&nbsp;            Field field = null;</b>
<b class="fc">&nbsp;            if (CLASS_JSON_OBJECT_1x != null) {</b>
&nbsp;                try {
<b class="fc">&nbsp;                    field = CLASS_JSON_OBJECT_1x.getDeclaredField(&quot;map&quot;);</b>
<b class="fc">&nbsp;                    field.setAccessible(true);</b>
<b class="nc">&nbsp;                } catch (Throwable ignore) {</b>
&nbsp;                    // ignore
<b class="fc">&nbsp;                }</b>
&nbsp;            }
<b class="fc">&nbsp;            FIELD_JSON_OBJECT_1x_map = field;</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        CLASS_JSON_ARRAY_1x = loadClass(&quot;com.alibaba.fastjson.JSONArray&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(byte.class, &quot;B&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(short.class, &quot;S&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(int.class, &quot;I&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(long.class, &quot;J&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(float.class, &quot;F&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(double.class, &quot;D&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(char.class, &quot;C&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(boolean.class, &quot;Z&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Object[].class, &quot;[O&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Object[][].class, &quot;[[O&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(byte[].class, &quot;[B&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(byte[][].class, &quot;[[B&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(short[].class, &quot;[S&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(short[][].class, &quot;[[S&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(int[].class, &quot;[I&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(int[][].class, &quot;[[I&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(long[].class, &quot;[J&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(long[][].class, &quot;[[J&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(float[].class, &quot;[F&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(float[][].class, &quot;[[F&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(double[].class, &quot;[D&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(double[][].class, &quot;[[D&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(char[].class, &quot;[C&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(char[][].class, &quot;[[C&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(boolean[].class, &quot;[Z&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(boolean[][].class, &quot;[[Z&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Byte[].class, &quot;[Byte&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Byte[][].class, &quot;[[Byte&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Short[].class, &quot;[Short&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Short[][].class, &quot;[[Short&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Integer[].class, &quot;[Integer&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Integer[][].class, &quot;[[Integer&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Long[].class, &quot;[Long&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Long[][].class, &quot;[[Long&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Float[].class, &quot;[Float&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Float[][].class, &quot;[[Float&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Double[].class, &quot;[Double&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Double[][].class, &quot;[[Double&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Character[].class, &quot;[Character&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Character[][].class, &quot;[[Character&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Boolean[].class, &quot;[Boolean&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Boolean[][].class, &quot;[[Boolean&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(String[].class, &quot;[String&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(String[][].class, &quot;[[String&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(BigDecimal[].class, &quot;[BigDecimal&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(BigDecimal[][].class, &quot;[[BigDecimal&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(BigInteger[].class, &quot;[BigInteger&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(BigInteger[][].class, &quot;[[BigInteger&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(UUID[].class, &quot;[UUID&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(UUID[][].class, &quot;[[UUID&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Object.class, &quot;Object&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Object[].class, &quot;[O&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(HashMap.class, &quot;M&quot;);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;HashMap&quot;, HashMap.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.HashMap&quot;, HashMap.class);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(LinkedHashMap.class, &quot;LM&quot;);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;LinkedHashMap&quot;, LinkedHashMap.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.LinkedHashMap&quot;, LinkedHashMap.class);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(TreeMap.class, &quot;TM&quot;);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;TreeMap&quot;, TreeMap.class);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(ArrayList.class, &quot;A&quot;);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;ArrayList&quot;, ArrayList.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.ArrayList&quot;, ArrayList.class);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(LinkedList.class, &quot;LA&quot;);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;LA&quot;, LinkedList.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;LinkedList&quot;, LinkedList.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.LinkedList&quot;, LinkedList.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.concurrent.ConcurrentLinkedQueue&quot;, ConcurrentLinkedQueue.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.concurrent.ConcurrentLinkedDeque&quot;, ConcurrentLinkedDeque.class);</b>
&nbsp;
&nbsp;        //java.util.LinkedHashMap.class,
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(HashSet.class, &quot;HashSet&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(TreeSet.class, &quot;TreeSet&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(LinkedHashSet.class, &quot;LinkedHashSet&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(ConcurrentHashMap.class, &quot;ConcurrentHashMap&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(ConcurrentLinkedQueue.class, &quot;ConcurrentLinkedQueue&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(ConcurrentLinkedDeque.class, &quot;ConcurrentLinkedDeque&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(JSONObject.class, &quot;JSONObject&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(JSONArray.class, &quot;JSONArray&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(Currency.class, &quot;Currency&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(TimeUnit.class, &quot;TimeUnit&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        Class&lt;?&gt;[] classes = new Class[]{</b>
&nbsp;                Object.class,
&nbsp;                Cloneable.class,
&nbsp;                AutoCloseable.class,
&nbsp;                java.lang.Exception.class,
&nbsp;                java.lang.RuntimeException.class,
&nbsp;                java.lang.IllegalAccessError.class,
&nbsp;                java.lang.IllegalAccessException.class,
&nbsp;                java.lang.IllegalArgumentException.class,
&nbsp;                java.lang.IllegalMonitorStateException.class,
&nbsp;                java.lang.IllegalStateException.class,
&nbsp;                java.lang.IllegalThreadStateException.class,
&nbsp;                java.lang.IndexOutOfBoundsException.class,
&nbsp;                java.lang.InstantiationError.class,
&nbsp;                java.lang.InstantiationException.class,
&nbsp;                java.lang.InternalError.class,
&nbsp;                java.lang.InterruptedException.class,
&nbsp;                java.lang.LinkageError.class,
&nbsp;                java.lang.NegativeArraySizeException.class,
&nbsp;                java.lang.NoClassDefFoundError.class,
&nbsp;                java.lang.NoSuchFieldError.class,
&nbsp;                java.lang.NoSuchFieldException.class,
&nbsp;                java.lang.NoSuchMethodError.class,
&nbsp;                java.lang.NoSuchMethodException.class,
&nbsp;                java.lang.NullPointerException.class,
&nbsp;                java.lang.NumberFormatException.class,
&nbsp;                java.lang.OutOfMemoryError.class,
&nbsp;                java.lang.SecurityException.class,
&nbsp;                java.lang.StackOverflowError.class,
&nbsp;                java.lang.StringIndexOutOfBoundsException.class,
&nbsp;                java.lang.TypeNotPresentException.class,
&nbsp;                java.lang.VerifyError.class,
&nbsp;                java.lang.StackTraceElement.class,
&nbsp;                java.util.Hashtable.class,
&nbsp;                java.util.TreeMap.class,
&nbsp;                java.util.IdentityHashMap.class,
&nbsp;                java.util.WeakHashMap.class,
&nbsp;                java.util.HashSet.class,
&nbsp;                java.util.LinkedHashSet.class,
&nbsp;                java.util.TreeSet.class,
&nbsp;                java.util.LinkedList.class,
&nbsp;                java.util.concurrent.TimeUnit.class,
&nbsp;                java.util.concurrent.ConcurrentHashMap.class,
&nbsp;                java.util.concurrent.atomic.AtomicInteger.class,
&nbsp;                java.util.concurrent.atomic.AtomicLong.class,
<b class="fc">&nbsp;                java.util.Collections.EMPTY_MAP.getClass(),</b>
&nbsp;                java.lang.Boolean.class,
&nbsp;                java.lang.Character.class,
&nbsp;                java.lang.Byte.class,
&nbsp;                java.lang.Short.class,
&nbsp;                java.lang.Integer.class,
&nbsp;                java.lang.Long.class,
&nbsp;                java.lang.Float.class,
&nbsp;                java.lang.Double.class,
&nbsp;                java.lang.Number.class,
&nbsp;                java.lang.String.class,
&nbsp;                java.math.BigDecimal.class,
&nbsp;                java.math.BigInteger.class,
&nbsp;                java.util.BitSet.class,
&nbsp;                java.util.Calendar.class,
&nbsp;                java.util.Date.class,
&nbsp;                java.util.Locale.class,
&nbsp;                java.util.UUID.class,
&nbsp;                java.util.Currency.class,
&nbsp;                java.text.SimpleDateFormat.class,
&nbsp;                JSONObject.class,
&nbsp;                JSONArray.class,
&nbsp;                java.util.concurrent.ConcurrentSkipListMap.class,
&nbsp;                java.util.concurrent.ConcurrentSkipListSet.class,
&nbsp;        };
<b class="fc">&nbsp;        for (Class clazz : classes) {</b>
<b class="fc">&nbsp;            TYPE_MAPPINGS.put(clazz.getSimpleName(), clazz);</b>
<b class="fc">&nbsp;            TYPE_MAPPINGS.put(clazz.getName(), clazz);</b>
<b class="fc">&nbsp;            NAME_MAPPINGS.put(clazz, clazz.getSimpleName());</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;JO10&quot;, JSONObject1O.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;[O&quot;, Object[].class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;[Ljava.lang.Object;&quot;, Object[].class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;[java.lang.Object&quot;, Object[].class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;[Object&quot;, Object[].class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;StackTraceElement&quot;, StackTraceElement.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;[StackTraceElement&quot;, StackTraceElement[].class);</b>
&nbsp;
<b class="fc">&nbsp;        String[] items = new String[]{</b>
&nbsp;                &quot;java.util.Collections$UnmodifiableMap&quot;,
&nbsp;                &quot;java.util.Collections$UnmodifiableCollection&quot;,
&nbsp;        };
&nbsp;
<b class="fc">&nbsp;        for (String className : items) {</b>
<b class="fc">&nbsp;            Class&lt;?&gt; clazz = loadClass(className);</b>
<b class="fc">&nbsp;            TYPE_MAPPINGS.put(clazz.getName(), clazz);</b>
&nbsp;        }
&nbsp;
&nbsp;        {
<b class="fc">&nbsp;            if (CLASS_JSON_OBJECT_1x != null) {</b>
<b class="fc">&nbsp;                TYPE_MAPPINGS.putIfAbsent(&quot;JO1&quot;, CLASS_JSON_OBJECT_1x);</b>
<b class="fc">&nbsp;                TYPE_MAPPINGS.putIfAbsent(CLASS_JSON_OBJECT_1x.getName(), CLASS_JSON_OBJECT_1x);</b>
&nbsp;            }
<b class="fc">&nbsp;            if (CLASS_JSON_ARRAY_1x != null) {</b>
<b class="fc">&nbsp;                TYPE_MAPPINGS.putIfAbsent(&quot;JA1&quot;, CLASS_JSON_ARRAY_1x);</b>
<b class="fc">&nbsp;                TYPE_MAPPINGS.putIfAbsent(CLASS_JSON_ARRAY_1x.getName(), CLASS_JSON_ARRAY_1x);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(new HashMap().keySet().getClass(), &quot;Set&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(new LinkedHashMap().keySet().getClass(), &quot;Set&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(new TreeMap&lt;&gt;().keySet().getClass(), &quot;Set&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(((Map) new ConcurrentHashMap()).keySet().getClass(), &quot;Set&quot;); // bug fix for android9</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(((Map) new ConcurrentSkipListMap()).keySet().getClass(), &quot;Set&quot;); // bug fix for android9</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;Set&quot;, HashSet.class);</b>
&nbsp;
<b class="fc">&nbsp;        NAME_MAPPINGS.put(new HashMap().values().getClass(), &quot;List&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(new LinkedHashMap().values().getClass(), &quot;List&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(new TreeMap().values().getClass(), &quot;List&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(new ConcurrentHashMap().values().getClass(), &quot;List&quot;);</b>
<b class="fc">&nbsp;        NAME_MAPPINGS.put(new ConcurrentSkipListMap().values().getClass(), &quot;List&quot;);</b>
&nbsp;
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;List&quot;, ArrayList.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.ImmutableCollections$Map1&quot;, HashMap.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.ImmutableCollections$MapN&quot;, LinkedHashMap.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.ImmutableCollections$Set12&quot;, LinkedHashSet.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.ImmutableCollections$SetN&quot;, LinkedHashSet.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.ImmutableCollections$List12&quot;, ArrayList.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.ImmutableCollections$ListN&quot;, ArrayList.class);</b>
<b class="fc">&nbsp;        TYPE_MAPPINGS.put(&quot;java.util.ImmutableCollections$SubList&quot;, ArrayList.class);</b>
&nbsp;
<b class="fc">&nbsp;        for (Map.Entry&lt;Class, String&gt; entry : NAME_MAPPINGS.entrySet()) {</b>
<b class="fc">&nbsp;            TYPE_MAPPINGS.putIfAbsent(entry.getValue(), entry.getKey());</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    public static String getTypeName(Class type) {
<b class="fc">&nbsp;        String mapTypeName = NAME_MAPPINGS.get(type);</b>
<b class="fc">&nbsp;        if (mapTypeName != null) {</b>
<b class="fc">&nbsp;            return mapTypeName;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (Proxy.isProxyClass(type)) {</b>
<b class="nc">&nbsp;            Class[] interfaces = type.getInterfaces();</b>
<b class="nc">&nbsp;            if (interfaces.length &gt; 0) {</b>
<b class="nc">&nbsp;                type = interfaces[0];</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        String typeName = type.getTypeName();</b>
<b class="nc">&nbsp;        switch (typeName) {</b>
&nbsp;            case &quot;com.alibaba.fastjson.JSONObject&quot;:
<b class="nc">&nbsp;                NAME_MAPPINGS.putIfAbsent(type, &quot;JO1&quot;);</b>
<b class="nc">&nbsp;                return NAME_MAPPINGS.get(type);</b>
&nbsp;            case &quot;com.alibaba.fastjson.JSONArray&quot;:
<b class="nc">&nbsp;                NAME_MAPPINGS.putIfAbsent(type, &quot;JA1&quot;);</b>
<b class="nc">&nbsp;                return NAME_MAPPINGS.get(type);</b>
&nbsp;//            case &quot;org.apache.commons.lang3.tuple.ImmutablePair&quot;:
&nbsp;//                NAME_MAPPINGS.putIfAbsent(type, &quot;org.apache.commons.lang3.tuple.Pair&quot;);
&nbsp;//                return NAME_MAPPINGS.get(type);
&nbsp;            default:
&nbsp;                break;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return typeName;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Class getMapping(String typeName) {
<b class="nc">&nbsp;        return TYPE_MAPPINGS.get(typeName);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static BigDecimal toBigDecimal(Object value) {
<b class="nc">&nbsp;        if (value == null || value instanceof BigDecimal) {</b>
<b class="nc">&nbsp;            return (BigDecimal) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Byte || value instanceof Short || value instanceof Integer || value instanceof Long) {</b>
<b class="nc">&nbsp;            return BigDecimal.valueOf(((Number) value).longValue());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return new BigDecimal(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to decimal from &quot; + value.getClass());</b>
&nbsp;    }
&nbsp;
&nbsp;    public static BigInteger toBigInteger(Object value) {
<b class="nc">&nbsp;        if (value == null || value instanceof BigInteger) {</b>
<b class="nc">&nbsp;            return (BigInteger) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Byte || value instanceof Short || value instanceof Integer || value instanceof Long) {</b>
<b class="nc">&nbsp;            return BigInteger.valueOf(((Number) value).longValue());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return new BigInteger(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to bigint&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Long toLong(Object value) {
<b class="nc">&nbsp;        if (value == null || value instanceof Long) {</b>
<b class="nc">&nbsp;            return (Long) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return Long.valueOf(((Number) value).longValue());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Long.parseLong(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to long, class &quot; + value.getClass());</b>
&nbsp;    }
&nbsp;
&nbsp;    public static long toLongValue(Object value) {
<b class="nc">&nbsp;        if (value == null) {</b>
<b class="nc">&nbsp;            return 0L;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Long) {</b>
<b class="nc">&nbsp;            return (Long) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return ((Number) value).longValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Long.parseLong(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to long from &quot; + value.getClass());</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Boolean parseBoolean(byte[] bytes, int off, int len) {
<b class="nc">&nbsp;        switch (len) {</b>
&nbsp;            case 0:
<b class="nc">&nbsp;                return null;</b>
&nbsp;            case 1: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                if (b0 == &#39;1&#39; || b0 == &#39;Y&#39;) {</b>
<b class="nc">&nbsp;                    return Boolean.TRUE;</b>
&nbsp;                }
<b class="nc">&nbsp;                if (b0 == &#39;0&#39; || b0 == &#39;N&#39;) {</b>
<b class="nc">&nbsp;                    return Boolean.FALSE;</b>
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 4:
<b class="nc">&nbsp;                if (bytes[off] == &#39;t&#39; &amp;&amp; bytes[off + 1] == &#39;r&#39; &amp;&amp; bytes[off + 2] == &#39;u&#39; &amp;&amp; bytes[off + 3] == &#39;e&#39;) {</b>
<b class="nc">&nbsp;                    return Boolean.TRUE;</b>
&nbsp;                }
&nbsp;                break;
&nbsp;            case 5:
<b class="nc">&nbsp;                if (bytes[off] == &#39;f&#39;</b>
&nbsp;                        &amp;&amp; bytes[off + 1] == &#39;a&#39;
&nbsp;                        &amp;&amp; bytes[off + 2] == &#39;l&#39;
&nbsp;                        &amp;&amp; bytes[off + 3] == &#39;s&#39;
&nbsp;                        &amp;&amp; bytes[off + 4] == &#39;e&#39;) {
<b class="nc">&nbsp;                    return Boolean.FALSE;</b>
&nbsp;                }
&nbsp;                break;
&nbsp;            default:
&nbsp;                break;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        String str = new String(bytes, off, len);</b>
<b class="nc">&nbsp;        return Boolean.parseBoolean(str);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Integer parseInt(byte[] bytes, int off, int len) {
<b class="nc">&nbsp;        switch (len) {</b>
&nbsp;            case 0:
<b class="nc">&nbsp;                return null;</b>
&nbsp;            case 1: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                    return b0 - &#39;0&#39;;</b>
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 2: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;) {
<b class="nc">&nbsp;                    return (b0 - &#39;0&#39;) * 10</b>
&nbsp;                            + (b1 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 3: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;) {
<b class="nc">&nbsp;                    return (b0 - &#39;0&#39;) * 100</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 10
&nbsp;                            + (b2 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 4: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (b0 - &#39;0&#39;) * 1000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 100
&nbsp;                            + (b2 - &#39;0&#39;) * 10
&nbsp;                            + (b3 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 5: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                byte b4 = bytes[off + 4];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b4 &gt;= &#39;0&#39; &amp;&amp; b4 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (b0 - &#39;0&#39;) * 10_000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 1000
&nbsp;                            + (b2 - &#39;0&#39;) * 100
&nbsp;                            + (b3 - &#39;0&#39;) * 10
&nbsp;                            + (b4 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 6: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                byte b4 = bytes[off + 4];</b>
<b class="nc">&nbsp;                byte b5 = bytes[off + 5];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b4 &gt;= &#39;0&#39; &amp;&amp; b4 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b5 &gt;= &#39;0&#39; &amp;&amp; b5 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (b0 - &#39;0&#39;) * 100_000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 10_000
&nbsp;                            + (b2 - &#39;0&#39;) * 1_000
&nbsp;                            + (b3 - &#39;0&#39;) * 100
&nbsp;                            + (b4 - &#39;0&#39;) * 10
&nbsp;                            + (b5 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 7: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                byte b4 = bytes[off + 4];</b>
<b class="nc">&nbsp;                byte b5 = bytes[off + 5];</b>
<b class="nc">&nbsp;                byte b6 = bytes[off + 6];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b4 &gt;= &#39;0&#39; &amp;&amp; b4 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b5 &gt;= &#39;0&#39; &amp;&amp; b5 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b6 &gt;= &#39;0&#39; &amp;&amp; b6 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (b0 - &#39;0&#39;) * 1_000_000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 100_000
&nbsp;                            + (b2 - &#39;0&#39;) * 10_000
&nbsp;                            + (b3 - &#39;0&#39;) * 1_000
&nbsp;                            + (b4 - &#39;0&#39;) * 100
&nbsp;                            + (b5 - &#39;0&#39;) * 10
&nbsp;                            + (b6 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 8: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                byte b4 = bytes[off + 4];</b>
<b class="nc">&nbsp;                byte b5 = bytes[off + 5];</b>
<b class="nc">&nbsp;                byte b6 = bytes[off + 6];</b>
<b class="nc">&nbsp;                byte b7 = bytes[off + 7];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b4 &gt;= &#39;0&#39; &amp;&amp; b4 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b5 &gt;= &#39;0&#39; &amp;&amp; b5 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b6 &gt;= &#39;0&#39; &amp;&amp; b6 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b7 &gt;= &#39;0&#39; &amp;&amp; b7 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (b0 - &#39;0&#39;) * 10_000_000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 1_000_000
&nbsp;                            + (b2 - &#39;0&#39;) * 100_000
&nbsp;                            + (b3 - &#39;0&#39;) * 10_000
&nbsp;                            + (b4 - &#39;0&#39;) * 1_000
&nbsp;                            + (b5 - &#39;0&#39;) * 100
&nbsp;                            + (b6 - &#39;0&#39;) * 10
&nbsp;                            + (b7 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            default:
&nbsp;                break;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        String str = new String(bytes, off, len);</b>
<b class="nc">&nbsp;        return Integer.parseInt(str);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Long parseLong(byte[] bytes, int off, int len) {
<b class="nc">&nbsp;        switch (len) {</b>
&nbsp;            case 0:
<b class="nc">&nbsp;                return null;</b>
&nbsp;            case 1: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;) {</b>
<b class="nc">&nbsp;                    return (long) (b0 - &#39;0&#39;);</b>
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 2: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;) {
<b class="nc">&nbsp;                    return (long) (b0 - &#39;0&#39;) * 10</b>
&nbsp;                            + (b1 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 3: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;) {
<b class="nc">&nbsp;                    return (long) (b0 - &#39;0&#39;) * 100</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 10
&nbsp;                            + (b2 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 4: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;) {
<b class="nc">&nbsp;                    return (long) (b0 - &#39;0&#39;) * 1000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 100
&nbsp;                            + (b2 - &#39;0&#39;) * 10
&nbsp;                            + (b3 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 5: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                byte b4 = bytes[off + 4];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b4 &gt;= &#39;0&#39; &amp;&amp; b4 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (long) (b0 - &#39;0&#39;) * 10_000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 1000
&nbsp;                            + (b2 - &#39;0&#39;) * 100
&nbsp;                            + (b3 - &#39;0&#39;) * 10
&nbsp;                            + (b4 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 6: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                byte b4 = bytes[off + 4];</b>
<b class="nc">&nbsp;                byte b5 = bytes[off + 5];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b4 &gt;= &#39;0&#39; &amp;&amp; b4 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b5 &gt;= &#39;0&#39; &amp;&amp; b5 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (long) (b0 - &#39;0&#39;) * 100_000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 10_000
&nbsp;                            + (b2 - &#39;0&#39;) * 1_000
&nbsp;                            + (b3 - &#39;0&#39;) * 100
&nbsp;                            + (b4 - &#39;0&#39;) * 10
&nbsp;                            + (b5 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 7: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                byte b4 = bytes[off + 4];</b>
<b class="nc">&nbsp;                byte b5 = bytes[off + 5];</b>
<b class="nc">&nbsp;                byte b6 = bytes[off + 6];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b4 &gt;= &#39;0&#39; &amp;&amp; b4 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b5 &gt;= &#39;0&#39; &amp;&amp; b5 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b6 &gt;= &#39;0&#39; &amp;&amp; b6 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (long) (b0 - &#39;0&#39;) * 1_000_000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 100_000
&nbsp;                            + (b2 - &#39;0&#39;) * 10_000
&nbsp;                            + (b3 - &#39;0&#39;) * 1_000
&nbsp;                            + (b4 - &#39;0&#39;) * 100
&nbsp;                            + (b5 - &#39;0&#39;) * 10
&nbsp;                            + (b6 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            case 8: {
<b class="nc">&nbsp;                byte b0 = bytes[off];</b>
<b class="nc">&nbsp;                byte b1 = bytes[off + 1];</b>
<b class="nc">&nbsp;                byte b2 = bytes[off + 2];</b>
<b class="nc">&nbsp;                byte b3 = bytes[off + 3];</b>
<b class="nc">&nbsp;                byte b4 = bytes[off + 4];</b>
<b class="nc">&nbsp;                byte b5 = bytes[off + 5];</b>
<b class="nc">&nbsp;                byte b6 = bytes[off + 6];</b>
<b class="nc">&nbsp;                byte b7 = bytes[off + 7];</b>
<b class="nc">&nbsp;                if (b0 &gt;= &#39;0&#39; &amp;&amp; b0 &lt;= &#39;9&#39;</b>
&nbsp;                        &amp;&amp; b1 &gt;= &#39;0&#39; &amp;&amp; b1 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b2 &gt;= &#39;0&#39; &amp;&amp; b2 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b3 &gt;= &#39;0&#39; &amp;&amp; b3 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b4 &gt;= &#39;0&#39; &amp;&amp; b4 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b5 &gt;= &#39;0&#39; &amp;&amp; b5 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b6 &gt;= &#39;0&#39; &amp;&amp; b6 &lt;= &#39;9&#39;
&nbsp;                        &amp;&amp; b7 &gt;= &#39;0&#39; &amp;&amp; b7 &lt;= &#39;9&#39;
&nbsp;                ) {
<b class="nc">&nbsp;                    return (long) (b0 - &#39;0&#39;) * 10_000_000</b>
&nbsp;                            + (b1 - &#39;0&#39;) * 1_000_000
&nbsp;                            + (b2 - &#39;0&#39;) * 100_000
&nbsp;                            + (b3 - &#39;0&#39;) * 10_000
&nbsp;                            + (b4 - &#39;0&#39;) * 1_000
&nbsp;                            + (b5 - &#39;0&#39;) * 100
&nbsp;                            + (b6 - &#39;0&#39;) * 10
&nbsp;                            + (b7 - &#39;0&#39;);
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;            default:
&nbsp;                break;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        String str = new String(bytes, off, len);</b>
<b class="nc">&nbsp;        return Long.parseLong(str);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static BigDecimal parseBigDecimal(byte[] bytes, int off, int len) {
<b class="nc">&nbsp;        if (len == 0) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        char[] chars = new char[len];</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; len; i++) {</b>
<b class="nc">&nbsp;            chars[i] = (char) bytes[off + i];</b>
&nbsp;        }
<b class="nc">&nbsp;        return new BigDecimal(chars, 0, chars.length);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Integer toInteger(Object value) {
<b class="nc">&nbsp;        if (value == null || value instanceof Integer) {</b>
<b class="nc">&nbsp;            return (Integer) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return Integer.valueOf(((Number) value).intValue());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Integer.parseInt(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Map &amp;&amp; ((Map&lt;?, ?&gt;) value).isEmpty()) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Boolean) {</b>
<b class="nc">&nbsp;            return ((Boolean) value).booleanValue() ? 1 : 0;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to integer&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Byte toByte(Object value) {
<b class="nc">&nbsp;        if (value == null || value instanceof Byte) {</b>
<b class="nc">&nbsp;            return (Byte) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return ((Number) value).byteValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Byte.parseByte(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to byte&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static byte toByteValue(Object value) {
<b class="nc">&nbsp;        if (value == null) {</b>
<b class="nc">&nbsp;            return 0;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Byte) {</b>
<b class="nc">&nbsp;            return (Byte) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return ((Number) value).byteValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Byte.parseByte(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to byte&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Short toShort(Object value) {
<b class="nc">&nbsp;        if (value == null || value instanceof Short) {</b>
<b class="nc">&nbsp;            return (Short) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return ((Number) value).shortValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Short.parseShort(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to byte&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static short toShortValue(Object value) {
<b class="nc">&nbsp;        if (value == null) {</b>
<b class="nc">&nbsp;            return 0;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Short) {</b>
<b class="nc">&nbsp;            return (Short) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return (byte) ((Number) value).shortValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Short.parseShort(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to byte&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static int toIntValue(Object value) {
<b class="nc">&nbsp;        if (value == null) {</b>
<b class="nc">&nbsp;            return 0;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Integer) {</b>
<b class="nc">&nbsp;            return (Integer) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return Integer.valueOf(((Number) value).intValue());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (str.indexOf(&#39;.&#39;) != -1) {</b>
<b class="nc">&nbsp;                return new BigDecimal(str).intValueExact();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return Integer.parseInt(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to decimal&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static boolean toBooleanValue(Object value) {
<b class="nc">&nbsp;        if (value == null) {</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Boolean) {</b>
<b class="nc">&nbsp;            return ((Boolean) value).booleanValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Boolean.parseBoolean(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            int intValue = ((Number) value).intValue();</b>
<b class="nc">&nbsp;            if (intValue == 1) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (intValue == 0) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to boolean&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Boolean toBoolean(Object value) {
<b class="nc">&nbsp;        if (value == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Boolean) {</b>
<b class="nc">&nbsp;            return ((Boolean) value).booleanValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Boolean.parseBoolean(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            int intValue = ((Number) value).intValue();</b>
<b class="nc">&nbsp;            if (intValue == 1) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (intValue == 0) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to boolean&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static float toFloatValue(Object value) {
<b class="nc">&nbsp;        if (value == null) {</b>
<b class="nc">&nbsp;            return 0F;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Float) {</b>
<b class="nc">&nbsp;            return (Float) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return ((Number) value).floatValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Float.parseFloat(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to decimal&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Float toFloat(Object value) {
<b class="nc">&nbsp;        if (value == null || value instanceof Float) {</b>
<b class="nc">&nbsp;            return (Float) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return ((Number) value).floatValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Float.parseFloat(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to decimal&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static double toDoubleValue(Object value) {
<b class="nc">&nbsp;        if (value == null) {</b>
<b class="nc">&nbsp;            return 0D;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Double) {</b>
<b class="nc">&nbsp;            return (Double) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return ((Number) value).doubleValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return 0D;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Double.parseDouble(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to decimal&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Double toDouble(Object value) {
<b class="nc">&nbsp;        if (value == null || value instanceof Double) {</b>
<b class="nc">&nbsp;            return (Double) value;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof Number) {</b>
<b class="nc">&nbsp;            return ((Number) value).doubleValue();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (value instanceof String) {</b>
<b class="nc">&nbsp;            String str = (String) value;</b>
<b class="nc">&nbsp;            if (str.isEmpty() || &quot;null&quot;.equals(str)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            return Double.parseDouble(str);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        throw new JSONException(&quot;can not cast to decimal&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static int compare(Object a, Object b) {
<b class="nc">&nbsp;        if (a.getClass() == b.getClass()) {</b>
<b class="nc">&nbsp;            return ((Comparable) a).compareTo(b);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Class typeA = a.getClass();</b>
<b class="nc">&nbsp;        Class typeB = b.getClass();</b>
&nbsp;
<b class="nc">&nbsp;        if (typeA == BigDecimal.class) {</b>
<b class="nc">&nbsp;            if (typeB == Integer.class) {</b>
<b class="nc">&nbsp;                b = new BigDecimal((Integer) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Long.class) {</b>
<b class="nc">&nbsp;                b = new BigDecimal((Long) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Float.class) {</b>
<b class="nc">&nbsp;                b = new BigDecimal((Float) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Double.class) {</b>
<b class="nc">&nbsp;                b = new BigDecimal((Double) b);</b>
<b class="nc">&nbsp;            } else if (typeB == BigInteger.class) {</b>
<b class="nc">&nbsp;                b = new BigDecimal((BigInteger) b);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (typeA == BigInteger.class) {</b>
<b class="nc">&nbsp;            if (typeB == Integer.class) {</b>
<b class="nc">&nbsp;                b = BigInteger.valueOf((Integer) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Long.class) {</b>
<b class="nc">&nbsp;                b = BigInteger.valueOf((Long) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Float.class) {</b>
<b class="nc">&nbsp;                b = new BigDecimal((Float) b);</b>
<b class="nc">&nbsp;                a = new BigDecimal((BigInteger) a);</b>
<b class="nc">&nbsp;            } else if (typeB == Double.class) {</b>
<b class="nc">&nbsp;                b = new BigDecimal((Double) b);</b>
<b class="nc">&nbsp;                a = new BigDecimal((BigInteger) a);</b>
<b class="nc">&nbsp;            } else if (typeB == BigDecimal.class) {</b>
<b class="nc">&nbsp;                a = new BigDecimal((BigInteger) a);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (typeA == Long.class) {</b>
<b class="nc">&nbsp;            if (typeB == Integer.class) {</b>
<b class="nc">&nbsp;                b = new Long((Integer) b);</b>
<b class="nc">&nbsp;            } else if (typeB == BigDecimal.class) {</b>
<b class="nc">&nbsp;                a = new BigDecimal((Long) a);</b>
<b class="nc">&nbsp;            } else if (typeB == Float.class) {</b>
<b class="nc">&nbsp;                a = new Float((Long) a);</b>
<b class="nc">&nbsp;            } else if (typeB == Double.class) {</b>
<b class="nc">&nbsp;                a = new Double((Long) a);</b>
<b class="nc">&nbsp;            } else if (typeB == BigInteger.class) {</b>
<b class="nc">&nbsp;                a = BigInteger.valueOf((Long) a);</b>
<b class="nc">&nbsp;            } else if (typeB == String.class) {</b>
<b class="nc">&nbsp;                a = BigDecimal.valueOf((Long) a);</b>
<b class="nc">&nbsp;                b = new BigDecimal((String) b);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (typeA == Integer.class) {</b>
<b class="nc">&nbsp;            if (typeB == Long.class) {</b>
<b class="nc">&nbsp;                a = new Long((Integer) a);</b>
<b class="nc">&nbsp;            } else if (typeB == BigDecimal.class) {</b>
<b class="nc">&nbsp;                a = new BigDecimal((Integer) a);</b>
<b class="nc">&nbsp;            } else if (typeB == BigInteger.class) {</b>
<b class="nc">&nbsp;                a = BigInteger.valueOf((Integer) a);</b>
<b class="nc">&nbsp;            } else if (typeB == Float.class) {</b>
<b class="nc">&nbsp;                a = new Float((Integer) a);</b>
<b class="nc">&nbsp;            } else if (typeB == Double.class) {</b>
<b class="nc">&nbsp;                a = new Double((Integer) a);</b>
<b class="nc">&nbsp;            } else if (typeB == String.class) {</b>
<b class="nc">&nbsp;                a = BigDecimal.valueOf((Integer) a);</b>
<b class="nc">&nbsp;                b = new BigDecimal((String) b);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (typeA == Double.class) {</b>
<b class="nc">&nbsp;            if (typeB == Integer.class) {</b>
<b class="nc">&nbsp;                b = new Double((Integer) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Long.class) {</b>
<b class="nc">&nbsp;                b = new Double((Long) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Float.class) {</b>
<b class="nc">&nbsp;                b = new Double((Float) b);</b>
<b class="nc">&nbsp;            } else if (typeB == BigDecimal.class) {</b>
<b class="nc">&nbsp;                a = BigDecimal.valueOf((Double) a);</b>
<b class="nc">&nbsp;            } else if (typeB == String.class) {</b>
<b class="nc">&nbsp;                a = BigDecimal.valueOf((Double) a);</b>
<b class="nc">&nbsp;                b = new BigDecimal((String) b);</b>
<b class="nc">&nbsp;            } else if (typeB == BigInteger.class) {</b>
<b class="nc">&nbsp;                a = BigDecimal.valueOf((Double) a);</b>
<b class="nc">&nbsp;                b = new BigDecimal((BigInteger) b);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (typeA == Float.class) {</b>
<b class="nc">&nbsp;            if (typeB == Integer.class) {</b>
<b class="nc">&nbsp;                b = new Float((Integer) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Long.class) {</b>
<b class="nc">&nbsp;                b = new Float((Long) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Double.class) {</b>
<b class="nc">&nbsp;                a = new Double((Float) a);</b>
<b class="nc">&nbsp;            } else if (typeB == BigDecimal.class) {</b>
<b class="nc">&nbsp;                a = BigDecimal.valueOf((Float) a);</b>
<b class="nc">&nbsp;            } else if (typeB == String.class) {</b>
<b class="nc">&nbsp;                a = BigDecimal.valueOf((Float) a);</b>
<b class="nc">&nbsp;                b = new BigDecimal((String) b);</b>
<b class="nc">&nbsp;            } else if (typeB == BigInteger.class) {</b>
<b class="nc">&nbsp;                a = BigDecimal.valueOf((Float) a);</b>
<b class="nc">&nbsp;                b = new BigDecimal((BigInteger) b);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (typeA == String.class) {</b>
<b class="nc">&nbsp;            String strA = (String) a;</b>
<b class="nc">&nbsp;            if (typeB == Integer.class) {</b>
<b class="nc">&nbsp;                NumberFormatException error = null;</b>
&nbsp;                try {
<b class="nc">&nbsp;                    a = Integer.parseInt(strA);</b>
<b class="nc">&nbsp;                } catch (NumberFormatException ex) {</b>
<b class="nc">&nbsp;                    error = ex;</b>
<b class="nc">&nbsp;                }</b>
<b class="nc">&nbsp;                if (error != null) {</b>
&nbsp;                    try {
<b class="nc">&nbsp;                        a = Long.parseLong(strA);</b>
<b class="nc">&nbsp;                        b = Long.valueOf((Integer) b);</b>
<b class="nc">&nbsp;                        error = null;</b>
<b class="nc">&nbsp;                    } catch (NumberFormatException ex) {</b>
<b class="nc">&nbsp;                        error = ex;</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;                }
<b class="nc">&nbsp;                if (error != null) {</b>
<b class="nc">&nbsp;                    a = new BigDecimal(strA);</b>
<b class="nc">&nbsp;                    b = BigDecimal.valueOf((Integer) b);</b>
&nbsp;                }
<b class="nc">&nbsp;            } else if (typeB == Long.class) {</b>
<b class="nc">&nbsp;                a = new BigDecimal(strA);</b>
<b class="nc">&nbsp;                b = BigDecimal.valueOf((Long) b);</b>
<b class="nc">&nbsp;            } else if (typeB == Float.class) {</b>
<b class="nc">&nbsp;                a = Float.parseFloat(strA);</b>
<b class="nc">&nbsp;            } else if (typeB == Double.class) {</b>
<b class="nc">&nbsp;                a = Double.parseDouble(strA);</b>
<b class="nc">&nbsp;            } else if (typeB == BigInteger.class) {</b>
<b class="nc">&nbsp;                a = new BigInteger(strA);</b>
<b class="nc">&nbsp;            } else if (typeB == BigDecimal.class) {</b>
<b class="nc">&nbsp;                a = new BigDecimal(strA);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return ((Comparable) a).compareTo(b);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Object getDefaultValue(Type paramType) {
<b class="nc">&nbsp;        if (paramType == int.class) {</b>
<b class="nc">&nbsp;            return 0;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == long.class) {</b>
<b class="nc">&nbsp;            return 0L;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == float.class) {</b>
<b class="nc">&nbsp;            return 0F;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == double.class) {</b>
<b class="nc">&nbsp;            return 0D;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == boolean.class) {</b>
<b class="nc">&nbsp;            return Boolean.FALSE;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == short.class) {</b>
<b class="nc">&nbsp;            return (short) 0;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == byte.class) {</b>
<b class="nc">&nbsp;            return (byte) 0;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == char.class) {</b>
<b class="nc">&nbsp;            return (char) 0;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == Optional.class) {</b>
<b class="nc">&nbsp;            return Optional.empty();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == OptionalInt.class) {</b>
<b class="nc">&nbsp;            return OptionalInt.empty();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == OptionalLong.class) {</b>
<b class="nc">&nbsp;            return OptionalLong.empty();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (paramType == OptionalDouble.class) {</b>
<b class="nc">&nbsp;            return OptionalDouble.empty();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Class loadClass(String className) {
<b class="fc">&nbsp;        if (className.length() &gt;= 192) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        switch (className) {</b>
&nbsp;            case &quot;O&quot;:
&nbsp;            case &quot;Object&quot;:
&nbsp;            case &quot;java.lang.Object&quot;:
<b class="nc">&nbsp;                return Object.class;</b>
&nbsp;            case &quot;java.util.Collections$EmptyMap&quot;:
<b class="nc">&nbsp;                return Collections.EMPTY_MAP.getClass();</b>
&nbsp;            case &quot;java.util.Collections$EmptyList&quot;:
<b class="nc">&nbsp;                return Collections.EMPTY_LIST.getClass();</b>
&nbsp;            case &quot;java.util.Collections$EmptySet&quot;:
<b class="nc">&nbsp;                return Collections.EMPTY_SET.getClass();</b>
&nbsp;            case &quot;java.util.Optional&quot;:
<b class="nc">&nbsp;                return Optional.class;</b>
&nbsp;            case &quot;java.util.OptionalInt&quot;:
<b class="nc">&nbsp;                return OptionalInt.class;</b>
&nbsp;            case &quot;java.util.OptionalLong&quot;:
<b class="nc">&nbsp;                return OptionalLong.class;</b>
&nbsp;            case &quot;List&quot;:
&nbsp;            case &quot;java.util.List&quot;:
<b class="nc">&nbsp;                return List.class;</b>
&nbsp;            case &quot;A&quot;:
&nbsp;            case &quot;ArrayList&quot;:
&nbsp;            case &quot;java.util.ArrayList&quot;:
<b class="nc">&nbsp;                return ArrayList.class;</b>
&nbsp;            case &quot;LA&quot;:
&nbsp;            case &quot;LinkedList&quot;:
&nbsp;            case &quot;java.util.LinkedList&quot;:
<b class="nc">&nbsp;                return LinkedList.class;</b>
&nbsp;            case &quot;Map&quot;:
&nbsp;            case &quot;java.util.Map&quot;:
<b class="nc">&nbsp;                return Map.class;</b>
&nbsp;            case &quot;M&quot;:
&nbsp;            case &quot;HashMap&quot;:
&nbsp;            case &quot;java.util.HashMap&quot;:
<b class="nc">&nbsp;                return HashMap.class;</b>
&nbsp;            case &quot;LM&quot;:
&nbsp;            case &quot;LinkedHashMap&quot;:
&nbsp;            case &quot;java.util.LinkedHashMap&quot;:
<b class="nc">&nbsp;                return LinkedHashMap.class;</b>
&nbsp;            case &quot;ConcurrentHashMap&quot;:
<b class="nc">&nbsp;                return ConcurrentHashMap.class;</b>
&nbsp;            case &quot;ConcurrentLinkedQueue&quot;:
<b class="nc">&nbsp;                return ConcurrentLinkedQueue.class;</b>
&nbsp;            case &quot;ConcurrentLinkedDeque&quot;:
<b class="nc">&nbsp;                return ConcurrentLinkedDeque.class;</b>
&nbsp;            case &quot;JSONObject&quot;:
<b class="nc">&nbsp;                return JSONObject.class;</b>
&nbsp;            case &quot;JO1&quot;:
<b class="nc">&nbsp;                className = &quot;com.alibaba.fastjson.JSONObject&quot;;</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case &quot;Set&quot;:
&nbsp;            case &quot;java.util.Set&quot;:
<b class="nc">&nbsp;                return Set.class;</b>
&nbsp;            case &quot;HashSet&quot;:
&nbsp;            case &quot;java.util.HashSet&quot;:
<b class="nc">&nbsp;                return HashSet.class;</b>
&nbsp;            case &quot;LinkedHashSet&quot;:
&nbsp;            case &quot;java.util.LinkedHashSet&quot;:
<b class="nc">&nbsp;                return LinkedHashSet.class;</b>
&nbsp;            case &quot;TreeSet&quot;:
&nbsp;            case &quot;java.util.TreeSet&quot;:
<b class="nc">&nbsp;                return TreeSet.class;</b>
&nbsp;            case &quot;java.lang.Class&quot;:
<b class="nc">&nbsp;                return Class.class;</b>
&nbsp;            case &quot;java.lang.Integer&quot;:
<b class="nc">&nbsp;                return Integer.class;</b>
&nbsp;            case &quot;java.lang.Long&quot;:
<b class="nc">&nbsp;                return Long.class;</b>
&nbsp;            case &quot;String&quot;:
&nbsp;            case &quot;java.lang.String&quot;:
<b class="nc">&nbsp;                return String.class;</b>
&nbsp;            case &quot;[String&quot;:
<b class="nc">&nbsp;                return String[].class;</b>
&nbsp;            case &quot;I&quot;:
&nbsp;            case &quot;int&quot;:
<b class="nc">&nbsp;                return int.class;</b>
&nbsp;            case &quot;S&quot;:
&nbsp;            case &quot;short&quot;:
<b class="nc">&nbsp;                return short.class;</b>
&nbsp;            case &quot;J&quot;:
&nbsp;            case &quot;long&quot;:
<b class="nc">&nbsp;                return long.class;</b>
&nbsp;            case &quot;Z&quot;:
&nbsp;            case &quot;boolean&quot;:
<b class="nc">&nbsp;                return boolean.class;</b>
&nbsp;            case &quot;B&quot;:
&nbsp;            case &quot;byte&quot;:
<b class="nc">&nbsp;                return byte.class;</b>
&nbsp;            case &quot;F&quot;:
&nbsp;            case &quot;float&quot;:
<b class="nc">&nbsp;                return float.class;</b>
&nbsp;            case &quot;D&quot;:
&nbsp;            case &quot;double&quot;:
<b class="nc">&nbsp;                return double.class;</b>
&nbsp;            case &quot;C&quot;:
&nbsp;            case &quot;char&quot;:
<b class="nc">&nbsp;                return char.class;</b>
&nbsp;            case &quot;[B&quot;:
&nbsp;            case &quot;byte[]&quot;:
<b class="nc">&nbsp;                return byte[].class;</b>
&nbsp;            case &quot;[S&quot;:
&nbsp;            case &quot;short[]&quot;:
<b class="nc">&nbsp;                return short[].class;</b>
&nbsp;            case &quot;[I&quot;:
&nbsp;            case &quot;int[]&quot;:
<b class="nc">&nbsp;                return int[].class;</b>
&nbsp;            case &quot;[J&quot;:
&nbsp;            case &quot;long[]&quot;:
<b class="nc">&nbsp;                return long[].class;</b>
&nbsp;            case &quot;[F&quot;:
&nbsp;            case &quot;float[]&quot;:
<b class="nc">&nbsp;                return float[].class;</b>
&nbsp;            case &quot;[D&quot;:
&nbsp;            case &quot;double[]&quot;:
<b class="nc">&nbsp;                return double[].class;</b>
&nbsp;            case &quot;[C&quot;:
&nbsp;            case &quot;char[]&quot;:
<b class="nc">&nbsp;                return char[].class;</b>
&nbsp;            case &quot;[Z&quot;:
&nbsp;            case &quot;boolean[]&quot;:
<b class="nc">&nbsp;                return boolean[].class;</b>
&nbsp;            case &quot;[O&quot;:
<b class="nc">&nbsp;                return Object[].class;</b>
&nbsp;            case &quot;UUID&quot;:
<b class="nc">&nbsp;                return UUID.class;</b>
&nbsp;            case &quot;Date&quot;:
<b class="nc">&nbsp;                return Date.class;</b>
&nbsp;            case &quot;Calendar&quot;:
<b class="nc">&nbsp;                return Calendar.class;</b>
&nbsp;            case &quot;java.io.IOException&quot;:
<b class="nc">&nbsp;                return java.io.IOException.class;</b>
&nbsp;            case &quot;java.util.Collections$UnmodifiableRandomAccessList&quot;:
<b class="nc">&nbsp;                return CLASS_UNMODIFIABLE_LIST;</b>
&nbsp;            case &quot;java.util.Arrays$ArrayList&quot;:
<b class="nc">&nbsp;                return Arrays.asList(1).getClass();</b>
&nbsp;            case &quot;java.util.Collections$SingletonList&quot;:
<b class="nc">&nbsp;                return CLASS_SINGLE_List;</b>
&nbsp;            case &quot;java.util.Collections$SingletonSet&quot;:
<b class="nc">&nbsp;                return CLASS_SINGLE_SET;</b>
&nbsp;            default:
&nbsp;                break;
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        Class mapping = TYPE_MAPPINGS.get(className);</b>
<b class="fc">&nbsp;        if (mapping != null) {</b>
<b class="nc">&nbsp;            return mapping;</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        if (className.startsWith(&quot;java.util.ImmutableCollections$&quot;)) {</b>
&nbsp;            try {
<b class="nc">&nbsp;                return Class.forName(className);</b>
<b class="nc">&nbsp;            } catch (ClassNotFoundException e) {</b>
<b class="nc">&nbsp;                return CLASS_UNMODIFIABLE_LIST;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        if (className.charAt(0) == &#39;L&#39; &amp;&amp; className.charAt(className.length() - 1) == &#39;;&#39;) {</b>
<b class="nc">&nbsp;            className = className.substring(1, className.length() - 1);</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        if (className.charAt(0) == &#39;[&#39; || className.endsWith(&quot;[]&quot;)) {</b>
<b class="nc">&nbsp;            String itemClassName = className.charAt(0) == &#39;[&#39; ? className.substring(1) : className.substring(0, className.length() - 2);</b>
<b class="nc">&nbsp;            Class itemClass = loadClass(itemClassName);</b>
<b class="nc">&nbsp;            if (itemClass == null) {</b>
<b class="nc">&nbsp;                throw new JSONException(&quot;load class error &quot; + className);</b>
&nbsp;            }
<b class="nc">&nbsp;            return Array.newInstance(itemClass, 0).getClass();</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        ClassLoader contextClassLoader = Thread.currentThread().getContextClassLoader();</b>
<b class="fc">&nbsp;        if (contextClassLoader != null) {</b>
&nbsp;            try {
<b class="fc">&nbsp;                return contextClassLoader.loadClass(className);</b>
<b class="nc">&nbsp;            } catch (ClassNotFoundException ignored) {</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            return JSON.class.getClassLoader().loadClass(className);</b>
<b class="nc">&nbsp;        } catch (ClassNotFoundException ignored) {</b>
&nbsp;        }
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            return Class.forName(className);</b>
<b class="nc">&nbsp;        } catch (ClassNotFoundException ignored) {</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Class&lt;?&gt; getArrayClass(Class componentClass) {
<b class="nc">&nbsp;        if (componentClass == int.class) {</b>
<b class="nc">&nbsp;            return int[].class;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (componentClass == byte.class) {</b>
<b class="nc">&nbsp;            return byte[].class;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (componentClass == short.class) {</b>
<b class="nc">&nbsp;            return short[].class;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (componentClass == long.class) {</b>
<b class="nc">&nbsp;            return long[].class;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (componentClass == String.class) {</b>
<b class="nc">&nbsp;            return String[].class;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (componentClass == Object.class) {</b>
<b class="nc">&nbsp;            return Object[].class;</b>
&nbsp;        }
<b class="nc">&nbsp;        return Array.newInstance(componentClass, 1).getClass();</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Class&lt;?&gt; getClass(Type type) {
<b class="fc">&nbsp;        if (type == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        if (type.getClass() == Class.class) {</b>
<b class="fc">&nbsp;            return (Class&lt;?&gt;) type;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type instanceof ParameterizedType) {</b>
<b class="nc">&nbsp;            return getClass(((ParameterizedType) type).getRawType());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type instanceof TypeVariable) {</b>
<b class="nc">&nbsp;            Type boundType = ((TypeVariable&lt;?&gt;) type).getBounds()[0];</b>
<b class="nc">&nbsp;            if (boundType instanceof Class) {</b>
<b class="nc">&nbsp;                return (Class) boundType;</b>
&nbsp;            }
<b class="nc">&nbsp;            return getClass(boundType);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type instanceof WildcardType) {</b>
<b class="nc">&nbsp;            Type[] upperBounds = ((WildcardType) type).getUpperBounds();</b>
<b class="nc">&nbsp;            if (upperBounds.length == 1) {</b>
<b class="nc">&nbsp;                return getClass(upperBounds[0]);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (type instanceof GenericArrayType) {</b>
<b class="nc">&nbsp;            GenericArrayType genericArrayType = (GenericArrayType) type;</b>
<b class="nc">&nbsp;            Type componentType = genericArrayType.getGenericComponentType();</b>
<b class="nc">&nbsp;            Class&lt;?&gt; componentClass = getClass(componentType);</b>
<b class="nc">&nbsp;            return getArrayClass(componentClass);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return Object.class;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static boolean isProxy(Class&lt;?&gt; clazz) {
<b class="nc">&nbsp;        for (Class&lt;?&gt; item : clazz.getInterfaces()) {</b>
<b class="nc">&nbsp;            String interfaceName = item.getName();</b>
<b class="nc">&nbsp;            switch (interfaceName) {</b>
&nbsp;                case &quot;org.springframework.cglib.proxy.Factory&quot;:
&nbsp;                case &quot;javassist.util.proxy.ProxyObject&quot;:
&nbsp;                case &quot;org.apache.ibatis.javassist.util.proxy.ProxyObject&quot;:
&nbsp;                case &quot;org.hibernate.proxy.HibernateProxy&quot;:
&nbsp;                case &quot;org.springframework.context.annotation.ConfigurationClassEnhancer$EnhancedConfiguration&quot;:
&nbsp;                case &quot;org.mockito.cglib.proxy.Factory&quot;:
&nbsp;                case &quot;net.sf.cglib.proxy.Factory&quot;:
<b class="nc">&nbsp;                    return true;</b>
&nbsp;                default:
&nbsp;                    break;
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static Map getInnerMap(Map object) {
<b class="nc">&nbsp;        if (object == null || CLASS_JSON_OBJECT_1x == null || !CLASS_JSON_OBJECT_1x.isInstance(object) || FIELD_JSON_OBJECT_1x_map == null) {</b>
<b class="nc">&nbsp;            return object;</b>
&nbsp;        }
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            object = (Map) FIELD_JSON_OBJECT_1x_map.get(object);</b>
<b class="nc">&nbsp;        } catch (IllegalAccessException ignore) {</b>
&nbsp;            // ignore
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        return object;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-04-09 20:47</div>
</div>
</body>
</html>
