


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > ObjectReaderCreator</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.alibaba.fastjson2.reader</a>
</div>

<h1>Coverage Summary for Class: ObjectReaderCreator (com.alibaba.fastjson2.reader)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">ObjectReaderCreator</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/67)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1182)
  </span>
</td>
</tr>
  <tr>
    <td class="name">ObjectReaderCreator$LambdaSetterInfo</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/68)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1187)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.alibaba.fastjson2.reader;
&nbsp;
&nbsp;import com.alibaba.fastjson2.*;
&nbsp;import com.alibaba.fastjson2.annotation.JSONField;
&nbsp;import com.alibaba.fastjson2.codec.BeanInfo;
&nbsp;import com.alibaba.fastjson2.codec.FieldInfo;
&nbsp;import com.alibaba.fastjson2.function.*;
&nbsp;import com.alibaba.fastjson2.internal.asm.ASMUtils;
&nbsp;import com.alibaba.fastjson2.modules.ObjectReaderAnnotationProcessor;
&nbsp;import com.alibaba.fastjson2.modules.ObjectReaderModule;
&nbsp;import com.alibaba.fastjson2.schema.JSONSchema;
&nbsp;import com.alibaba.fastjson2.support.LambdaMiscCodec;
&nbsp;import com.alibaba.fastjson2.util.BeanUtils;
&nbsp;import com.alibaba.fastjson2.util.Fnv;
&nbsp;import com.alibaba.fastjson2.util.JDKUtils;
&nbsp;import com.alibaba.fastjson2.util.TypeUtils;
&nbsp;
&nbsp;import java.lang.invoke.*;
&nbsp;import java.lang.reflect.*;
&nbsp;import java.math.BigDecimal;
&nbsp;import java.math.BigInteger;
&nbsp;import java.time.*;
&nbsp;import java.util.*;
&nbsp;import java.util.concurrent.atomic.*;
&nbsp;import java.util.function.*;
&nbsp;
&nbsp;import static com.alibaba.fastjson2.util.BeanUtils.SUPER;
&nbsp;import static com.alibaba.fastjson2.util.TypeUtils.*;
&nbsp;
<b class="nc">&nbsp;public class ObjectReaderCreator {</b>
<b class="nc">&nbsp;    public static final boolean JIT = !JDKUtils.ANDROID &amp;&amp; !JDKUtils.GRAAL;</b>
<b class="nc">&nbsp;    public static final ObjectReaderCreator INSTANCE = new ObjectReaderCreator();</b>
&nbsp;
<b class="nc">&nbsp;    protected final AtomicInteger jitErrorCount = new AtomicInteger();</b>
&nbsp;    protected volatile Throwable jitErrorLast;
&nbsp;
<b class="nc">&nbsp;    protected static final Map&lt;Class, LambdaSetterInfo&gt; methodTypeMapping = new HashMap&lt;&gt;();</b>
&nbsp;
&nbsp;    static class LambdaSetterInfo {
&nbsp;        final Class fieldClass;
&nbsp;        final MethodType sameMethodMethod;
&nbsp;        final MethodType methodType;
&nbsp;        final MethodType invokedType;
&nbsp;
<b class="nc">&nbsp;        LambdaSetterInfo(Class fieldClass, Class functionClass) {</b>
<b class="nc">&nbsp;            this.fieldClass = fieldClass;</b>
<b class="nc">&nbsp;            this.sameMethodMethod = MethodType.methodType(void.class, Object.class, fieldClass);</b>
<b class="nc">&nbsp;            this.methodType = MethodType.methodType(void.class, fieldClass);</b>
<b class="nc">&nbsp;            this.invokedType = MethodType.methodType(functionClass);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static {
<b class="nc">&nbsp;        methodTypeMapping.put(boolean.class, new LambdaSetterInfo(boolean.class, ObjBoolConsumer.class));</b>
<b class="nc">&nbsp;        methodTypeMapping.put(byte.class, new LambdaSetterInfo(byte.class, ObjByteConsumer.class));</b>
<b class="nc">&nbsp;        methodTypeMapping.put(short.class, new LambdaSetterInfo(short.class, ObjShortConsumer.class));</b>
<b class="nc">&nbsp;        methodTypeMapping.put(int.class, new LambdaSetterInfo(int.class, ObjIntConsumer.class));</b>
<b class="nc">&nbsp;        methodTypeMapping.put(long.class, new LambdaSetterInfo(long.class, ObjLongConsumer.class));</b>
<b class="nc">&nbsp;        methodTypeMapping.put(char.class, new LambdaSetterInfo(char.class, ObjCharConsumer.class));</b>
<b class="nc">&nbsp;        methodTypeMapping.put(float.class, new LambdaSetterInfo(float.class, ObjFloatConsumer.class));</b>
<b class="nc">&nbsp;        methodTypeMapping.put(double.class, new LambdaSetterInfo(double.class, ObjDoubleConsumer.class));</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderNoneDefaultConstructor(Constructor constructor, String... paramNames) {
<b class="nc">&nbsp;        Function&lt;Map&lt;Long, Object&gt;, T&gt; function = createFunction(constructor, paramNames);</b>
<b class="nc">&nbsp;        Class declaringClass = constructor.getDeclaringClass();</b>
<b class="nc">&nbsp;        FieldReader[] fieldReaders = createFieldReaders(</b>
<b class="nc">&nbsp;                JSONFactory.getDefaultObjectReaderProvider(),</b>
&nbsp;                declaringClass,
&nbsp;                declaringClass,
&nbsp;                constructor,
<b class="nc">&nbsp;                constructor.getParameters(),</b>
&nbsp;                paramNames
&nbsp;        );
<b class="nc">&nbsp;        return createObjectReaderNoneDefaultConstructor(declaringClass, function, fieldReaders);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderNoneDefaultConstructor(
&nbsp;            Class objectClass,
&nbsp;            Function&lt;Map&lt;Long, Object&gt;, T&gt; creator,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        return new ObjectReaderNoneDefaultConstructor(</b>
&nbsp;                objectClass,
&nbsp;                null,
&nbsp;                null,
&nbsp;                0,
&nbsp;                creator,
&nbsp;                null,
&nbsp;                null,
&nbsp;                fieldReaders,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderFactoryMethod(Method factoryMethod, String... paramNames) {
<b class="nc">&nbsp;        Function&lt;Map&lt;Long, Object&gt;, Object&gt; factoryFunction = createFactoryFunction(factoryMethod, paramNames);</b>
<b class="nc">&nbsp;        FieldReader[] fieldReaders = createFieldReaders(</b>
<b class="nc">&nbsp;                JSONFactory.getDefaultObjectReaderProvider(),</b>
&nbsp;                null,
&nbsp;                null,
&nbsp;                factoryMethod,
<b class="nc">&nbsp;                factoryMethod.getParameters(),</b>
&nbsp;                paramNames
&nbsp;        );
<b class="nc">&nbsp;        return new ObjectReaderNoneDefaultConstructor(</b>
&nbsp;                null,
&nbsp;                null,
&nbsp;                null,
&nbsp;                0,
&nbsp;                factoryFunction,
&nbsp;                null,
&nbsp;                paramNames,
&nbsp;                fieldReaders,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public FieldReader[] createFieldReaders(
&nbsp;            ObjectReaderProvider provider,
&nbsp;            Class objectClass,
&nbsp;            Type objectType,
&nbsp;            Executable owner,
&nbsp;            Parameter[] parameters,
&nbsp;            String... paramNames
&nbsp;    ) {
<b class="nc">&nbsp;        Class&lt;?&gt; declaringClass = null;</b>
<b class="nc">&nbsp;        if (owner != null) {</b>
<b class="nc">&nbsp;            declaringClass = owner.getDeclaringClass();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        FieldReader[] fieldReaders = new FieldReader[parameters.length];</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; parameters.length; i++) {</b>
<b class="nc">&nbsp;            FieldInfo fieldInfo = new FieldInfo();</b>
&nbsp;
<b class="nc">&nbsp;            Parameter parameter = parameters[i];</b>
&nbsp;            String paramName;
<b class="nc">&nbsp;            if (i &lt; paramNames.length) {</b>
<b class="nc">&nbsp;                paramName = paramNames[i];</b>
&nbsp;            } else {
<b class="nc">&nbsp;                paramName = parameter.getName();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (owner instanceof Constructor) {</b>
<b class="nc">&nbsp;                provider.getFieldInfo(fieldInfo, declaringClass, (Constructor) owner, i, parameter);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (owner instanceof Constructor) {</b>
<b class="nc">&nbsp;                Field field = BeanUtils.getDeclaredField(declaringClass, paramName);</b>
<b class="nc">&nbsp;                if (field != null) {</b>
<b class="nc">&nbsp;                    provider.getFieldInfo(fieldInfo, declaringClass, field);</b>
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            String fieldName;
<b class="nc">&nbsp;            if (fieldInfo.fieldName == null || fieldInfo.fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;                fieldName = paramName;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                fieldName = fieldInfo.fieldName;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldName == null) {</b>
<b class="nc">&nbsp;                fieldName = &quot;arg&quot; + i;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (paramName == null) {</b>
<b class="nc">&nbsp;                paramName = &quot;arg&quot; + i;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            ObjectReader initReader = getInitReader(provider, parameter.getParameterizedType(), parameter.getType(), fieldInfo);</b>
<b class="nc">&nbsp;            Type paramType = parameter.getParameterizedType();</b>
<b class="nc">&nbsp;            fieldReaders[i] = createFieldReaderParam(</b>
&nbsp;                    null,
&nbsp;                    null,
&nbsp;                    fieldName,
&nbsp;                    i,
&nbsp;                    fieldInfo.features,
&nbsp;                    fieldInfo.format,
&nbsp;                    paramType,
<b class="nc">&nbsp;                    parameter.getType(),</b>
&nbsp;                    paramName,
&nbsp;                    declaringClass,
&nbsp;                    parameter,
&nbsp;                    null,
&nbsp;                    initReader
&nbsp;            );
&nbsp;        }
<b class="nc">&nbsp;        return fieldReaders;</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; Function&lt;Map&lt;Long, Object&gt;, T&gt; createFactoryFunction(Method factoryMethod, String... paramNames) {
<b class="nc">&nbsp;        factoryMethod.setAccessible(true);</b>
<b class="nc">&nbsp;        return new FactoryFunction(factoryMethod, paramNames);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; Function&lt;Map&lt;Long, Object&gt;, T&gt; createFunction(Constructor constructor, String... paramNames) {
<b class="nc">&nbsp;        constructor.setAccessible(true);</b>
<b class="nc">&nbsp;        return new ConstructorFunction(</b>
&nbsp;                null,
&nbsp;                constructor,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null,
&nbsp;                paramNames
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; Function&lt;Map&lt;Long, Object&gt;, T&gt; createFunction(
&nbsp;            Constructor constructor,
&nbsp;            Constructor markerConstructor,
&nbsp;            String... paramNames
&nbsp;    ) {
<b class="nc">&nbsp;        if (markerConstructor == null) {</b>
<b class="nc">&nbsp;            constructor.setAccessible(true);</b>
&nbsp;        } else {
<b class="nc">&nbsp;            markerConstructor.setAccessible(true);</b>
&nbsp;        }
<b class="nc">&nbsp;        return new ConstructorFunction(</b>
&nbsp;                null,
&nbsp;                constructor,
&nbsp;                null,
&nbsp;                null,
&nbsp;                markerConstructor,
&nbsp;                paramNames
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReader(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        return createObjectReader(</b>
&nbsp;                objectClass,
&nbsp;                null,
&nbsp;                0,
&nbsp;                null,
<b class="nc">&nbsp;                createSupplier(objectClass),</b>
&nbsp;                null,
&nbsp;                fieldReaders
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReader(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Supplier&lt;T&gt; defaultCreator,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        return createObjectReader(objectClass, null, 0, null, defaultCreator, null, fieldReaders);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderSeeAlso(
&nbsp;            Class&lt;T&gt; objectType,
&nbsp;            Class[] seeAlso,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        Supplier&lt;T&gt; instanceSupplier = createSupplier(objectType);</b>
<b class="nc">&nbsp;        return new ObjectReaderSeeAlso(</b>
&nbsp;                objectType,
&nbsp;                instanceSupplier,
&nbsp;                &quot;@type&quot;,
&nbsp;                seeAlso,
&nbsp;                null,
&nbsp;                null,
&nbsp;                fieldReaders
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderSeeAlso(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            String typeKey,
&nbsp;            Class[] seeAlso,
&nbsp;            String[] seeAlsoNames,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        Supplier&lt;T&gt; creator = createSupplier(objectClass);</b>
<b class="nc">&nbsp;        return new ObjectReaderSeeAlso(</b>
&nbsp;                objectClass,
&nbsp;                creator,
&nbsp;                typeKey,
&nbsp;                seeAlso,
&nbsp;                seeAlsoNames,
&nbsp;                null,
&nbsp;                fieldReaders
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @since 2.0.24
&nbsp;     */
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderSeeAlso(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            String typeKey,
&nbsp;            Class[] seeAlso,
&nbsp;            String[] seeAlsoNames,
&nbsp;            Class seeAlsoDefault,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        Supplier&lt;T&gt; creator = createSupplier(objectClass);</b>
<b class="nc">&nbsp;        return new ObjectReaderSeeAlso(</b>
&nbsp;                objectClass,
&nbsp;                creator,
&nbsp;                typeKey,
&nbsp;                seeAlso,
&nbsp;                seeAlsoNames,
&nbsp;                seeAlsoDefault,
&nbsp;                fieldReaders
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderSeeAlso(
&nbsp;            Class&lt;T&gt; objectType,
&nbsp;            Supplier&lt;T&gt; defaultCreator,
&nbsp;            String typeKey,
&nbsp;            Class[] seeAlso,
&nbsp;            String[] seeAlsoNames,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        return new ObjectReaderSeeAlso(</b>
&nbsp;                objectType,
&nbsp;                defaultCreator,
&nbsp;                typeKey,
&nbsp;                seeAlso,
&nbsp;                seeAlsoNames,
&nbsp;                null,
&nbsp;                fieldReaders
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderWithBuilder(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Type objectType,
&nbsp;            ObjectReaderProvider provider,
&nbsp;            BeanInfo beanInfo
&nbsp;    ) {
<b class="nc">&nbsp;        Function&lt;Object, Object&gt; builderFunction = null;</b>
<b class="nc">&nbsp;        if (beanInfo.buildMethod != null) {</b>
<b class="nc">&nbsp;            builderFunction = createBuildFunction(beanInfo.buildMethod);</b>
&nbsp;        }
<b class="nc">&nbsp;        Class builderClass = beanInfo.builder;</b>
&nbsp;
<b class="nc">&nbsp;        String builderWithPrefix = beanInfo.builderWithPrefix;</b>
<b class="nc">&nbsp;        if (builderWithPrefix == null || builderWithPrefix.isEmpty()) {</b>
<b class="nc">&nbsp;            builderWithPrefix = &quot;with&quot;;</b>
&nbsp;        }
<b class="nc">&nbsp;        int builderWithPrefixLenth = builderWithPrefix.length();</b>
&nbsp;
<b class="nc">&nbsp;        Map&lt;String, FieldReader&gt; fieldReaders = new LinkedHashMap&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        final String prefix = builderWithPrefix;</b>
<b class="nc">&nbsp;        final FieldInfo fieldInfo = new FieldInfo();</b>
<b class="nc">&nbsp;        BeanUtils.setters(builderClass, false, method -&gt; {</b>
<b class="nc">&nbsp;            fieldInfo.init();</b>
<b class="nc">&nbsp;            provider.getFieldInfo(fieldInfo, objectClass, method);</b>
&nbsp;
<b class="nc">&nbsp;            if (fieldInfo.ignore) {</b>
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            String methodName = method.getName();</b>
&nbsp;            String fieldName;
<b class="nc">&nbsp;            if (fieldInfo.fieldName == null || fieldInfo.fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;                final int methodNameLength = methodName.length();</b>
<b class="nc">&nbsp;                boolean prefixNotMach = methodNameLength &lt;= prefix.length() || !methodName.startsWith(prefix);</b>
<b class="nc">&nbsp;                if (prefixNotMach) {</b>
<b class="nc">&nbsp;                    if ((method.getDeclaringClass() != Object.class &amp;&amp; method.getReturnType() == builderClass)</b>
<b class="nc">&nbsp;                            &amp;&amp; (method.getAnnotation(JSONField.class) != null</b>
&nbsp;                            || (beanInfo.readerFeatures &amp; JSONReader.Feature.SupportSmartMatch.mask) != 0)
&nbsp;                    ) {
<b class="nc">&nbsp;                        fieldName = methodName;</b>
&nbsp;                    } else {
&nbsp;                        return;
&nbsp;                    }
&nbsp;                } else {
<b class="nc">&nbsp;                    fieldName = BeanUtils.setterName(methodName, builderWithPrefixLenth);</b>
&nbsp;                }
<b class="nc">&nbsp;            } else {</b>
<b class="nc">&nbsp;                fieldName = fieldInfo.fieldName;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (method.getParameterCount() == 0) {</b>
<b class="nc">&nbsp;                FieldReader fieldReader = createFieldReaderMethod(</b>
&nbsp;                        builderClass,
&nbsp;                        builderClass,
&nbsp;                        fieldName,
&nbsp;                        fieldInfo.ordinal,
&nbsp;                        fieldInfo.features,
&nbsp;                        fieldInfo.format,
&nbsp;                        fieldInfo.locale,
&nbsp;                        fieldInfo.defaultValue,
&nbsp;                        fieldInfo.schema,
<b class="nc">&nbsp;                        method.getGenericReturnType(),</b>
<b class="nc">&nbsp;                        method.getReturnType(),</b>
&nbsp;                        method,
&nbsp;                        null
&nbsp;                );
<b class="nc">&nbsp;                FieldReader origin = fieldReaders.putIfAbsent(fieldName,</b>
&nbsp;                        fieldReader
&nbsp;                );
<b class="nc">&nbsp;                if (origin != null &amp;&amp; origin.compareTo(fieldReader) &gt; 0) {</b>
<b class="nc">&nbsp;                    fieldReaders.put(fieldName, fieldReader);</b>
&nbsp;                }
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            Type fieldType = method.getGenericParameterTypes()[0];</b>
<b class="nc">&nbsp;            Class fieldClass = method.getParameterTypes()[0];</b>
&nbsp;
<b class="nc">&nbsp;            method.setAccessible(true);</b>
&nbsp;
<b class="nc">&nbsp;            FieldReader fieldReader = createFieldReaderMethod(</b>
&nbsp;                    builderClass,
&nbsp;                    objectType,
&nbsp;                    fieldName,
&nbsp;                    fieldInfo.ordinal,
&nbsp;                    fieldInfo.features,
&nbsp;                    fieldInfo.format,
&nbsp;                    fieldInfo.locale,
&nbsp;                    fieldInfo.defaultValue,
&nbsp;                    fieldInfo.schema,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    method,
&nbsp;                    null);
&nbsp;
<b class="nc">&nbsp;            FieldReader origin = fieldReaders.putIfAbsent(fieldName, fieldReader);</b>
<b class="nc">&nbsp;            if (origin != null &amp;&amp; origin.compareTo(fieldReader) &gt; 0) {</b>
<b class="nc">&nbsp;                fieldReaders.put(fieldName, fieldReader);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldInfo.alternateNames != null) {</b>
<b class="nc">&nbsp;                for (String alternateName : fieldInfo.alternateNames) {</b>
<b class="nc">&nbsp;                    if (fieldName.equals(alternateName)) {</b>
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    fieldReaders</b>
<b class="nc">&nbsp;                            .putIfAbsent(alternateName,</b>
<b class="nc">&nbsp;                                    createFieldReaderMethod(</b>
&nbsp;                                            builderClass,
&nbsp;                                            objectType,
&nbsp;                                            alternateName,
&nbsp;                                            fieldInfo.ordinal,
&nbsp;                                            fieldInfo.features,
&nbsp;                                            fieldInfo.format,
&nbsp;                                            fieldInfo.locale,
&nbsp;                                            fieldInfo.defaultValue,
&nbsp;                                            fieldInfo.schema,
&nbsp;                                            fieldType,
&nbsp;                                            fieldClass,
&nbsp;                                            method,
&nbsp;                                            null));
&nbsp;                }
&nbsp;            }
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        FieldReader[] fieldReaderArray = new FieldReader[fieldReaders.size()];</b>
<b class="nc">&nbsp;        fieldReaders.values().toArray(fieldReaderArray);</b>
<b class="nc">&nbsp;        Arrays.sort(fieldReaderArray);</b>
&nbsp;
<b class="nc">&nbsp;        Supplier instanceSupplier = createSupplier(builderClass);</b>
<b class="nc">&nbsp;        return createObjectReader(builderClass, 0, instanceSupplier, builderFunction, fieldReaderArray);</b>
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;T&gt; ObjectReader&lt;T&gt; createObjectReaderWithCreator(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Type objectType,
&nbsp;            ObjectReaderProvider provider,
&nbsp;            BeanInfo beanInfo
&nbsp;    ) {
<b class="nc">&nbsp;        FieldInfo fieldInfo = new FieldInfo();</b>
&nbsp;
<b class="nc">&nbsp;        Map&lt;String, FieldReader&gt; fieldReaders = new LinkedHashMap&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        Class declaringClass = null;</b>
&nbsp;        Parameter[] parameters;
&nbsp;        String[] paramNames;
<b class="nc">&nbsp;        if (beanInfo.creatorConstructor != null) {</b>
<b class="nc">&nbsp;            parameters = beanInfo.creatorConstructor.getParameters();</b>
<b class="nc">&nbsp;            declaringClass = beanInfo.creatorConstructor.getDeclaringClass();</b>
<b class="nc">&nbsp;            paramNames = ASMUtils.lookupParameterNames(beanInfo.creatorConstructor);</b>
&nbsp;        } else {
<b class="nc">&nbsp;            parameters = beanInfo.createMethod.getParameters();</b>
<b class="nc">&nbsp;            declaringClass = beanInfo.createMethod.getDeclaringClass();</b>
<b class="nc">&nbsp;            paramNames = ASMUtils.lookupParameterNames(beanInfo.createMethod);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; i &lt; parameters.length; i++) {</b>
<b class="nc">&nbsp;            fieldInfo.init();</b>
&nbsp;
<b class="nc">&nbsp;            Parameter parameter = parameters[i];</b>
&nbsp;
<b class="nc">&nbsp;            if (beanInfo.creatorConstructor != null) {</b>
<b class="nc">&nbsp;                provider.getFieldInfo(fieldInfo, objectClass, beanInfo.creatorConstructor, i, parameter);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                provider.getFieldInfo(fieldInfo, objectClass, beanInfo.createMethod, i, parameter);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (parameters.length == 1 &amp;&amp; (fieldInfo.features &amp; FieldInfo.VALUE_MASK) != 0) {</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            String fieldName = fieldInfo.fieldName;</b>
<b class="nc">&nbsp;            if (fieldName == null || fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;                if (beanInfo.createParameterNames != null &amp;&amp; i &lt; beanInfo.createParameterNames.length) {</b>
<b class="nc">&nbsp;                    fieldName = beanInfo.createParameterNames[i];</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (fieldName == null || fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;                    fieldName = parameter.getName();</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (fieldName == null || fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;                fieldName = paramNames[i];</b>
<b class="nc">&nbsp;            } else if (fieldName.startsWith(&quot;arg&quot;)) {</b>
<b class="nc">&nbsp;                if (paramNames != null &amp;&amp; paramNames.length &gt; i) {</b>
<b class="nc">&nbsp;                    fieldName = paramNames[i];</b>
&nbsp;                }
&nbsp;            } else {
<b class="nc">&nbsp;                paramNames[i] = fieldName;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            String finalFieldName = fieldName;</b>
<b class="nc">&nbsp;            Class&lt;?&gt; paramClass = parameter.getType();</b>
<b class="nc">&nbsp;            BeanUtils.getters(objectClass, method -&gt; {</b>
<b class="nc">&nbsp;                if (method.getReturnType() != paramClass) {</b>
&nbsp;                    return;
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                FieldInfo methodFieldInfo = new FieldInfo();</b>
<b class="nc">&nbsp;                provider.getFieldInfo(methodFieldInfo, objectClass, method);</b>
<b class="nc">&nbsp;                String methodFieldName = methodFieldInfo.fieldName;</b>
<b class="nc">&nbsp;                if (methodFieldName == null) {</b>
<b class="nc">&nbsp;                    methodFieldName = BeanUtils.getterName(method, PropertyNamingStrategy.CamelCase.name());</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (methodFieldInfo.readUsing != null &amp;&amp; finalFieldName.equals(methodFieldName)</b>
&nbsp;                ) {
<b class="nc">&nbsp;                    fieldInfo.readUsing = methodFieldInfo.readUsing;</b>
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            if (fieldName == null || fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;                fieldName = &quot;arg&quot; + i;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            Type paramType = parameter.getParameterizedType();</b>
<b class="nc">&nbsp;            ObjectReader initReader = getInitReader(provider, paramType, paramClass, fieldInfo);</b>
<b class="nc">&nbsp;            FieldReader fieldReaderParam = createFieldReaderParam(</b>
&nbsp;                    objectClass,
&nbsp;                    objectType,
&nbsp;                    fieldName,
&nbsp;                    i,
&nbsp;                    fieldInfo.features,
&nbsp;                    fieldInfo.format,
&nbsp;                    paramType,
&nbsp;                    paramClass,
&nbsp;                    fieldName,
&nbsp;                    declaringClass,
&nbsp;                    parameter,
&nbsp;                    null,
&nbsp;                    initReader
&nbsp;            );
<b class="nc">&nbsp;            fieldReaders.put(fieldName, fieldReaderParam);</b>
&nbsp;
<b class="nc">&nbsp;            if (fieldInfo.alternateNames != null) {</b>
<b class="nc">&nbsp;                for (String alternateName : fieldInfo.alternateNames) {</b>
<b class="nc">&nbsp;                    if (fieldName.equals(alternateName)) {</b>
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    fieldReaders.putIfAbsent(alternateName,</b>
<b class="nc">&nbsp;                            createFieldReaderParam(</b>
&nbsp;                                    objectClass,
&nbsp;                                    objectType,
&nbsp;                                    alternateName,
&nbsp;                                    i,
&nbsp;                                    fieldInfo.features,
&nbsp;                                    fieldInfo.format,
&nbsp;                                    paramType,
&nbsp;                                    paramClass,
&nbsp;                                    fieldName,
&nbsp;                                    declaringClass,
&nbsp;                                    parameter,
&nbsp;                                    null
&nbsp;                            ));
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (parameters.length == 1 &amp;&amp; (fieldInfo.features &amp; FieldInfo.VALUE_MASK) != 0) {</b>
<b class="nc">&nbsp;            Type valueType = beanInfo.creatorConstructor == null</b>
<b class="nc">&nbsp;                    ? beanInfo.createMethod.getGenericParameterTypes()[0]</b>
<b class="nc">&nbsp;                    : beanInfo.creatorConstructor.getGenericParameterTypes()[0];</b>
<b class="nc">&nbsp;            Class valueClass = beanInfo.creatorConstructor == null</b>
<b class="nc">&nbsp;                    ? beanInfo.createMethod.getParameterTypes()[0]</b>
<b class="nc">&nbsp;                    : beanInfo.creatorConstructor.getParameterTypes()[0];</b>
&nbsp;
<b class="nc">&nbsp;            JSONSchema jsonSchema = null;</b>
<b class="nc">&nbsp;            if (fieldInfo.schema != null &amp;&amp; !fieldInfo.schema.isEmpty()) {</b>
<b class="nc">&nbsp;                JSONObject object = JSON.parseObject(fieldInfo.schema);</b>
<b class="nc">&nbsp;                if (!object.isEmpty()) {</b>
<b class="nc">&nbsp;                    jsonSchema = JSONSchema.of(object, valueClass);</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            Object defaultValue = fieldInfo.defaultValue;</b>
<b class="nc">&nbsp;            if (defaultValue != null &amp;&amp; defaultValue.getClass() != valueClass) {</b>
&nbsp;                Function typeConvert = JSONFactory
<b class="nc">&nbsp;                        .getDefaultObjectReaderProvider()</b>
<b class="nc">&nbsp;                        .getTypeConvert(defaultValue.getClass(), valueType);</b>
<b class="nc">&nbsp;                if (typeConvert != null) {</b>
<b class="nc">&nbsp;                    defaultValue = typeConvert.apply(defaultValue);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    throw new JSONException(&quot;illegal defaultValue : &quot; + defaultValue + &quot;, class &quot; + valueClass.getName());</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            boolean jit = JIT || (fieldInfo.features &amp; FieldInfo.JIT) != 0 || (beanInfo.readerFeatures &amp; FieldInfo.JIT) != 0;</b>
<b class="nc">&nbsp;            Function function = null;</b>
<b class="nc">&nbsp;            if (defaultValue == null &amp;&amp; jit) {</b>
<b class="nc">&nbsp;                if (valueClass == int.class) {</b>
<b class="nc">&nbsp;                    IntFunction intFunction = null;</b>
<b class="nc">&nbsp;                    if (beanInfo.creatorConstructor != null) {</b>
<b class="nc">&nbsp;                        intFunction = createIntFunction(beanInfo.creatorConstructor);</b>
<b class="nc">&nbsp;                    } else if (beanInfo.createMethod != null) {</b>
<b class="nc">&nbsp;                        intFunction = createIntFunction(beanInfo.createMethod);</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    if (intFunction != null) {</b>
<b class="nc">&nbsp;                        return ObjectReaderImplValueInt.of(objectClass, fieldInfo.features, jsonSchema, intFunction);</b>
&nbsp;                    }
<b class="nc">&nbsp;                } else if (valueClass == String.class) {</b>
<b class="nc">&nbsp;                    if (beanInfo.creatorConstructor != null) {</b>
<b class="nc">&nbsp;                        function = createStringFunction(beanInfo.creatorConstructor);</b>
<b class="nc">&nbsp;                    } else if (beanInfo.createMethod != null) {</b>
<b class="nc">&nbsp;                        function = createStringFunction(beanInfo.createMethod);</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    if (function != null) {</b>
<b class="nc">&nbsp;                        return ObjectReaderImplValueString.of(objectClass, fieldInfo.features, jsonSchema, function);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (jit &amp;&amp; !valueClass.isPrimitive()) {</b>
<b class="nc">&nbsp;                if (beanInfo.creatorConstructor != null) {</b>
<b class="nc">&nbsp;                    function = createValueFunction(beanInfo.creatorConstructor, valueClass);</b>
<b class="nc">&nbsp;                } else if (beanInfo.createMethod != null) {</b>
<b class="nc">&nbsp;                    function = createValueFunction(beanInfo.createMethod, valueClass);</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return new ObjectReaderImplValue(</b>
&nbsp;                    objectClass,
&nbsp;                    valueType,
&nbsp;                    valueClass,
&nbsp;                    fieldInfo.features,
&nbsp;                    fieldInfo.format,
&nbsp;                    defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    beanInfo.creatorConstructor,
&nbsp;                    beanInfo.createMethod,
&nbsp;                    function
&nbsp;            );
&nbsp;        }
&nbsp;
&nbsp;        Function&lt;Map&lt;Long, Object&gt;, Object&gt; function;
<b class="nc">&nbsp;        if (beanInfo.creatorConstructor != null) {</b>
<b class="nc">&nbsp;            function = createFunction(beanInfo.creatorConstructor, beanInfo.markerConstructor, paramNames);</b>
&nbsp;        } else {
<b class="nc">&nbsp;            function = createFactoryFunction(beanInfo.createMethod, paramNames);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        FieldReader[] fieldReaderArray = new FieldReader[fieldReaders.size()];</b>
<b class="nc">&nbsp;        fieldReaders.values().toArray(fieldReaderArray);</b>
<b class="nc">&nbsp;        Arrays.sort(fieldReaderArray);</b>
&nbsp;
<b class="nc">&nbsp;        FieldReader[] setterFieldReaders = createFieldReaders(objectClass, objectType);</b>
<b class="nc">&nbsp;        Arrays.sort(setterFieldReaders);</b>
&nbsp;
<b class="nc">&nbsp;        boolean[] flags = null;</b>
<b class="nc">&nbsp;        int maskCount = 0;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; setterFieldReaders.length; i++) {</b>
<b class="nc">&nbsp;            FieldReader setterFieldReader = setterFieldReaders[i];</b>
<b class="nc">&nbsp;            if (fieldReaders.containsKey(setterFieldReader.fieldName)) {</b>
<b class="nc">&nbsp;                if (flags == null) {</b>
<b class="nc">&nbsp;                    flags = new boolean[setterFieldReaders.length];</b>
&nbsp;                }
<b class="nc">&nbsp;                flags[i] = true;</b>
<b class="nc">&nbsp;                maskCount++;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (maskCount &gt; 0) {</b>
<b class="nc">&nbsp;            FieldReader[] array = new FieldReader[setterFieldReaders.length - maskCount];</b>
<b class="nc">&nbsp;            int index = 0;</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; setterFieldReaders.length; i++) {</b>
<b class="nc">&nbsp;                if (!flags[i]) {</b>
<b class="nc">&nbsp;                    array[index++] = setterFieldReaders[i];</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            setterFieldReaders = array;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return (ObjectReader&lt;T&gt;) new ObjectReaderNoneDefaultConstructor(</b>
&nbsp;                objectClass,
&nbsp;                beanInfo.typeKey,
&nbsp;                beanInfo.typeName,
&nbsp;                beanInfo.readerFeatures,
&nbsp;                function,
&nbsp;                null,
&nbsp;                paramNames,
&nbsp;                fieldReaderArray,
&nbsp;                setterFieldReaders,
&nbsp;                beanInfo.seeAlso,
&nbsp;                beanInfo.seeAlsoNames
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReader(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            long features,
&nbsp;            Supplier&lt;T&gt; defaultCreator,
&nbsp;            Function buildFunction,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        return createObjectReader(objectClass, null, features, null, defaultCreator, buildFunction, fieldReaders);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReader(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            String typeKey,
&nbsp;            long features,
&nbsp;            JSONSchema schema,
&nbsp;            Supplier&lt;T&gt; defaultCreator,
&nbsp;            Function buildFunction,
&nbsp;            FieldReader... fieldReaders
&nbsp;    ) {
<b class="nc">&nbsp;        if (objectClass != null) {</b>
<b class="nc">&nbsp;            int modifiers = objectClass.getModifiers();</b>
<b class="nc">&nbsp;            if (Modifier.isAbstract(modifiers) || Modifier.isInterface(modifiers)) {</b>
<b class="nc">&nbsp;                return new ObjectReaderAdapter(objectClass, typeKey, null, features, schema, defaultCreator, buildFunction, fieldReaders);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        switch (fieldReaders.length) {</b>
&nbsp;            case 1:
<b class="nc">&nbsp;                return new ObjectReader1(</b>
&nbsp;                        objectClass,
&nbsp;                        features,
&nbsp;                        schema,
&nbsp;                        defaultCreator,
&nbsp;                        buildFunction,
&nbsp;                        fieldReaders[0]
&nbsp;                );
&nbsp;            case 2:
<b class="nc">&nbsp;                return new ObjectReader2(</b>
&nbsp;                        objectClass,
&nbsp;                        features,
&nbsp;                        schema,
&nbsp;                        defaultCreator,
&nbsp;                        buildFunction,
&nbsp;                        fieldReaders[0],
&nbsp;                        fieldReaders[1]);
&nbsp;            case 3:
<b class="nc">&nbsp;                return new ObjectReader3(</b>
&nbsp;                        objectClass,
&nbsp;                        defaultCreator,
&nbsp;                        features,
&nbsp;                        schema,
&nbsp;                        buildFunction,
&nbsp;                        fieldReaders[0],
&nbsp;                        fieldReaders[1],
&nbsp;                        fieldReaders[2]
&nbsp;                );
&nbsp;            case 4:
<b class="nc">&nbsp;                return new ObjectReader4(</b>
&nbsp;                        objectClass,
&nbsp;                        features,
&nbsp;                        schema,
&nbsp;                        defaultCreator,
&nbsp;                        buildFunction,
&nbsp;                        fieldReaders[0],
&nbsp;                        fieldReaders[1],
&nbsp;                        fieldReaders[2],
&nbsp;                        fieldReaders[3]
&nbsp;                );
&nbsp;            case 5:
<b class="nc">&nbsp;                return new ObjectReader5(</b>
&nbsp;                        objectClass,
&nbsp;                        defaultCreator,
&nbsp;                        features,
&nbsp;                        schema,
&nbsp;                        buildFunction,
&nbsp;                        fieldReaders[0],
&nbsp;                        fieldReaders[1],
&nbsp;                        fieldReaders[2],
&nbsp;                        fieldReaders[3],
&nbsp;                        fieldReaders[4]
&nbsp;                );
&nbsp;            case 6:
<b class="nc">&nbsp;                return new ObjectReader6(</b>
&nbsp;                        objectClass,
&nbsp;                        defaultCreator,
&nbsp;                        features,
&nbsp;                        schema,
&nbsp;                        buildFunction,
&nbsp;                        fieldReaders[0],
&nbsp;                        fieldReaders[1],
&nbsp;                        fieldReaders[2],
&nbsp;                        fieldReaders[3],
&nbsp;                        fieldReaders[4],
&nbsp;                        fieldReaders[5]
&nbsp;                );
&nbsp;            default:
<b class="nc">&nbsp;                return new ObjectReaderAdapter(objectClass, typeKey, null, features, schema, defaultCreator, buildFunction, fieldReaders);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReader(Type objectType) {
<b class="nc">&nbsp;        if (objectType instanceof Class) {</b>
<b class="nc">&nbsp;            return createObjectReader((Class&lt;T&gt;) objectType);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Class&lt;T&gt; objectClass = (Class&lt;T&gt;) TypeUtils.getMapping(objectType);</b>
<b class="nc">&nbsp;        FieldReader[] fieldReaderArray = createFieldReaders(objectClass, objectType);</b>
<b class="nc">&nbsp;        return createObjectReader(</b>
&nbsp;                objectClass,
<b class="nc">&nbsp;                createSupplier(objectClass),</b>
&nbsp;                fieldReaderArray);
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReader(Class&lt;T&gt; objectType) {
<b class="nc">&nbsp;        return createObjectReader(</b>
&nbsp;                objectType,
&nbsp;                objectType,
&nbsp;                false,
<b class="nc">&nbsp;                JSONFactory.getDefaultObjectReaderProvider()</b>
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReader(Class&lt;T&gt; objectType, boolean fieldBased) {
<b class="nc">&nbsp;        return createObjectReader(</b>
&nbsp;                objectType,
&nbsp;                objectType,
&nbsp;                fieldBased,
<b class="nc">&nbsp;                JSONFactory.getDefaultObjectReaderProvider()</b>
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; ObjectReader&lt;T&gt; createObjectReader(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Type objectType,
&nbsp;            boolean fieldBased,
&nbsp;            ObjectReaderProvider provider
&nbsp;    ) {
<b class="nc">&nbsp;        BeanInfo beanInfo = new BeanInfo();</b>
<b class="nc">&nbsp;        if (fieldBased) {</b>
<b class="nc">&nbsp;            beanInfo.readerFeatures |= JSONReader.Feature.FieldBased.mask;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        for (ObjectReaderModule module : provider.modules) {</b>
<b class="nc">&nbsp;            ObjectReaderAnnotationProcessor annotationProcessor = module.getAnnotationProcessor();</b>
<b class="nc">&nbsp;            if (annotationProcessor != null) {</b>
<b class="nc">&nbsp;                annotationProcessor.getBeanInfo(beanInfo, objectClass);</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        if (beanInfo.deserializer != null &amp;&amp; ObjectReader.class.isAssignableFrom(beanInfo.deserializer)) {</b>
&nbsp;            try {
<b class="nc">&nbsp;                Constructor constructor = beanInfo.deserializer.getDeclaredConstructor();</b>
<b class="nc">&nbsp;                constructor.setAccessible(true);</b>
<b class="nc">&nbsp;                return (ObjectReader&lt;T&gt;) constructor.newInstance();</b>
<b class="nc">&nbsp;            } catch (InstantiationException | IllegalAccessException | NoSuchMethodException |</b>
&nbsp;                     InvocationTargetException e) {
<b class="nc">&nbsp;                throw new JSONException(&quot;create deserializer error&quot;, e);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldBased) {</b>
<b class="nc">&nbsp;            beanInfo.readerFeatures |= JSONReader.Feature.FieldBased.mask;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (Enum.class.isAssignableFrom(objectClass) &amp;&amp; (beanInfo.createMethod == null || beanInfo.createMethod.getParameterCount() == 1)) {</b>
<b class="nc">&nbsp;            return createEnumReader(objectClass, beanInfo.createMethod, provider);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (Throwable.class.isAssignableFrom(objectClass)) {</b>
<b class="nc">&nbsp;            fieldBased = false;</b>
<b class="nc">&nbsp;            beanInfo.readerFeatures |= JSONReader.Feature.IgnoreSetNullValue.mask;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldBased &amp;&amp; objectClass.isInterface()) {</b>
<b class="nc">&nbsp;            fieldBased = false;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        FieldReader[] fieldReaderArray = createFieldReaders(objectClass, objectType, beanInfo, fieldBased, provider);</b>
<b class="nc">&nbsp;        boolean allReadOnlyOrZero = true;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; fieldReaderArray.length; i++) {</b>
<b class="nc">&nbsp;            FieldReader fieldReader = fieldReaderArray[i];</b>
<b class="nc">&nbsp;            if (!fieldReader.isReadOnly()) {</b>
<b class="nc">&nbsp;                allReadOnlyOrZero = false;</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (beanInfo.creatorConstructor != null || beanInfo.createMethod != null) {</b>
<b class="nc">&nbsp;            return createObjectReaderWithCreator(objectClass, objectType, provider, beanInfo);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (beanInfo.builder != null) {</b>
<b class="nc">&nbsp;            return createObjectReaderWithBuilder(objectClass, objectType, provider, beanInfo);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Constructor creatorConstructor = null;</b>
&nbsp;
<b class="nc">&nbsp;        final List&lt;Constructor&gt; alternateConstructors = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;        BeanUtils.constructor(objectClass, alternateConstructors::add);</b>
&nbsp;
<b class="nc">&nbsp;        if (Throwable.class.isAssignableFrom(objectClass)) {</b>
<b class="nc">&nbsp;            return new ObjectReaderException&lt;&gt;(objectClass, alternateConstructors, fieldReaderArray);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Constructor defaultConstructor = null;</b>
&nbsp;
<b class="nc">&nbsp;        Class&lt;?&gt; declaringClass = objectClass.getDeclaringClass();</b>
&nbsp;
<b class="nc">&nbsp;        int index = -1;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; alternateConstructors.size(); i++) {</b>
<b class="nc">&nbsp;            Constructor constructor = alternateConstructors.get(i);</b>
&nbsp;
<b class="nc">&nbsp;            if (constructor.getParameterCount() == 0) {</b>
<b class="nc">&nbsp;                defaultConstructor = constructor;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (declaringClass != null</b>
<b class="nc">&nbsp;                    &amp;&amp; constructor.getParameterCount() == 1</b>
<b class="nc">&nbsp;                    &amp;&amp; declaringClass.equals(constructor.getParameterTypes()[0])) {</b>
<b class="nc">&nbsp;                creatorConstructor = constructor;</b>
<b class="nc">&nbsp;                index = i;</b>
<b class="nc">&nbsp;                break;</b>
<b class="nc">&nbsp;            } else if (creatorConstructor == null) {</b>
<b class="nc">&nbsp;                creatorConstructor = constructor;</b>
<b class="nc">&nbsp;                index = i;</b>
<b class="nc">&nbsp;            } else if (constructor.getParameterCount() == 0) {</b>
<b class="nc">&nbsp;                creatorConstructor = constructor;</b>
<b class="nc">&nbsp;                index = i;</b>
<b class="nc">&nbsp;            } else if (creatorConstructor.getParameterCount() &lt; constructor.getParameterCount()) {</b>
<b class="nc">&nbsp;                creatorConstructor = constructor;</b>
<b class="nc">&nbsp;                index = i;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (index != -1) {</b>
<b class="nc">&nbsp;            alternateConstructors.remove(index);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (creatorConstructor != null &amp;&amp; creatorConstructor.getParameterCount() != 0 &amp;&amp; beanInfo.seeAlso == null) {</b>
<b class="nc">&nbsp;            boolean record = BeanUtils.isRecord(objectClass);</b>
&nbsp;
<b class="nc">&nbsp;            creatorConstructor.setAccessible(true);</b>
<b class="nc">&nbsp;            String[] parameterNames = beanInfo.createParameterNames;</b>
<b class="nc">&nbsp;            if (record &amp;&amp; parameterNames == null) {</b>
<b class="nc">&nbsp;                parameterNames = BeanUtils.getRecordFieldNames(objectClass);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (parameterNames == null || parameterNames.length == 0) {</b>
<b class="nc">&nbsp;                parameterNames = ASMUtils.lookupParameterNames(creatorConstructor);</b>
&nbsp;
<b class="nc">&nbsp;                Parameter[] parameters = creatorConstructor.getParameters();</b>
<b class="nc">&nbsp;                FieldInfo fieldInfo = new FieldInfo();</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; parameters.length &amp;&amp; i &lt; parameterNames.length; i++) {</b>
<b class="nc">&nbsp;                    fieldInfo.init();</b>
&nbsp;
<b class="nc">&nbsp;                    Parameter parameter = parameters[i];</b>
&nbsp;
<b class="nc">&nbsp;                    provider.getFieldInfo(fieldInfo, objectClass, creatorConstructor, i, parameter);</b>
<b class="nc">&nbsp;                    if (fieldInfo.fieldName != null) {</b>
<b class="nc">&nbsp;                        parameterNames[i] = fieldInfo.fieldName;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            int matchCount = 0;</b>
<b class="nc">&nbsp;            if (defaultConstructor != null) {</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; parameterNames.length; i++) {</b>
<b class="nc">&nbsp;                    String parameterName = parameterNames[i];</b>
<b class="nc">&nbsp;                    if (parameterName == null) {</b>
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    for (int j = 0; j &lt; fieldReaderArray.length; j++) {</b>
<b class="nc">&nbsp;                        FieldReader fieldReader = fieldReaderArray[j];</b>
<b class="nc">&nbsp;                        if (fieldReader != null) {</b>
<b class="nc">&nbsp;                            if (parameterName.equals(fieldReader.fieldName)) {</b>
<b class="nc">&nbsp;                                matchCount++;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (!(fieldBased)</b>
<b class="nc">&nbsp;                    &amp;&amp; !(Throwable.class.isAssignableFrom(objectClass))</b>
&nbsp;                    &amp;&amp; defaultConstructor == null
&nbsp;                    &amp;&amp; matchCount != parameterNames.length) {
<b class="nc">&nbsp;                if (creatorConstructor.getParameterCount() == 1) {</b>
<b class="nc">&nbsp;                    FieldInfo fieldInfo = new FieldInfo();</b>
<b class="nc">&nbsp;                    provider.getFieldInfo(fieldInfo, objectClass, creatorConstructor, 0, creatorConstructor.getParameters()[0]);</b>
<b class="nc">&nbsp;                    if ((fieldInfo.features &amp; FieldInfo.VALUE_MASK) != 0) {</b>
<b class="nc">&nbsp;                        Type valueType = creatorConstructor.getGenericParameterTypes()[0];</b>
<b class="nc">&nbsp;                        Class valueClass = creatorConstructor.getParameterTypes()[0];</b>
&nbsp;
<b class="nc">&nbsp;                        JSONSchema jsonSchema = null;</b>
<b class="nc">&nbsp;                        if (fieldInfo.schema != null &amp;&amp; !fieldInfo.schema.isEmpty()) {</b>
<b class="nc">&nbsp;                            JSONObject object = JSON.parseObject(fieldInfo.schema);</b>
<b class="nc">&nbsp;                            if (!object.isEmpty()) {</b>
<b class="nc">&nbsp;                                jsonSchema = JSONSchema.of(object, valueClass);</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        Object defaultValue = fieldInfo.defaultValue;</b>
<b class="nc">&nbsp;                        if (defaultValue != null &amp;&amp; defaultValue.getClass() != valueClass) {</b>
&nbsp;                            Function typeConvert = JSONFactory
<b class="nc">&nbsp;                                    .getDefaultObjectReaderProvider()</b>
<b class="nc">&nbsp;                                    .getTypeConvert(defaultValue.getClass(), valueType);</b>
<b class="nc">&nbsp;                            if (typeConvert != null) {</b>
<b class="nc">&nbsp;                                defaultValue = typeConvert.apply(defaultValue);</b>
&nbsp;                            } else {
<b class="nc">&nbsp;                                throw new JSONException(&quot;illegal defaultValue : &quot; + defaultValue + &quot;, class &quot; + valueClass.getName());</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        return new ObjectReaderImplValue(</b>
&nbsp;                                objectClass,
&nbsp;                                valueType,
&nbsp;                                valueClass,
&nbsp;                                fieldInfo.features,
&nbsp;                                fieldInfo.format,
&nbsp;                                defaultValue,
&nbsp;                                jsonSchema,
&nbsp;                                creatorConstructor,
&nbsp;                                null,
&nbsp;                                null
&nbsp;                        );
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (allReadOnlyOrZero &amp;&amp; fieldReaderArray.length != 0 &amp;&amp; alternateConstructors.isEmpty()) {</b>
<b class="nc">&nbsp;                    for (int i = 0; i &lt; parameterNames.length; i++) {</b>
<b class="nc">&nbsp;                        String paramName = parameterNames[i];</b>
<b class="nc">&nbsp;                        for (FieldReader fieldReader : fieldReaderArray) {</b>
<b class="nc">&nbsp;                            if (fieldReader.field != null</b>
<b class="nc">&nbsp;                                    &amp;&amp; fieldReader.field.getName().equals(paramName)</b>
<b class="nc">&nbsp;                                    &amp;&amp; !fieldReader.fieldName.equals(paramName)</b>
&nbsp;                            ) {
<b class="nc">&nbsp;                                parameterNames[i] = fieldReader.fieldName;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                Function function = null;</b>
<b class="nc">&nbsp;                BiFunction biFunction = null;</b>
<b class="nc">&nbsp;                if (JIT) {</b>
<b class="nc">&nbsp;                    if (creatorConstructor.getParameterCount() == 1) {</b>
<b class="nc">&nbsp;                        function = LambdaMiscCodec.createFunction(creatorConstructor);</b>
<b class="nc">&nbsp;                    } else if (creatorConstructor.getParameterCount() == 2) {</b>
<b class="nc">&nbsp;                        biFunction = LambdaMiscCodec.createBiFunction(creatorConstructor);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                Function&lt;Map&lt;Long, Object&gt;, T&gt; constructorFunction = new ConstructorFunction(</b>
&nbsp;                        alternateConstructors,
&nbsp;                        creatorConstructor,
&nbsp;                        function,
&nbsp;                        biFunction,
&nbsp;                        null,
&nbsp;                        parameterNames
&nbsp;                );
&nbsp;
<b class="nc">&nbsp;                FieldReader[] paramFieldReaders = createFieldReaders(</b>
&nbsp;                        provider,
&nbsp;                        objectClass,
&nbsp;                        objectType,
&nbsp;                        creatorConstructor,
<b class="nc">&nbsp;                        creatorConstructor.getParameters(),</b>
&nbsp;                        parameterNames
&nbsp;                );
<b class="nc">&nbsp;                return new ObjectReaderNoneDefaultConstructor(</b>
&nbsp;                        objectClass,
&nbsp;                        beanInfo.typeKey,
&nbsp;                        beanInfo.typeName,
&nbsp;                        beanInfo.readerFeatures,
&nbsp;                        constructorFunction,
&nbsp;                        alternateConstructors,
&nbsp;                        parameterNames,
&nbsp;                        paramFieldReaders,
&nbsp;                        fieldReaderArray,
&nbsp;                        null,
&nbsp;                        null
&nbsp;                );
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (beanInfo.seeAlso != null &amp;&amp; beanInfo.seeAlso.length != 0) {</b>
<b class="nc">&nbsp;            return createObjectReaderSeeAlso(</b>
&nbsp;                    objectClass,
&nbsp;                    beanInfo.typeKey,
&nbsp;                    beanInfo.seeAlso,
&nbsp;                    beanInfo.seeAlsoNames,
&nbsp;                    beanInfo.seeAlsoDefault,
&nbsp;                    fieldReaderArray
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (objectClass.isInterface()) {</b>
<b class="nc">&nbsp;            return new ObjectReaderInterface(</b>
&nbsp;                    objectClass,
&nbsp;                    null,
&nbsp;                    null,
&nbsp;                    0L,
&nbsp;                    null,
&nbsp;                    null,
&nbsp;                    fieldReaderArray
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Supplier&lt;T&gt; creator = createSupplier(objectClass);</b>
<b class="nc">&nbsp;        JSONSchema jsonSchema = JSONSchema.of(JSON.parseObject(beanInfo.schema), objectClass);</b>
<b class="nc">&nbsp;        ObjectReader&lt;T&gt; objectReader = createObjectReader(</b>
&nbsp;                objectClass,
&nbsp;                beanInfo.typeKey,
&nbsp;                beanInfo.readerFeatures,
&nbsp;                jsonSchema,
&nbsp;                creator,
&nbsp;                null,
&nbsp;                fieldReaderArray);
&nbsp;
<b class="nc">&nbsp;        if (objectReader instanceof ObjectReaderBean) {</b>
<b class="nc">&nbsp;            JSONReader.AutoTypeBeforeHandler beforeHandler = null;</b>
<b class="nc">&nbsp;            if (beanInfo.autoTypeBeforeHandler != null) {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    Constructor constructor = beanInfo.autoTypeBeforeHandler.getDeclaredConstructor();</b>
<b class="nc">&nbsp;                    constructor.setAccessible(true);</b>
<b class="nc">&nbsp;                    beforeHandler = (JSONReader.AutoTypeBeforeHandler) constructor.newInstance();</b>
<b class="nc">&nbsp;                } catch (Exception ignored) {</b>
&nbsp;                    // ignored
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (beforeHandler != null) {</b>
<b class="nc">&nbsp;                ((ObjectReaderBean&lt;T&gt;) objectReader).setAutoTypeBeforeHandler(beforeHandler);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return objectReader;</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader[] createFieldReaders(Class&lt;T&gt; objectClass) {
<b class="nc">&nbsp;        return createFieldReaders(</b>
&nbsp;                objectClass,
&nbsp;                objectClass,
&nbsp;                null,
&nbsp;                false,
<b class="nc">&nbsp;                JSONFactory.getDefaultObjectReaderProvider()</b>
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader[] createFieldReaders(Class&lt;T&gt; objectClass, Type objectType) {
<b class="nc">&nbsp;        return createFieldReaders(</b>
&nbsp;                objectClass,
&nbsp;                objectType,
&nbsp;                null,
&nbsp;                false,
<b class="nc">&nbsp;                JSONFactory.getDefaultObjectReaderProvider()</b>
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    protected void createFieldReader(
&nbsp;            Class objectClass,
&nbsp;            Type objectType,
&nbsp;            String namingStrategy,
&nbsp;            FieldInfo fieldInfo,
&nbsp;            Field field,
&nbsp;            Map&lt;String, FieldReader&gt; fieldReaders,
&nbsp;            ObjectReaderProvider provider
&nbsp;    ) {
<b class="nc">&nbsp;        provider.getFieldInfo(fieldInfo, objectClass, field);</b>
&nbsp;
<b class="nc">&nbsp;        if (fieldInfo.ignore) {</b>
<b class="nc">&nbsp;            boolean unwrap = (fieldInfo.features &amp; FieldInfo.UNWRAPPED_MASK) != 0</b>
<b class="nc">&nbsp;                    &amp;&amp; Map.class.isAssignableFrom(field.getType());</b>
<b class="nc">&nbsp;            if (!unwrap) {</b>
&nbsp;                return;
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        String fieldName;
<b class="nc">&nbsp;        if (fieldInfo.fieldName == null || fieldInfo.fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;            fieldName = field.getName();</b>
<b class="nc">&nbsp;            if (namingStrategy != null) {</b>
<b class="nc">&nbsp;                fieldName = BeanUtils.fieldName(fieldName, namingStrategy);</b>
&nbsp;            }
&nbsp;        } else {
<b class="nc">&nbsp;            fieldName = fieldInfo.fieldName;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Type fieldType = field.getGenericType();</b>
<b class="nc">&nbsp;        Class&lt;?&gt; fieldClass = field.getType();</b>
&nbsp;
<b class="nc">&nbsp;        ObjectReader initReader = getInitReader(provider, fieldType, fieldClass, fieldInfo);</b>
<b class="nc">&nbsp;        String schema = fieldInfo.schema;</b>
<b class="nc">&nbsp;        if (fieldInfo.required) {</b>
<b class="nc">&nbsp;            if (schema == null) {</b>
<b class="nc">&nbsp;                schema = &quot;{\&quot;required\&quot;:true}&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        FieldReader&lt;Object&gt; fieldReader = createFieldReader(</b>
&nbsp;                objectClass,
&nbsp;                objectType,
&nbsp;                fieldName,
&nbsp;                fieldInfo.ordinal,
&nbsp;                fieldInfo.features,
&nbsp;                fieldInfo.format,
&nbsp;                fieldInfo.locale,
&nbsp;                fieldInfo.defaultValue,
&nbsp;                schema,
&nbsp;                fieldType,
&nbsp;                fieldClass,
&nbsp;                field,
&nbsp;                initReader
&nbsp;        );
&nbsp;
<b class="nc">&nbsp;        FieldReader previous = fieldReaders.putIfAbsent(fieldName, fieldReader);</b>
<b class="nc">&nbsp;        if (previous != null) {</b>
<b class="nc">&nbsp;            int cmp = fieldReader.compareTo(previous);</b>
<b class="nc">&nbsp;            if (cmp &gt; 0) {</b>
<b class="nc">&nbsp;                fieldReaders.put(fieldName, fieldReader);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldInfo.alternateNames != null) {</b>
<b class="nc">&nbsp;            for (String alternateName : fieldInfo.alternateNames) {</b>
<b class="nc">&nbsp;                if (fieldName.equals(alternateName)) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                FieldReader&lt;Object&gt; fieldReader1 = createFieldReader(</b>
&nbsp;                        objectClass,
&nbsp;                        objectType,
&nbsp;                        alternateName,
&nbsp;                        fieldInfo.ordinal,
&nbsp;                        fieldInfo.features,
&nbsp;                        null,
&nbsp;                        fieldInfo.locale,
&nbsp;                        fieldInfo.defaultValue,
&nbsp;                        schema,
&nbsp;                        fieldType,
&nbsp;                        fieldClass,
&nbsp;                        field,
&nbsp;                        null
&nbsp;                );
<b class="nc">&nbsp;                fieldReaders.putIfAbsent(alternateName, fieldReader1);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    protected void createFieldReader(
&nbsp;            Class objectClass,
&nbsp;            Type objectType,
&nbsp;            String namingStrategy,
&nbsp;            String[] orders,
&nbsp;            BeanInfo beanInfo,
&nbsp;            FieldInfo fieldInfo,
&nbsp;            Method method,
&nbsp;            Map&lt;String, FieldReader&gt; fieldReaders,
&nbsp;            ObjectReaderProvider provider
&nbsp;    ) {
<b class="nc">&nbsp;        provider.getFieldInfo(fieldInfo, objectClass, method);</b>
&nbsp;
<b class="nc">&nbsp;        if (fieldInfo.ignore) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
&nbsp;        String fieldName;
<b class="nc">&nbsp;        if (fieldInfo.fieldName == null || fieldInfo.fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;            String methodName = method.getName();</b>
<b class="nc">&nbsp;            if (methodName.startsWith(&quot;set&quot;)) {</b>
<b class="nc">&nbsp;                fieldName = BeanUtils.setterName(methodName, namingStrategy);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                fieldName = BeanUtils.getterName(method, namingStrategy);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            char c0 = &#39;\0&#39;, c1;</b>
<b class="nc">&nbsp;            int len = fieldName.length();</b>
<b class="nc">&nbsp;            if (len &gt; 0) {</b>
<b class="nc">&nbsp;                c0 = fieldName.charAt(0);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if ((len == 1 &amp;&amp; c0 &gt;= &#39;a&#39; &amp;&amp; c0 &lt;= &#39;z&#39;)</b>
<b class="nc">&nbsp;                    || (len &gt; 2 &amp;&amp; c0 &gt;= &#39;A&#39; &amp;&amp; c0 &lt;= &#39;Z&#39; &amp;&amp; (c1 = fieldName.charAt(1)) &gt;= &#39;A&#39; &amp;&amp; c1 &lt;= &#39;Z&#39;)</b>
&nbsp;            ) {
<b class="nc">&nbsp;                char[] chars = fieldName.toCharArray();</b>
<b class="nc">&nbsp;                if (len == 1) {</b>
<b class="nc">&nbsp;                    chars[0] = (char) (chars[0] - 32);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    chars[0] = (char) (chars[0] + 32);</b>
&nbsp;                }
<b class="nc">&nbsp;                String fieldName1 = new String(chars);</b>
<b class="nc">&nbsp;                Field field = BeanUtils.getDeclaredField(objectClass, fieldName1);</b>
<b class="nc">&nbsp;                if (field != null) {</b>
<b class="nc">&nbsp;                    if (Modifier.isPublic(field.getModifiers())) {</b>
<b class="nc">&nbsp;                        fieldName = field.getName();</b>
<b class="nc">&nbsp;                    } else if (len == 1) {</b>
<b class="nc">&nbsp;                        fieldInfo.alternateNames = new String[]{fieldName};</b>
<b class="nc">&nbsp;                        fieldName = field.getName();</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;        } else {</b>
<b class="nc">&nbsp;            fieldName = fieldInfo.fieldName;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (orders != null &amp;&amp; orders.length &gt; 0) {</b>
<b class="nc">&nbsp;            boolean match = false;</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; orders.length; i++) {</b>
<b class="nc">&nbsp;                if (fieldName.equals(orders[i])) {</b>
<b class="nc">&nbsp;                    fieldInfo.ordinal = i;</b>
<b class="nc">&nbsp;                    match = true;</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (!match) {</b>
<b class="nc">&nbsp;                if (fieldInfo.ordinal == 0) {</b>
<b class="nc">&nbsp;                    fieldInfo.ordinal = orders.length;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        int parameterCount = method.getParameterCount();</b>
<b class="nc">&nbsp;        if (parameterCount == 0) {</b>
<b class="nc">&nbsp;            FieldReader fieldReader = createFieldReaderMethod(</b>
&nbsp;                    objectClass,
&nbsp;                    objectType,
&nbsp;                    fieldName,
&nbsp;                    fieldInfo.ordinal,
&nbsp;                    fieldInfo.features,
&nbsp;                    fieldInfo.format,
&nbsp;                    fieldInfo.locale,
&nbsp;                    fieldInfo.defaultValue,
&nbsp;                    fieldInfo.schema,
<b class="nc">&nbsp;                    method.getGenericReturnType(),</b>
<b class="nc">&nbsp;                    method.getReturnType(),</b>
&nbsp;                    method,
<b class="nc">&nbsp;                    fieldInfo.getInitReader()</b>
&nbsp;            );
<b class="nc">&nbsp;            FieldReader origin = fieldReaders.putIfAbsent(fieldName,</b>
&nbsp;                    fieldReader
&nbsp;            );
<b class="nc">&nbsp;            if (origin != null &amp;&amp; origin.compareTo(fieldReader) &gt; 0) {</b>
<b class="nc">&nbsp;                fieldReaders.put(fieldName, fieldReader);</b>
&nbsp;            }
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (parameterCount == 2) {</b>
<b class="nc">&nbsp;            Class&lt;?&gt; fieldClass = method.getParameterTypes()[1];</b>
<b class="nc">&nbsp;            Type fieldType = method.getGenericParameterTypes()[1];</b>
<b class="nc">&nbsp;            method.setAccessible(true);</b>
<b class="nc">&nbsp;            FieldReaderAnySetter anySetter = new FieldReaderAnySetter(fieldType, fieldClass, fieldInfo.ordinal, fieldInfo.features, fieldInfo.format, null, method);</b>
<b class="nc">&nbsp;            fieldReaders.put(anySetter.fieldName, anySetter);</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Type fieldType = method.getGenericParameterTypes()[0];</b>
<b class="nc">&nbsp;        Class fieldClass = method.getParameterTypes()[0];</b>
&nbsp;
&nbsp;        // skip function
<b class="nc">&nbsp;        if (isFunction(fieldClass)) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        ObjectReader initReader = getInitReader(provider, fieldType, fieldClass, fieldInfo);</b>
<b class="nc">&nbsp;        FieldReader fieldReader = null;</b>
<b class="nc">&nbsp;        boolean jit = (fieldInfo.features &amp; FieldInfo.JIT) != 0;</b>
<b class="nc">&nbsp;        if (jit) {</b>
&nbsp;            try {
<b class="nc">&nbsp;                fieldReader = createFieldReaderLambda(</b>
&nbsp;                        objectClass,
&nbsp;                        objectType,
&nbsp;                        fieldName,
&nbsp;                        fieldInfo.ordinal,
&nbsp;                        fieldInfo.features,
&nbsp;                        fieldInfo.format,
&nbsp;                        fieldInfo.locale,
&nbsp;                        fieldInfo.defaultValue,
&nbsp;                        fieldInfo.schema,
&nbsp;                        fieldType,
&nbsp;                        fieldClass,
&nbsp;                        method,
&nbsp;                        initReader
&nbsp;                );
<b class="nc">&nbsp;            } catch (Throwable ignored) {</b>
<b class="nc">&nbsp;                jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;                jitErrorLast = ignored;</b>
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldReader == null) {</b>
<b class="nc">&nbsp;            fieldReader = createFieldReaderMethod(</b>
&nbsp;                    objectClass,
&nbsp;                    objectType,
&nbsp;                    fieldName,
&nbsp;                    fieldInfo.ordinal,
&nbsp;                    fieldInfo.features,
&nbsp;                    fieldInfo.format,
&nbsp;                    fieldInfo.locale,
&nbsp;                    fieldInfo.defaultValue,
&nbsp;                    fieldInfo.schema,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    method,
&nbsp;                    initReader
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        FieldReader origin = fieldReaders.putIfAbsent(fieldName, fieldReader);</b>
<b class="nc">&nbsp;        if (origin != null &amp;&amp; origin.compareTo(fieldReader) &gt; 0) {</b>
<b class="nc">&nbsp;            fieldReaders.put(fieldName, fieldReader);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldInfo.alternateNames != null) {</b>
<b class="nc">&nbsp;            for (String alternateName : fieldInfo.alternateNames) {</b>
<b class="nc">&nbsp;                if (fieldName.equals(alternateName)) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                fieldReaders</b>
<b class="nc">&nbsp;                        .putIfAbsent(alternateName,</b>
<b class="nc">&nbsp;                                createFieldReaderMethod(</b>
&nbsp;                                        objectClass,
&nbsp;                                        objectType,
&nbsp;                                        alternateName,
&nbsp;                                        fieldInfo.ordinal,
&nbsp;                                        fieldInfo.features,
&nbsp;                                        fieldInfo.format,
&nbsp;                                        fieldInfo.locale,
&nbsp;                                        fieldInfo.defaultValue,
&nbsp;                                        fieldInfo.schema,
&nbsp;                                        fieldType,
&nbsp;                                        fieldClass,
&nbsp;                                        method,
&nbsp;                                        initReader
&nbsp;                                ));
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;T&gt; FieldReader[] createFieldReaders(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Type objectType,
&nbsp;            BeanInfo beanInfo,
&nbsp;            boolean fieldBased,
&nbsp;            ObjectReaderProvider provider
&nbsp;    ) {
<b class="nc">&nbsp;        if (beanInfo == null) {</b>
<b class="nc">&nbsp;            beanInfo = new BeanInfo();</b>
<b class="nc">&nbsp;            for (ObjectReaderModule module : provider.modules) {</b>
<b class="nc">&nbsp;                ObjectReaderAnnotationProcessor annotationProcessor = module.getAnnotationProcessor();</b>
<b class="nc">&nbsp;                if (annotationProcessor != null) {</b>
<b class="nc">&nbsp;                    annotationProcessor.getBeanInfo(beanInfo, objectClass);</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        boolean recoard = BeanUtils.isRecord(objectClass);</b>
<b class="nc">&nbsp;        final String namingStrategy = beanInfo.namingStrategy;</b>
&nbsp;
<b class="nc">&nbsp;        Map&lt;String, FieldReader&gt; fieldReaders = new LinkedHashMap&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        BeanInfo finalBeanInfo = beanInfo;</b>
<b class="nc">&nbsp;        final long beanFeatures = beanInfo.readerFeatures;</b>
<b class="nc">&nbsp;        final String beanFormat = beanInfo.format;</b>
<b class="nc">&nbsp;        final FieldInfo fieldInfo = new FieldInfo();</b>
<b class="nc">&nbsp;        final String[] orders = beanInfo.orders;</b>
<b class="nc">&nbsp;        if (fieldBased) {</b>
<b class="nc">&nbsp;            BeanUtils.declaredFields(objectClass, field -&gt; {</b>
<b class="nc">&nbsp;                fieldInfo.init();</b>
<b class="nc">&nbsp;                fieldInfo.features |= JSONReader.Feature.FieldBased.mask;</b>
<b class="nc">&nbsp;                fieldInfo.features |= beanFeatures;</b>
<b class="nc">&nbsp;                fieldInfo.format = beanFormat;</b>
&nbsp;
<b class="nc">&nbsp;                createFieldReader(objectClass, objectType, namingStrategy, fieldInfo, field, fieldReaders, provider);</b>
&nbsp;            });
&nbsp;        } else {
<b class="nc">&nbsp;            if (!recoard) {</b>
<b class="nc">&nbsp;                BeanUtils.declaredFields(objectClass, field -&gt; {</b>
<b class="nc">&nbsp;                    fieldInfo.init();</b>
<b class="nc">&nbsp;                    fieldInfo.ignore = (field.getModifiers() &amp; Modifier.PUBLIC) == 0;</b>
<b class="nc">&nbsp;                    fieldInfo.features |= beanFeatures;</b>
<b class="nc">&nbsp;                    fieldInfo.format = beanFormat;</b>
&nbsp;
<b class="nc">&nbsp;                    createFieldReader(objectClass, objectType, namingStrategy, fieldInfo, field, fieldReaders, provider);</b>
<b class="nc">&nbsp;                    if (fieldInfo.required) {</b>
<b class="nc">&nbsp;                        String fieldName = fieldInfo.fieldName;</b>
<b class="nc">&nbsp;                        if (fieldName == null || fieldName.isEmpty()) {</b>
<b class="nc">&nbsp;                            fieldName = field.getName();</b>
&nbsp;                        }
<b class="nc">&nbsp;                        finalBeanInfo.required(fieldName);</b>
&nbsp;                    }
&nbsp;                });
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            Class mixIn = provider.getMixIn(objectClass);</b>
<b class="nc">&nbsp;            BeanUtils.setters(objectClass, mixIn, method -&gt; {</b>
<b class="nc">&nbsp;                fieldInfo.init();</b>
<b class="nc">&nbsp;                fieldInfo.features |= beanFeatures;</b>
<b class="nc">&nbsp;                fieldInfo.format = beanFormat;</b>
<b class="nc">&nbsp;                createFieldReader(objectClass, objectType, namingStrategy, orders, finalBeanInfo, fieldInfo, method, fieldReaders, provider);</b>
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            if (objectClass.isInterface()) {</b>
<b class="nc">&nbsp;                BeanUtils.getters(objectClass, method -&gt; {</b>
<b class="nc">&nbsp;                    fieldInfo.init();</b>
<b class="nc">&nbsp;                    fieldInfo.features |= beanFeatures;</b>
<b class="nc">&nbsp;                    createFieldReader(objectClass, objectType, namingStrategy, orders, finalBeanInfo, fieldInfo, method, fieldReaders, provider);</b>
&nbsp;                });
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Class&lt;? super T&gt; superclass = objectClass.getSuperclass();</b>
<b class="nc">&nbsp;        if (BeanUtils.isExtendedMap(objectClass)) {</b>
<b class="nc">&nbsp;            Type superType = objectClass.getGenericSuperclass();</b>
<b class="nc">&nbsp;            FieldReader fieldReader = ObjectReaders.fieldReader(</b>
&nbsp;                    SUPER,
&nbsp;                    superType,
&nbsp;                    superclass,
&nbsp;                    (o, f) -&gt; {
<b class="nc">&nbsp;                        Map thisMap = (Map) o;</b>
<b class="nc">&nbsp;                        Map superMap = (Map) f;</b>
&nbsp;                        // avoid putAll oom
<b class="nc">&nbsp;                        for (Object value : superMap.entrySet()) {</b>
<b class="nc">&nbsp;                            Map.Entry entry = (Map.Entry) value;</b>
<b class="nc">&nbsp;                            thisMap.put(entry.getKey(), entry.getValue());</b>
<b class="nc">&nbsp;                        }</b>
&nbsp;                    }
&nbsp;            );
<b class="nc">&nbsp;            fieldReaders.put(SUPER, fieldReader);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        FieldReader[] fieldReaderArray = new FieldReader[fieldReaders.size()];</b>
<b class="nc">&nbsp;        fieldReaders.values().toArray(fieldReaderArray);</b>
<b class="nc">&nbsp;        Arrays.sort(fieldReaderArray);</b>
<b class="nc">&nbsp;        return fieldReaderArray;</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; Supplier&lt;T&gt; createSupplier(Class&lt;T&gt; objectClass) {
<b class="nc">&nbsp;        if (objectClass.isInterface()) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        int modifiers = objectClass.getModifiers();</b>
<b class="nc">&nbsp;        if (Modifier.isAbstract(modifiers)) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
&nbsp;        final Constructor&lt;T&gt; constructor;
&nbsp;        try {
<b class="nc">&nbsp;            constructor = objectClass.getDeclaredConstructor();</b>
<b class="nc">&nbsp;            constructor.setAccessible(true);</b>
<b class="nc">&nbsp;        } catch (NoSuchMethodException ignored) {</b>
<b class="nc">&nbsp;            return null;</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            throw new JSONException(&quot;get constructor error, class &quot; + objectClass.getName(), e);</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        return createSupplier(constructor, true);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; Supplier&lt;T&gt; createSupplier(Constructor constructor, boolean jit) {
<b class="nc">&nbsp;        jit &amp;= JIT;</b>
&nbsp;
<b class="nc">&nbsp;        if (jit) {</b>
<b class="nc">&nbsp;            Class declaringClass = constructor.getDeclaringClass();</b>
<b class="nc">&nbsp;            MethodHandles.Lookup lookup = JDKUtils.trustedLookup(declaringClass);</b>
&nbsp;            try {
<b class="nc">&nbsp;                if (constructor.getParameterCount() == 0) {</b>
<b class="nc">&nbsp;                    MethodHandle handle = lookup.findConstructor(declaringClass, METHOD_TYPE_VOID);</b>
<b class="nc">&nbsp;                    CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                            lookup,
&nbsp;                            &quot;get&quot;,
&nbsp;                            METHOD_TYPE_SUPPLIER,
&nbsp;                            METHOD_TYPE_OBJECT,
&nbsp;                            handle,
&nbsp;                            METHOD_TYPE_OBJECT
&nbsp;                    );
<b class="nc">&nbsp;                    return (Supplier) callSite.getTarget().invokeExact();</b>
&nbsp;                }
<b class="nc">&nbsp;            } catch (Throwable e) {</b>
<b class="nc">&nbsp;                jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;                jitErrorLast = e;</b>
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return new ConstructorSupplier(constructor);</b>
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;T&gt; IntFunction&lt;T&gt; createIntFunction(Constructor constructor) {
<b class="nc">&nbsp;        Class declaringClass = constructor.getDeclaringClass();</b>
<b class="nc">&nbsp;        MethodHandles.Lookup lookup = JDKUtils.trustedLookup(declaringClass);</b>
&nbsp;        try {
<b class="nc">&nbsp;            MethodHandle handle = lookup.findConstructor(declaringClass, METHOD_TYPE_VOID_INT);</b>
<b class="nc">&nbsp;            MethodType instantiatedMethodType = MethodType.methodType(declaringClass, int.class);</b>
<b class="nc">&nbsp;            CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                    lookup,
&nbsp;                    &quot;apply&quot;,
&nbsp;                    METHOD_TYPE_INT_FUNCTION,
&nbsp;                    METHOD_TYPE_OBJECT_INT,
&nbsp;                    handle,
&nbsp;                    instantiatedMethodType
&nbsp;            );
<b class="nc">&nbsp;            return (IntFunction) callSite.getTarget().invokeExact();</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;            jitErrorLast = e;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;T&gt; IntFunction&lt;T&gt; createIntFunction(Method factoryMethod) {
<b class="nc">&nbsp;        Class declaringClass = factoryMethod.getDeclaringClass();</b>
<b class="nc">&nbsp;        MethodHandles.Lookup lookup = JDKUtils.trustedLookup(declaringClass);</b>
&nbsp;        try {
<b class="nc">&nbsp;            MethodType methodType = MethodType.methodType(factoryMethod.getReturnType(), int.class);</b>
<b class="nc">&nbsp;            MethodHandle handle = lookup.findStatic(declaringClass, factoryMethod.getName(), methodType);</b>
<b class="nc">&nbsp;            CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                    lookup,
&nbsp;                    &quot;apply&quot;,
&nbsp;                    METHOD_TYPE_INT_FUNCTION,
&nbsp;                    METHOD_TYPE_OBJECT_INT,
&nbsp;                    handle,
&nbsp;                    methodType
&nbsp;            );
<b class="nc">&nbsp;            return (IntFunction) callSite.getTarget().invokeExact();</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;            jitErrorLast = e;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;T&gt; Function&lt;String, T&gt; createStringFunction(Constructor constructor) {
<b class="nc">&nbsp;        Class declaringClass = constructor.getDeclaringClass();</b>
<b class="nc">&nbsp;        MethodHandles.Lookup lookup = JDKUtils.trustedLookup(declaringClass);</b>
&nbsp;        try {
<b class="nc">&nbsp;            MethodHandle handle = lookup.findConstructor(declaringClass, METHOD_TYPE_VOID_STRING);</b>
<b class="nc">&nbsp;            MethodType instantiatedMethodType = MethodType.methodType(declaringClass, String.class);</b>
<b class="nc">&nbsp;            CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                    lookup,
&nbsp;                    &quot;apply&quot;,
&nbsp;                    METHOD_TYPE_FUNCTION,
&nbsp;                    METHOD_TYPE_OBJECT_OBJECT,
&nbsp;                    handle,
&nbsp;                    instantiatedMethodType
&nbsp;            );
<b class="nc">&nbsp;            return (Function&lt;String, T&gt;) callSite.getTarget().invokeExact();</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;            jitErrorLast = e;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;T&gt; Function&lt;String, T&gt; createStringFunction(Method factoryMethod) {
<b class="nc">&nbsp;        Class declaringClass = factoryMethod.getDeclaringClass();</b>
<b class="nc">&nbsp;        MethodHandles.Lookup lookup = JDKUtils.trustedLookup(declaringClass);</b>
&nbsp;        try {
<b class="nc">&nbsp;            MethodType methodType = MethodType.methodType(factoryMethod.getReturnType(), String.class);</b>
<b class="nc">&nbsp;            MethodHandle handle = lookup.findStatic(declaringClass, factoryMethod.getName(), methodType);</b>
<b class="nc">&nbsp;            CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                    lookup,
&nbsp;                    &quot;apply&quot;,
&nbsp;                    METHOD_TYPE_FUNCTION,
&nbsp;                    METHOD_TYPE_OBJECT_OBJECT,
&nbsp;                    handle,
&nbsp;                    methodType
&nbsp;            );
<b class="nc">&nbsp;            return (Function&lt;String, T&gt;) callSite.getTarget().invokeExact();</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;            jitErrorLast = e;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;I, T&gt; Function&lt;I, T&gt; createValueFunction(Constructor&lt;T&gt; constructor, Class&lt;I&gt; valueClass) {
<b class="nc">&nbsp;        Class declaringClass = constructor.getDeclaringClass();</b>
<b class="nc">&nbsp;        MethodHandles.Lookup lookup = JDKUtils.trustedLookup(declaringClass);</b>
&nbsp;        try {
<b class="nc">&nbsp;            MethodType methodType = MethodType.methodType(void.class, valueClass);</b>
<b class="nc">&nbsp;            MethodHandle handle = lookup.findConstructor(declaringClass, methodType);</b>
<b class="nc">&nbsp;            MethodType instantiatedMethodType = MethodType.methodType(declaringClass, valueClass);</b>
<b class="nc">&nbsp;            CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                    lookup,
&nbsp;                    &quot;apply&quot;,
&nbsp;                    METHOD_TYPE_FUNCTION,
&nbsp;                    METHOD_TYPE_OBJECT_OBJECT,
&nbsp;                    handle,
&nbsp;                    instantiatedMethodType
&nbsp;            );
<b class="nc">&nbsp;            return (Function&lt;I, T&gt;) callSite.getTarget().invokeExact();</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;            jitErrorLast = e;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;I, T&gt; Function&lt;I, T&gt; createValueFunction(Method factoryMethod, Class valueClass) {
<b class="nc">&nbsp;        Class declaringClass = factoryMethod.getDeclaringClass();</b>
<b class="nc">&nbsp;        MethodHandles.Lookup lookup = JDKUtils.trustedLookup(declaringClass);</b>
&nbsp;        try {
<b class="nc">&nbsp;            MethodType methodType = MethodType.methodType(factoryMethod.getReturnType(), valueClass);</b>
<b class="nc">&nbsp;            MethodHandle handle = lookup.findStatic(declaringClass, factoryMethod.getName(), methodType);</b>
<b class="nc">&nbsp;            CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                    lookup,
&nbsp;                    &quot;apply&quot;,
&nbsp;                    METHOD_TYPE_FUNCTION,
&nbsp;                    METHOD_TYPE_OBJECT_OBJECT,
&nbsp;                    handle,
&nbsp;                    methodType
&nbsp;            );
<b class="nc">&nbsp;            return (Function&lt;I, T&gt;) callSite.getTarget().invokeExact();</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;            jitErrorLast = e;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T, R&gt; Function&lt;T, R&gt; createBuildFunction(Method builderMethod) {
&nbsp;        try {
<b class="nc">&nbsp;            return createBuildFunctionLambda(builderMethod);</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            jitErrorCount.incrementAndGet();</b>
<b class="nc">&nbsp;            jitErrorLast = e;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        builderMethod.setAccessible(true);</b>
&nbsp;
<b class="nc">&nbsp;        return (T o) -&gt; {</b>
&nbsp;            try {
<b class="nc">&nbsp;                return (R) builderMethod.invoke(o);</b>
<b class="nc">&nbsp;            } catch (Throwable e) {</b>
<b class="nc">&nbsp;                throw new JSONException(&quot;create instance error&quot;, e);</b>
&nbsp;            }
&nbsp;        };
&nbsp;    }
&nbsp;
&nbsp;    &lt;T, R&gt; Function&lt;T, R&gt; createBuildFunctionLambda(Method builderMethod) {
<b class="nc">&nbsp;        MethodHandles.Lookup lookup = JDKUtils.trustedLookup(builderMethod.getDeclaringClass());</b>
&nbsp;        try {
<b class="nc">&nbsp;            MethodHandle target = lookup.findVirtual(builderMethod.getDeclaringClass(),</b>
<b class="nc">&nbsp;                    builderMethod.getName(),</b>
<b class="nc">&nbsp;                    MethodType.methodType(builderMethod.getReturnType())</b>
&nbsp;            );
<b class="nc">&nbsp;            MethodType func = target.type();</b>
&nbsp;
<b class="nc">&nbsp;            CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                    lookup,
&nbsp;                    &quot;apply&quot;,
&nbsp;                    METHOD_TYPE_FUNCTION,
<b class="nc">&nbsp;                    func.erase(),</b>
&nbsp;                    target,
&nbsp;                    func
&nbsp;            );
&nbsp;
<b class="nc">&nbsp;            Object object = callSite</b>
<b class="nc">&nbsp;                    .getTarget()</b>
<b class="nc">&nbsp;                    .invoke();</b>
<b class="nc">&nbsp;            return (Function&lt;T, R&gt;) object;</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            throw new JSONException(&quot;create fieldReader error&quot;, e);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader createFieldReader(
&nbsp;            Class&lt;T&gt; objectType,
&nbsp;            String fieldName,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            Method method
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReaderMethod(</b>
&nbsp;                objectType,
&nbsp;                objectType,
&nbsp;                fieldName,
&nbsp;                0,
&nbsp;                0L,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null,
&nbsp;                fieldType,
&nbsp;                fieldClass,
&nbsp;                method,
&nbsp;                null
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader createFieldReader(
&nbsp;            Class&lt;T&gt; objectType,
&nbsp;            String fieldName,
&nbsp;            String format,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            Method method
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReaderMethod(objectType, fieldName, format, fieldType, fieldClass, method);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader createFieldReaderMethod(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            String fieldName,
&nbsp;            String format,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            Method method
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReaderMethod(</b>
&nbsp;                objectClass,
&nbsp;                objectClass,
&nbsp;                fieldName,
&nbsp;                0,
&nbsp;                0L,
&nbsp;                format,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null,
&nbsp;                fieldType,
&nbsp;                fieldClass,
&nbsp;                method,
&nbsp;                null
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader createFieldReaderParam(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Type objectType,
&nbsp;            String fieldName,
&nbsp;            int ordinal,
&nbsp;            long features,
&nbsp;            String format,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            String paramName,
&nbsp;            Class declaringClass,
&nbsp;            Parameter parameter,
&nbsp;            JSONSchema schema
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReaderParam(</b>
&nbsp;                objectClass,
&nbsp;                objectType,
&nbsp;                fieldName,
&nbsp;                ordinal,
&nbsp;                features,
&nbsp;                format,
&nbsp;                fieldType,
&nbsp;                fieldClass,
&nbsp;                paramName,
&nbsp;                declaringClass,
&nbsp;                parameter,
&nbsp;                schema,
&nbsp;                null
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader createFieldReaderParam(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Type objectType,
&nbsp;            String fieldName,
&nbsp;            int ordinal,
&nbsp;            long features,
&nbsp;            String format,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            String paramName,
&nbsp;            Class declaringClass,
&nbsp;            Parameter parameter,
&nbsp;            JSONSchema schema,
&nbsp;            ObjectReader initReader
&nbsp;    ) {
<b class="nc">&nbsp;        if (initReader != null) {</b>
<b class="nc">&nbsp;            FieldReaderObjectParam paramReader = new FieldReaderObjectParam(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    paramName,
&nbsp;                    parameter,
&nbsp;                    ordinal,
&nbsp;                    features,
&nbsp;                    format,
&nbsp;                    schema
&nbsp;            );
<b class="nc">&nbsp;            paramReader.initReader = initReader;</b>
<b class="nc">&nbsp;            return paramReader;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == byte.class || fieldType == Byte.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt8Param(fieldName, fieldClass, paramName, parameter, ordinal, features, format, schema);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == short.class || fieldType == Short.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt16Param(fieldName, fieldClass, paramName, parameter, ordinal, features, format, schema);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == int.class || fieldType == Integer.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt32Param(fieldName, fieldClass, paramName, parameter, ordinal, features, format, schema);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == long.class || fieldType == Long.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt64Param(fieldName, fieldClass, paramName, parameter, ordinal, features, format, schema);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Type fieldTypeResolved = null;</b>
<b class="nc">&nbsp;        Class fieldClassResolved = null;</b>
<b class="nc">&nbsp;        if (!(fieldType instanceof Class) &amp;&amp; objectType != null) {</b>
<b class="nc">&nbsp;            fieldTypeResolved = BeanUtils.getParamType(TypeReference.get(objectType), objectClass, declaringClass, parameter, fieldType);</b>
<b class="nc">&nbsp;            if (fieldTypeResolved != null) {</b>
<b class="nc">&nbsp;                fieldClassResolved = TypeUtils.getMapping(fieldTypeResolved);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (fieldTypeResolved == null) {</b>
<b class="nc">&nbsp;            fieldTypeResolved = fieldType;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (fieldClassResolved == null) {</b>
<b class="nc">&nbsp;            fieldClassResolved = fieldClass;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return new FieldReaderObjectParam(fieldName, fieldTypeResolved, fieldClassResolved, paramName, parameter, ordinal, features, format, schema);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader createFieldReaderMethod(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Type objectType,
&nbsp;            String fieldName,
&nbsp;            int ordinal,
&nbsp;            long features,
&nbsp;            String format,
&nbsp;            Locale locale,
&nbsp;            Object defaultValue,
&nbsp;            String schema,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            Method method,
&nbsp;            ObjectReader initReader
&nbsp;    ) {
<b class="nc">&nbsp;        if (method != null) {</b>
<b class="nc">&nbsp;            method.setAccessible(true);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (defaultValue != null &amp;&amp; defaultValue.getClass() != fieldClass) {</b>
&nbsp;            Function typeConvert = JSONFactory
<b class="nc">&nbsp;                    .getDefaultObjectReaderProvider()</b>
<b class="nc">&nbsp;                    .getTypeConvert(defaultValue.getClass(), fieldType);</b>
<b class="nc">&nbsp;            if (typeConvert != null) {</b>
<b class="nc">&nbsp;                defaultValue = typeConvert.apply(defaultValue);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                throw new JSONException(&quot;illegal defaultValue : &quot; + defaultValue + &quot;, class &quot; + fieldClass.getName());</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        JSONSchema jsonSchema = null;</b>
<b class="nc">&nbsp;        if (schema != null &amp;&amp; !schema.isEmpty()) {</b>
<b class="nc">&nbsp;            JSONObject object = JSON.parseObject(schema);</b>
<b class="nc">&nbsp;            if (!object.isEmpty()) {</b>
<b class="nc">&nbsp;                jsonSchema = JSONSchema.of(object, fieldClass);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (initReader != null) {</b>
<b class="nc">&nbsp;            FieldReaderObject fieldReaderObjectMethod = new FieldReaderObject(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    ordinal,
&nbsp;                    features | FieldInfo.READ_USING_MASK,
&nbsp;                    format,
&nbsp;                    locale,
&nbsp;                    defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    method,
&nbsp;                    null,
&nbsp;                    null
&nbsp;            );
<b class="nc">&nbsp;            fieldReaderObjectMethod.initReader = initReader;</b>
<b class="nc">&nbsp;            return fieldReaderObjectMethod;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == boolean.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBoolValueMethod(fieldName, ordinal, features, format, (Boolean) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == Boolean.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBoolMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (Boolean) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == byte.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt8ValueMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (Byte) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == short.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt16ValueMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (Short) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == int.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt32ValueMethod(fieldName, fieldType, fieldClass, ordinal, features, format, (Integer) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == long.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt64ValueMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (Long) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == float.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderFloatValueMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (Float) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == double.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderDoubleValueMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (Double) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == Byte.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt8Method(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (Byte) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == Short.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt16Method(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (Short) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == Integer.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt32Method(fieldName, ordinal, features, format, locale, (Integer) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == Long.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt64Method(fieldName, ordinal, features, format, locale, (Long) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == Float.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderFloatMethod(fieldName, ordinal, features, format, locale, (Float) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == Double.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderDoubleMethod(fieldName, ordinal, features, format, (Double) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == BigDecimal.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBigDecimalMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (BigDecimal) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == BigInteger.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBigIntegerMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (BigInteger) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == String.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderStringMethod(fieldName, fieldType, fieldClass, ordinal, features, format, locale, (String) defaultValue, jsonSchema, method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == LocalDate.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderLocalDate(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    ordinal,
&nbsp;                    features,
&nbsp;                    format,
&nbsp;                    locale,
&nbsp;                    defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    method,
&nbsp;                    null,
&nbsp;                    null
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == OffsetDateTime.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderOffsetDateTime(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    ordinal,
&nbsp;                    features,
&nbsp;                    format,
&nbsp;                    locale,
&nbsp;                    defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    method,
&nbsp;                    null,
&nbsp;                    null
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == UUID.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderUUID(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    ordinal,
&nbsp;                    features,
&nbsp;                    format,
&nbsp;                    locale,
&nbsp;                    defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    method,
&nbsp;                    null,
&nbsp;                    null
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == String[].class) {</b>
<b class="nc">&nbsp;            return new FieldReaderStringArray(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    ordinal,
&nbsp;                    features,
&nbsp;                    format,
&nbsp;                    locale,
&nbsp;                    defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    method,
&nbsp;                    null,
&nbsp;                    null
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (method.getParameterCount() == 0) {</b>
<b class="nc">&nbsp;            if (fieldClass == AtomicInteger.class) {</b>
<b class="nc">&nbsp;                return new FieldReaderAtomicIntegerMethodReadOnly(fieldName, fieldClass, ordinal, jsonSchema, method);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldClass == AtomicLong.class) {</b>
<b class="nc">&nbsp;                return new FieldReaderAtomicLongReadOnly(fieldName, fieldClass, ordinal, jsonSchema, method);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldClass == AtomicIntegerArray.class) {</b>
<b class="nc">&nbsp;                return new FieldReaderAtomicIntegerArrayReadOnly(fieldName, fieldClass, ordinal, jsonSchema, method);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldClass == AtomicLongArray.class) {</b>
<b class="nc">&nbsp;                return new FieldReaderAtomicLongArrayReadOnly(fieldName, fieldClass, ordinal, jsonSchema, method);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldClass == AtomicBoolean.class) {</b>
<b class="nc">&nbsp;                return new FieldReaderAtomicBooleanMethodReadOnly(fieldName, fieldClass, ordinal, jsonSchema, method);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldClass == AtomicReference.class) {</b>
<b class="nc">&nbsp;                return new FieldReaderAtomicReferenceMethodReadOnly(fieldName, fieldType, fieldClass, ordinal, jsonSchema, method);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (Collection.class.isAssignableFrom(fieldClass)) {</b>
<b class="nc">&nbsp;                Field field = null;</b>
<b class="nc">&nbsp;                String methodName = method.getName();</b>
<b class="nc">&nbsp;                if (methodName.startsWith(&quot;get&quot;)) {</b>
<b class="nc">&nbsp;                    String getterName = BeanUtils.getterName(methodName, PropertyNamingStrategy.CamelCase.name());</b>
<b class="nc">&nbsp;                    field = BeanUtils.getDeclaredField(method.getDeclaringClass(), getterName);</b>
&nbsp;                }
<b class="nc">&nbsp;                return new FieldReaderCollectionMethodReadOnly(</b>
&nbsp;                        fieldName,
&nbsp;                        fieldType,
&nbsp;                        fieldClass,
&nbsp;                        ordinal,
&nbsp;                        features,
&nbsp;                        format,
&nbsp;                        jsonSchema,
&nbsp;                        method,
&nbsp;                        field
&nbsp;                );
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (Map.class.isAssignableFrom(fieldClass)) {</b>
<b class="nc">&nbsp;                Field field = null;</b>
<b class="nc">&nbsp;                String methodName = method.getName();</b>
<b class="nc">&nbsp;                if (methodName.startsWith(&quot;get&quot;)) {</b>
<b class="nc">&nbsp;                    String getterName = BeanUtils.getterName(methodName, PropertyNamingStrategy.CamelCase.name());</b>
<b class="nc">&nbsp;                    field = BeanUtils.getDeclaredField(method.getDeclaringClass(), getterName);</b>
&nbsp;                }
<b class="nc">&nbsp;                return new FieldReaderMapMethodReadOnly(</b>
&nbsp;                        fieldName,
&nbsp;                        fieldType,
&nbsp;                        fieldClass,
&nbsp;                        ordinal,
&nbsp;                        features,
&nbsp;                        format,
&nbsp;                        jsonSchema,
&nbsp;                        method,
&nbsp;                        field
&nbsp;                );
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (!objectClass.isInterface()) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Type fieldTypeResolved = null;</b>
<b class="nc">&nbsp;        Class fieldClassResolved = null;</b>
<b class="nc">&nbsp;        if (!(fieldType instanceof Class)) {</b>
<b class="nc">&nbsp;            fieldTypeResolved = BeanUtils.getFieldType(TypeReference.get(objectType), objectClass, method, fieldType);</b>
<b class="nc">&nbsp;            fieldClassResolved = TypeUtils.getMapping(fieldTypeResolved);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == List.class</b>
&nbsp;                || fieldClass == ArrayList.class
&nbsp;                || fieldClass == LinkedList.class
&nbsp;        ) {
<b class="nc">&nbsp;            if (fieldTypeResolved instanceof ParameterizedType) {</b>
<b class="nc">&nbsp;                ParameterizedType parameterizedType = (ParameterizedType) fieldTypeResolved;</b>
<b class="nc">&nbsp;                Type[] actualTypeArguments = parameterizedType.getActualTypeArguments();</b>
<b class="nc">&nbsp;                if (actualTypeArguments.length == 1) {</b>
<b class="nc">&nbsp;                    Type itemType = actualTypeArguments[0];</b>
<b class="nc">&nbsp;                    Class itemClass = TypeUtils.getMapping(itemType);</b>
&nbsp;
<b class="nc">&nbsp;                    if (itemClass == String.class) {</b>
<b class="nc">&nbsp;                        return new FieldReaderList(fieldName, fieldTypeResolved, fieldClass, String.class, String.class, ordinal, features, format, locale, null, jsonSchema, method, null, null);</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    return new FieldReaderList(fieldName, fieldTypeResolved, fieldClassResolved, itemType, itemClass, ordinal, features, format, locale, null, jsonSchema, method, null, null);</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            return new FieldReaderList(fieldName, fieldType, fieldClass, Object.class, Object.class, ordinal, features, format, locale, null, jsonSchema, method, null, null);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Date.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderDate(fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, jsonSchema, null, method, null);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == StackTraceElement[].class &amp;&amp; method.getDeclaringClass() == Throwable.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderStackTrace(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldTypeResolved != null ? fieldTypeResolved : fieldType,
&nbsp;                    fieldClass,
&nbsp;                    ordinal,
&nbsp;                    features,
&nbsp;                    format,
&nbsp;                    locale,
&nbsp;                    defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    method,
&nbsp;                    null,
&nbsp;                    (BiConsumer&lt;Throwable, StackTraceElement[]&gt;) Throwable::setStackTrace
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Field field = null;</b>
<b class="nc">&nbsp;        if ((features &amp; FieldInfo.UNWRAPPED_MASK) != 0) {</b>
<b class="nc">&nbsp;            String methodName = method.getName();</b>
<b class="nc">&nbsp;            if (methodName.startsWith(&quot;set&quot;)) {</b>
<b class="nc">&nbsp;                String setterName = BeanUtils.setterName(methodName, PropertyNamingStrategy.CamelCase.name());</b>
<b class="nc">&nbsp;                field = BeanUtils.getDeclaredField(method.getDeclaringClass(), setterName);</b>
&nbsp;                try {
<b class="nc">&nbsp;                    field.setAccessible(true);</b>
<b class="nc">&nbsp;                } catch (Throwable ignored) {</b>
&nbsp;                    // ignored
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return new FieldReaderObject(</b>
&nbsp;                fieldName,
&nbsp;                fieldTypeResolved != null ? fieldTypeResolved : fieldType,
&nbsp;                fieldClass,
&nbsp;                ordinal,
&nbsp;                features,
&nbsp;                format,
&nbsp;                locale,
&nbsp;                defaultValue,
&nbsp;                jsonSchema,
&nbsp;                method,
&nbsp;                field,
&nbsp;                null
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader&lt;T&gt; createFieldReader(
&nbsp;            String fieldName,
&nbsp;            Type fieldType,
&nbsp;            Field field
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReader(fieldName, null, fieldType, field);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader&lt;T&gt; createFieldReader(
&nbsp;            String fieldName,
&nbsp;            Field field
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReader(fieldName, null, field.getGenericType(), field);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader createFieldReader(
&nbsp;            String fieldName,
&nbsp;            Method method
&nbsp;    ) {
<b class="nc">&nbsp;        Class&lt;?&gt; declaringClass = method.getDeclaringClass();</b>
<b class="nc">&nbsp;        int parameterCount = method.getParameterCount();</b>
&nbsp;
&nbsp;        Class fieldClass;
&nbsp;        Type fieldType;
<b class="nc">&nbsp;        if (parameterCount == 0) {</b>
<b class="nc">&nbsp;            fieldClass = method.getReturnType();</b>
<b class="nc">&nbsp;            fieldType = method.getGenericReturnType();</b>
<b class="nc">&nbsp;        } else if (parameterCount == 1) {</b>
<b class="nc">&nbsp;            fieldClass = method.getParameterTypes()[0];</b>
<b class="nc">&nbsp;            fieldType = method.getGenericParameterTypes()[0];</b>
&nbsp;        } else {
<b class="nc">&nbsp;            throw new JSONException(&quot;illegal setter method &quot; + method);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return createFieldReaderMethod(</b>
&nbsp;                declaringClass,
&nbsp;                declaringClass,
&nbsp;                fieldName,
&nbsp;                0,
&nbsp;                0L,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null,
&nbsp;                fieldType,
&nbsp;                fieldClass,
&nbsp;                method,
&nbsp;                null
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader&lt;T&gt; createFieldReader(
&nbsp;            String fieldName,
&nbsp;            String format,
&nbsp;            Type fieldType,
&nbsp;            Field field
&nbsp;    ) {
<b class="nc">&nbsp;        Class objectClass = field.getDeclaringClass();</b>
<b class="nc">&nbsp;        return createFieldReader(objectClass, objectClass, fieldName, 0, format, fieldType, field.getType(), field);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader&lt;T&gt; createFieldReader(
&nbsp;            Class objectClass,
&nbsp;            Type objectType,
&nbsp;            String fieldName,
&nbsp;            long features,
&nbsp;            String format,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            Field field
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReader(</b>
&nbsp;                objectClass,
&nbsp;                objectType,
&nbsp;                fieldName,
&nbsp;                0,
&nbsp;                features,
&nbsp;                format,
&nbsp;                null,
&nbsp;                null,
&nbsp;                null,
&nbsp;                fieldType,
<b class="nc">&nbsp;                field.getType(),</b>
&nbsp;                field,
&nbsp;                null
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T&gt; FieldReader&lt;T&gt; createFieldReader(
&nbsp;            Class objectClass,
&nbsp;            Type objectType,
&nbsp;            String fieldName,
&nbsp;            int ordinal,
&nbsp;            long features,
&nbsp;            String format,
&nbsp;            Locale locale,
&nbsp;            Object defaultValue,
&nbsp;            String schema,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            Field field,
&nbsp;            ObjectReader initReader
&nbsp;    ) {
<b class="nc">&nbsp;        if (defaultValue != null &amp;&amp; defaultValue.getClass() != fieldClass) {</b>
&nbsp;            ObjectReaderProvider provider = JSONFactory
<b class="nc">&nbsp;                    .getDefaultObjectReaderProvider();</b>
<b class="nc">&nbsp;            Function typeConvert = provider.getTypeConvert(defaultValue.getClass(), fieldType);</b>
<b class="nc">&nbsp;            if (typeConvert != null) {</b>
<b class="nc">&nbsp;                defaultValue = typeConvert.apply(defaultValue);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                throw new JSONException(&quot;illegal defaultValue : &quot; + defaultValue + &quot;, class &quot; + fieldClass.getName());</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        JSONSchema jsonSchema = null;</b>
<b class="nc">&nbsp;        if (schema != null &amp;&amp; !schema.isEmpty()) {</b>
<b class="nc">&nbsp;            JSONObject object = JSON.parseObject(schema);</b>
<b class="nc">&nbsp;            if (!object.isEmpty()) {</b>
<b class="nc">&nbsp;                jsonSchema = JSONSchema.of(object, fieldClass);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (field != null) {</b>
<b class="nc">&nbsp;            String objectClassName = objectClass.getName();</b>
<b class="nc">&nbsp;            if (!objectClassName.startsWith(&quot;java.lang&quot;) &amp;&amp; !objectClassName.startsWith(&quot;java.time&quot;)) {</b>
<b class="nc">&nbsp;                field.setAccessible(true);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (initReader != null) {</b>
<b class="nc">&nbsp;            FieldReaderObjectField fieldReader = new FieldReaderObjectField(fieldName, fieldType, fieldClass, ordinal, features | FieldInfo.READ_USING_MASK, format, defaultValue, jsonSchema, field);</b>
<b class="nc">&nbsp;            fieldReader.initReader = initReader;</b>
<b class="nc">&nbsp;            return fieldReader;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == int.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt32ValueField(fieldName, fieldClass, ordinal, format, (Integer) defaultValue, jsonSchema, field);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (fieldClass == Integer.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt32Field(fieldName, fieldClass, ordinal, features, format, (Integer) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == long.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt64ValueField(fieldName, fieldClass, ordinal, features, format, (Long) defaultValue, jsonSchema, field);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (fieldClass == Long.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt64Field(fieldName, fieldClass, ordinal, features, format, (Long) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == short.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt16ValueField(fieldName, fieldClass, ordinal, features, format, (Short) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Short.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt16Field(fieldName, fieldClass, ordinal, features, format, (Short) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == boolean.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBoolValueField(fieldName, ordinal, features, format, (Boolean) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Boolean.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBoolField(fieldName, fieldClass, ordinal, features, format, (Boolean) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == byte.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt8ValueField(fieldName, fieldClass, ordinal, features, format, (Byte) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Byte.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt8Field(fieldName, fieldClass, ordinal, features, format, (Byte) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == float.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderFloatValueField(fieldName, fieldClass, ordinal, features, format, (Float) defaultValue, jsonSchema, field);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (fieldClass == Float.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderFloatField(fieldName, fieldClass, ordinal, features, format, (Float) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == double.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderDoubleValueField(fieldName, fieldClass, ordinal, features, format, (Double) defaultValue, jsonSchema, field);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (fieldClass == Double.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderDoubleField(fieldName, fieldClass, ordinal, features, format, (Double) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == char.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderCharValueField(fieldName, ordinal, features, format, (Character) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == BigDecimal.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBigDecimalField(fieldName, fieldClass, ordinal, features, format, (BigDecimal) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == BigInteger.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBigIntegerField(fieldName, fieldClass, ordinal, features, format, (BigInteger) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == String.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderStringField(fieldName, fieldClass, ordinal, features, format, (String) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Date.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderDate(fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, jsonSchema, field, null, null);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == AtomicBoolean.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderAtomicBooleanFieldReadOnly(fieldName, fieldClass, ordinal, format, (AtomicBoolean) defaultValue, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == AtomicReference.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderAtomicReferenceField(fieldName, fieldType, fieldClass, ordinal, format, jsonSchema, field);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Type fieldTypeResolved = null;</b>
<b class="nc">&nbsp;        Class fieldClassResolved = null;</b>
<b class="nc">&nbsp;        if (!(fieldType instanceof Class)) {</b>
<b class="nc">&nbsp;            fieldTypeResolved = BeanUtils.getFieldType(TypeReference.get(objectType), objectClass, field, fieldType);</b>
<b class="nc">&nbsp;            fieldClassResolved = TypeUtils.getMapping(fieldTypeResolved);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        boolean finalField = Modifier.isFinal(field.getModifiers());</b>
<b class="nc">&nbsp;        if (Collection.class.isAssignableFrom(fieldClass)) {</b>
<b class="nc">&nbsp;            if (fieldTypeResolved instanceof ParameterizedType) {</b>
<b class="nc">&nbsp;                ParameterizedType parameterizedType = (ParameterizedType) fieldTypeResolved;</b>
<b class="nc">&nbsp;                Type[] actualTypeArguments = parameterizedType.getActualTypeArguments();</b>
&nbsp;
<b class="nc">&nbsp;                if (actualTypeArguments.length == 1) {</b>
<b class="nc">&nbsp;                    Type itemType = actualTypeArguments[0];</b>
<b class="nc">&nbsp;                    Class itemClass = TypeUtils.getMapping(itemType);</b>
<b class="nc">&nbsp;                    if (itemClass == String.class) {</b>
<b class="nc">&nbsp;                        if (finalField) {</b>
<b class="nc">&nbsp;                            if ((features &amp; JSONReader.Feature.FieldBased.mask) != 0) {</b>
<b class="nc">&nbsp;                                return new FieldReaderListField(fieldName, fieldTypeResolved, fieldClassResolved, String.class, String.class, ordinal, features, format, locale, null, jsonSchema, field);</b>
&nbsp;                            }
&nbsp;
<b class="nc">&nbsp;                            return new FieldReaderCollectionFieldReadOnly(fieldName, fieldTypeResolved, fieldClassResolved, ordinal, features, format, jsonSchema, field);</b>
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        return new FieldReaderListField(fieldName, fieldTypeResolved, fieldClassResolved, String.class, String.class, ordinal, features, format, locale, null, jsonSchema, field);</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    return new FieldReaderListField(</b>
&nbsp;                            fieldName,
&nbsp;                            fieldTypeResolved,
&nbsp;                            fieldClassResolved,
&nbsp;                            itemType,
&nbsp;                            itemClass,
&nbsp;                            ordinal,
&nbsp;                            features,
&nbsp;                            format,
&nbsp;                            locale,
&nbsp;                            (Collection) defaultValue,
&nbsp;                            jsonSchema,
&nbsp;                            field
&nbsp;                    );
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            Type itemType = null;</b>
<b class="nc">&nbsp;            if (fieldType instanceof ParameterizedType) {</b>
<b class="nc">&nbsp;                Type[] actualTypeArguments = ((ParameterizedType) fieldType).getActualTypeArguments();</b>
<b class="nc">&nbsp;                if (actualTypeArguments.length &gt; 0) {</b>
<b class="nc">&nbsp;                    itemType = actualTypeArguments[0];</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (itemType == null) {</b>
<b class="nc">&nbsp;                itemType = Object.class;</b>
&nbsp;            }
<b class="nc">&nbsp;            Class itemClass = TypeUtils.getClass(itemType);</b>
&nbsp;
<b class="nc">&nbsp;            return new FieldReaderListField(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    itemType,
&nbsp;                    itemClass,
&nbsp;                    ordinal,
&nbsp;                    features,
&nbsp;                    format,
&nbsp;                    locale,
&nbsp;                    (Collection) defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    field
&nbsp;            );
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (Map.class.isAssignableFrom(fieldClass)) {</b>
<b class="nc">&nbsp;            if (fieldTypeResolved instanceof ParameterizedType) {</b>
<b class="nc">&nbsp;                ParameterizedType parameterizedType = (ParameterizedType) fieldTypeResolved;</b>
<b class="nc">&nbsp;                Type[] actualTypeArguments = parameterizedType.getActualTypeArguments();</b>
&nbsp;
<b class="nc">&nbsp;                if (actualTypeArguments.length == 2) {</b>
<b class="nc">&nbsp;                    if (finalField &amp;&amp; ((features &amp; JSONReader.Feature.FieldBased.mask) == 0)) {</b>
<b class="nc">&nbsp;                        return new FieldReaderMapFieldReadOnly(fieldName, fieldTypeResolved, fieldClassResolved, ordinal, features, format, jsonSchema, field);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (finalField) {</b>
<b class="nc">&nbsp;            if (fieldClass == int[].class) {</b>
<b class="nc">&nbsp;                return new FieldReaderInt32ValueArrayFinalField(fieldName, fieldClass, ordinal, features, format, (int[]) defaultValue, jsonSchema, field);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldClass == long[].class) {</b>
<b class="nc">&nbsp;                return new FieldReaderInt64ValueArrayFinalField(fieldName, fieldClass, ordinal, features, format, (long[]) defaultValue, jsonSchema, field);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClassResolved != null) {</b>
<b class="nc">&nbsp;            if ((features &amp; FieldInfo.UNWRAPPED_MASK) != 0</b>
<b class="nc">&nbsp;                    &amp;&amp; Map.class.isAssignableFrom(fieldClassResolved)</b>
&nbsp;            ) {
<b class="nc">&nbsp;                return new FieldReaderMapFieldReadOnly(fieldName,</b>
&nbsp;                        fieldTypeResolved,
&nbsp;                        fieldClass,
&nbsp;                        ordinal,
&nbsp;                        features,
&nbsp;                        format,
&nbsp;                        jsonSchema,
&nbsp;                        field);
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return new FieldReaderObjectField(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldTypeResolved,
&nbsp;                    fieldClass,
&nbsp;                    ordinal,
&nbsp;                    features,
&nbsp;                    format,
&nbsp;                    defaultValue,
&nbsp;                    jsonSchema,
&nbsp;                    field);
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == LocalDateTime.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderLocalDateTime(fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, jsonSchema, field, null, null);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == ZonedDateTime.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderZonedDateTime(fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, jsonSchema, field, null, null);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Instant.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInstant(fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, jsonSchema, field, null, null);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return new FieldReaderObjectField(fieldName, fieldType, fieldClass, ordinal, features, format, defaultValue, jsonSchema, field);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T, V&gt; FieldReader createFieldReader(
&nbsp;            String fieldName,
&nbsp;            Type fieldType,
&nbsp;            Class&lt;V&gt; fieldClass,
&nbsp;            long features,
&nbsp;            BiConsumer&lt;T, V&gt; function
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReader(null, null, fieldName, fieldType, fieldClass, 0, features, null, null, null, null, null, function, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T, V&gt; FieldReader createFieldReader(
&nbsp;            String fieldName,
&nbsp;            Type fieldType,
&nbsp;            Class&lt;V&gt; fieldClass,
&nbsp;            Method method,
&nbsp;            BiConsumer&lt;T, V&gt; function
&nbsp;    ) {
<b class="nc">&nbsp;        return createFieldReader(null, null, fieldName, fieldType, fieldClass, 0, 0, null, null, null, null, method, function, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    public &lt;T, V&gt; FieldReader createFieldReader(
&nbsp;            Class objectClass,
&nbsp;            Type objectType,
&nbsp;            String fieldName,
&nbsp;            Type fieldType,
&nbsp;            Class&lt;V&gt; fieldClass,
&nbsp;            int ordinal,
&nbsp;            long features,
&nbsp;            String format,
&nbsp;            Locale locale,
&nbsp;            Object defaultValue,
&nbsp;            JSONSchema schema,
&nbsp;            Method method,
&nbsp;            BiConsumer&lt;T, V&gt; function,
&nbsp;            ObjectReader initReader
&nbsp;    ) {
<b class="nc">&nbsp;        if (initReader != null) {</b>
<b class="nc">&nbsp;            FieldReaderObject fieldReaderObjectMethod = new FieldReaderObject(</b>
&nbsp;                    fieldName,
&nbsp;                    fieldType,
&nbsp;                    fieldClass,
&nbsp;                    ordinal,
&nbsp;                    features | FieldInfo.READ_USING_MASK,
&nbsp;                    format,
&nbsp;                    locale,
&nbsp;                    defaultValue,
&nbsp;                    schema,
&nbsp;                    method,
&nbsp;                    null,
&nbsp;                    function
&nbsp;            );
<b class="nc">&nbsp;            fieldReaderObjectMethod.initReader = initReader;</b>
<b class="nc">&nbsp;            return fieldReaderObjectMethod;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Integer.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt32Func&lt;&gt;(fieldName, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Long.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt64Func&lt;&gt;(fieldName, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == String.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderStringFunc&lt;&gt;(fieldName, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Boolean.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBoolFunc&lt;&gt;(fieldName, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Short.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt16Func(fieldName, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Byte.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderInt8Func(fieldName, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == BigDecimal.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBigDecimalFunc(fieldName, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == BigInteger.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderBigIntegerFunc(fieldName, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Float.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderFloatFunc(fieldName, fieldClass, ordinal, features, format, locale, (Float) defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Double.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderDoubleFunc(fieldName, fieldClass, ordinal, features, format, locale, (Double) defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Number.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderNumberFunc(fieldName, fieldClass, ordinal, features, format, locale, (Number) defaultValue, schema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == Date.class) {</b>
<b class="nc">&nbsp;            return new FieldReaderDate(fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, schema, null, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Type fieldTypeResolved = null;</b>
<b class="nc">&nbsp;        Class fieldClassResolved = null;</b>
&nbsp;
<b class="nc">&nbsp;        if (!(fieldType instanceof Class)) {</b>
&nbsp;            TypeReference&lt;?&gt; objectTypeReference;
<b class="nc">&nbsp;            if (objectType == null) {</b>
<b class="nc">&nbsp;                objectTypeReference = null;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                objectTypeReference = TypeReference.get(objectType);</b>
&nbsp;            }
<b class="nc">&nbsp;            fieldTypeResolved = BeanUtils.getFieldType(objectTypeReference, objectClass, method, fieldType);</b>
<b class="nc">&nbsp;            fieldClassResolved = TypeUtils.getMapping(fieldTypeResolved);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldClass == List.class || fieldClass == ArrayList.class) {</b>
<b class="nc">&nbsp;            Type itemType = Object.class;</b>
<b class="nc">&nbsp;            Class itemClass = Object.class;</b>
<b class="nc">&nbsp;            if (fieldTypeResolved instanceof ParameterizedType) {</b>
<b class="nc">&nbsp;                ParameterizedType parameterizedType = (ParameterizedType) fieldTypeResolved;</b>
<b class="nc">&nbsp;                Type[] actualTypeArguments = parameterizedType.getActualTypeArguments();</b>
&nbsp;
<b class="nc">&nbsp;                if (actualTypeArguments.length == 1) {</b>
<b class="nc">&nbsp;                    itemType = actualTypeArguments[0];</b>
<b class="nc">&nbsp;                    itemClass = TypeUtils.getMapping(itemType);</b>
<b class="nc">&nbsp;                    if (itemClass == String.class) {</b>
<b class="nc">&nbsp;                        return new FieldReaderList(fieldName, fieldTypeResolved, fieldClassResolved, String.class, String.class, ordinal, features, format, locale, defaultValue, schema, method, null, function);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return new FieldReaderList(fieldName, fieldTypeResolved, fieldClassResolved, itemType, itemClass, ordinal, features, format, locale, defaultValue, schema, method, null, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldTypeResolved != null) {</b>
<b class="nc">&nbsp;            return new FieldReaderObjectFunc&lt;&gt;(fieldName, fieldTypeResolved, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function, null);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return new FieldReaderObjectFunc&lt;&gt;(fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, schema, method, function, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    protected ObjectReader createEnumReader(
&nbsp;            Class objectClass,
&nbsp;            Method createMethod,
&nbsp;            ObjectReaderProvider provider
&nbsp;    ) {
<b class="nc">&nbsp;        FieldInfo fieldInfo = new FieldInfo();</b>
&nbsp;
<b class="nc">&nbsp;        Enum[] ordinalEnums = (Enum[]) objectClass.getEnumConstants();</b>
&nbsp;
<b class="nc">&nbsp;        Map&lt;Long, Enum&gt; enumMap = new LinkedHashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        for (int i = 0; ordinalEnums != null &amp;&amp; i &lt; ordinalEnums.length; ++i) {</b>
<b class="nc">&nbsp;            Enum e = ordinalEnums[i];</b>
<b class="nc">&nbsp;            String name = e.name();</b>
<b class="nc">&nbsp;            long hash = Fnv.hashCode64(name);</b>
<b class="nc">&nbsp;            enumMap.put(hash, e);</b>
&nbsp;
&nbsp;            try {
<b class="nc">&nbsp;                fieldInfo.init();</b>
<b class="nc">&nbsp;                Field field = objectClass.getField(name);</b>
<b class="nc">&nbsp;                provider.getFieldInfo(fieldInfo, objectClass, field);</b>
<b class="nc">&nbsp;                String jsonFieldName = fieldInfo.fieldName;</b>
<b class="nc">&nbsp;                if (jsonFieldName != null &amp;&amp; !jsonFieldName.isEmpty() &amp;&amp; !jsonFieldName.equals(name)) {</b>
<b class="nc">&nbsp;                    long jsonFieldNameHash = Fnv.hashCode64(jsonFieldName);</b>
<b class="nc">&nbsp;                    enumMap.putIfAbsent(jsonFieldNameHash, e);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (fieldInfo.alternateNames != null) {</b>
<b class="nc">&nbsp;                    for (String alternateName : fieldInfo.alternateNames) {</b>
<b class="nc">&nbsp;                        if (alternateName == null || alternateName.isEmpty()) {</b>
<b class="nc">&nbsp;                            continue;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        long alternateNameHash = Fnv.hashCode64(alternateName);</b>
<b class="nc">&nbsp;                        enumMap.putIfAbsent(alternateNameHash, e);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;            } catch (Exception ignored) {</b>
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; ordinalEnums != null &amp;&amp; i &lt; ordinalEnums.length; ++i) {</b>
<b class="nc">&nbsp;            Enum e = ordinalEnums[i];</b>
<b class="nc">&nbsp;            String name = e.name();</b>
<b class="nc">&nbsp;            long hashLCase = Fnv.hashCode64LCase(name);</b>
<b class="nc">&nbsp;            enumMap.putIfAbsent(hashLCase, e);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        long[] enumNameHashCodes = new long[enumMap.size()];</b>
&nbsp;        {
<b class="nc">&nbsp;            int i = 0;</b>
<b class="nc">&nbsp;            for (Long h : enumMap.keySet()) {</b>
<b class="nc">&nbsp;                enumNameHashCodes[i++] = h;</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            Arrays.sort(enumNameHashCodes);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Member enumValueField = BeanUtils.getEnumValueField(objectClass, provider);</b>
<b class="nc">&nbsp;        if (enumValueField == null &amp;&amp; provider.modules.size() &gt; 0) {</b>
<b class="nc">&nbsp;            Class fieldClassMixInSource = provider.getMixIn(objectClass);</b>
<b class="nc">&nbsp;            if (fieldClassMixInSource != null) {</b>
<b class="nc">&nbsp;                Member mixedValueField = BeanUtils.getEnumValueField(fieldClassMixInSource, provider);</b>
<b class="nc">&nbsp;                if (mixedValueField instanceof Field) {</b>
&nbsp;                    try {
<b class="nc">&nbsp;                        enumValueField = objectClass.getField(mixedValueField.getName());</b>
<b class="nc">&nbsp;                    } catch (NoSuchFieldException ignored) {</b>
<b class="nc">&nbsp;                    }</b>
<b class="nc">&nbsp;                } else if (mixedValueField instanceof Method) {</b>
&nbsp;                    try {
<b class="nc">&nbsp;                        enumValueField = objectClass.getMethod(mixedValueField.getName());</b>
<b class="nc">&nbsp;                    } catch (NoSuchMethodException ignored) {</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        Enum[] enums = new Enum[enumNameHashCodes.length];</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; enumNameHashCodes.length; ++i) {</b>
<b class="nc">&nbsp;            long hash = enumNameHashCodes[i];</b>
<b class="nc">&nbsp;            Enum e = enumMap.get(hash);</b>
<b class="nc">&nbsp;            enums[i] = e;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return new ObjectReaderImplEnum(objectClass, createMethod, enumValueField, enums, ordinalEnums, enumNameHashCodes);</b>
&nbsp;    }
&nbsp;
&nbsp;    static ObjectReader getInitReader(
&nbsp;            ObjectReaderProvider provider,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            FieldInfo fieldInfo
&nbsp;    ) {
<b class="nc">&nbsp;        ObjectReader initReader = fieldInfo.getInitReader();</b>
<b class="nc">&nbsp;        if (initReader == null &amp;&amp; Map.class.isAssignableFrom(fieldClass) &amp;&amp; (fieldInfo.keyUsing != null || fieldInfo.valueUsing != null)) {</b>
<b class="nc">&nbsp;            ObjectReader keyReader = null;</b>
<b class="nc">&nbsp;            if (fieldInfo.keyUsing != null) {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    Constructor&lt;?&gt; constructor = fieldInfo.keyUsing.getDeclaredConstructor();</b>
<b class="nc">&nbsp;                    constructor.setAccessible(true);</b>
<b class="nc">&nbsp;                    keyReader = (ObjectReader) constructor.newInstance();</b>
<b class="nc">&nbsp;                } catch (Exception ignored) {</b>
&nbsp;                    // ignored
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            ObjectReader valueReader = null;</b>
<b class="nc">&nbsp;            if (fieldInfo.valueUsing != null) {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    Constructor&lt;?&gt; constructor = fieldInfo.valueUsing.getDeclaredConstructor();</b>
<b class="nc">&nbsp;                    constructor.setAccessible(true);</b>
<b class="nc">&nbsp;                    valueReader = (ObjectReader) constructor.newInstance();</b>
<b class="nc">&nbsp;                } catch (Exception ignored) {</b>
&nbsp;                    // ignored
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (keyReader != null || valueReader != null) {</b>
<b class="nc">&nbsp;                ObjectReader reader = ObjectReaderImplMap.of(fieldType, fieldClass, fieldInfo.features);</b>
<b class="nc">&nbsp;                if (reader instanceof ObjectReaderImplMapTyped) {</b>
<b class="nc">&nbsp;                    ObjectReaderImplMapTyped mapReader = (ObjectReaderImplMapTyped) reader;</b>
<b class="nc">&nbsp;                    if (keyReader != null) {</b>
<b class="nc">&nbsp;                        mapReader.keyObjectReader = keyReader;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if (valueReader != null) {</b>
<b class="nc">&nbsp;                        mapReader.valueObjectReader = valueReader;</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    return mapReader;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (initReader == null) {</b>
<b class="nc">&nbsp;            if (fieldClass == long.class || fieldClass == Long.class) {</b>
<b class="nc">&nbsp;                ObjectReader objectReader = provider.getObjectReader(Long.class);</b>
<b class="nc">&nbsp;                if (objectReader != ObjectReaderImplInt64.INSTANCE) {</b>
<b class="nc">&nbsp;                    initReader = objectReader;</b>
&nbsp;                }
<b class="nc">&nbsp;            } else if (fieldClass == BigDecimal.class) {</b>
<b class="nc">&nbsp;                ObjectReader objectReader = provider.getObjectReader(BigDecimal.class);</b>
<b class="nc">&nbsp;                if (objectReader != ObjectReaderImplBigDecimal.INSTANCE) {</b>
<b class="nc">&nbsp;                    initReader = objectReader;</b>
&nbsp;                }
<b class="nc">&nbsp;            } else if (fieldClass == BigInteger.class) {</b>
<b class="nc">&nbsp;                ObjectReader objectReader = provider.getObjectReader(BigInteger.class);</b>
<b class="nc">&nbsp;                if (objectReader != ObjectReaderImplBigInteger.INSTANCE) {</b>
<b class="nc">&nbsp;                    initReader = objectReader;</b>
&nbsp;                }
<b class="nc">&nbsp;            } else if (fieldClass == Date.class) {</b>
<b class="nc">&nbsp;                ObjectReader objectReader = provider.getObjectReader(Date.class);</b>
<b class="nc">&nbsp;                if (objectReader != ObjectReaderImplDate.INSTANCE) {</b>
<b class="nc">&nbsp;                    initReader = objectReader;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return initReader;</b>
&nbsp;    }
&nbsp;
&nbsp;    protected &lt;T&gt; FieldReader createFieldReaderLambda(
&nbsp;            Class&lt;T&gt; objectClass,
&nbsp;            Type objectType,
&nbsp;            String fieldName,
&nbsp;            int ordinal,
&nbsp;            long features,
&nbsp;            String format,
&nbsp;            Locale locale,
&nbsp;            Object defaultValue,
&nbsp;            String schema,
&nbsp;            Type fieldType,
&nbsp;            Class fieldClass,
&nbsp;            Method method,
&nbsp;            ObjectReader initReader
&nbsp;    ) {
<b class="nc">&nbsp;        if (defaultValue != null &amp;&amp; defaultValue.getClass() != fieldClass) {</b>
&nbsp;            Function typeConvert = JSONFactory
<b class="nc">&nbsp;                    .getDefaultObjectReaderProvider()</b>
<b class="nc">&nbsp;                    .getTypeConvert(defaultValue.getClass(), fieldType);</b>
<b class="nc">&nbsp;            if (typeConvert != null) {</b>
<b class="nc">&nbsp;                defaultValue = typeConvert.apply(defaultValue);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                throw new JSONException(&quot;illegal defaultValue : &quot; + defaultValue + &quot;, class &quot; + fieldClass.getName());</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        JSONSchema jsonSchema = null;</b>
<b class="nc">&nbsp;        if (schema != null &amp;&amp; !schema.isEmpty()) {</b>
<b class="nc">&nbsp;            JSONObject object = JSON.parseObject(schema);</b>
<b class="nc">&nbsp;            if (!object.isEmpty()) {</b>
<b class="nc">&nbsp;                jsonSchema = JSONSchema.of(object, fieldClass);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (initReader != null) {</b>
<b class="nc">&nbsp;            BiConsumer function = (BiConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return createFieldReader(objectClass, objectType, fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, jsonSchema, method, function, initReader);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == boolean.class) {</b>
<b class="nc">&nbsp;            ObjBoolConsumer function = (ObjBoolConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return new FieldReaderBoolValFunc&lt;&gt;(fieldName, ordinal, jsonSchema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == byte.class) {</b>
<b class="nc">&nbsp;            ObjByteConsumer function = (ObjByteConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return new FieldReaderInt8ValueFunc&lt;&gt;(fieldName, ordinal, jsonSchema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == short.class) {</b>
<b class="nc">&nbsp;            ObjShortConsumer function = (ObjShortConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return new FieldReaderInt16ValueFunc&lt;&gt;(fieldName, ordinal, features, format, locale, (Short) defaultValue, jsonSchema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == int.class) {</b>
<b class="nc">&nbsp;            ObjIntConsumer function = (ObjIntConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return new FieldReaderInt32ValueFunc&lt;&gt;(fieldName, ordinal, (Integer) defaultValue, jsonSchema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == long.class) {</b>
<b class="nc">&nbsp;            ObjLongConsumer function = (ObjLongConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return new FieldReaderInt64ValueFunc&lt;&gt;(fieldName, ordinal, (Long) defaultValue, jsonSchema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == char.class) {</b>
<b class="nc">&nbsp;            ObjCharConsumer function = (ObjCharConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return new FieldReaderCharValueFunc&lt;&gt;(fieldName, ordinal, format, (Character) defaultValue, jsonSchema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == float.class) {</b>
<b class="nc">&nbsp;            ObjFloatConsumer function = (ObjFloatConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return new FieldReaderFloatValueFunc&lt;&gt;(fieldName, ordinal, (Float) defaultValue, jsonSchema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (fieldType == double.class) {</b>
<b class="nc">&nbsp;            ObjDoubleConsumer function = (ObjDoubleConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;            return new FieldReaderDoubleValueFunc&lt;&gt;(fieldName, ordinal, (Double) defaultValue, jsonSchema, method, function);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        BiConsumer consumer = (BiConsumer) lambdaSetter(objectClass, fieldClass, method);</b>
<b class="nc">&nbsp;        return createFieldReader(objectClass, objectType, fieldName, fieldType, fieldClass, ordinal, features, format, locale, defaultValue, jsonSchema, method, consumer, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    protected Object lambdaSetter(Class objectClass, Class fieldClass, Method method) {
<b class="nc">&nbsp;        MethodHandles.Lookup lookup = JDKUtils.trustedLookup(objectClass);</b>
&nbsp;
<b class="nc">&nbsp;        Class&lt;?&gt; returnType = method.getReturnType();</b>
<b class="nc">&nbsp;        LambdaSetterInfo lambdaInfo = methodTypeMapping.get(fieldClass);</b>
&nbsp;
&nbsp;        MethodType samMethodType;
&nbsp;        MethodType invokedType;
<b class="nc">&nbsp;        MethodType methodType = null;</b>
<b class="nc">&nbsp;        if (lambdaInfo != null) {</b>
<b class="nc">&nbsp;            samMethodType = lambdaInfo.sameMethodMethod;</b>
<b class="nc">&nbsp;            invokedType = lambdaInfo.invokedType;</b>
<b class="nc">&nbsp;            if (returnType == void.class) {</b>
<b class="nc">&nbsp;                methodType = lambdaInfo.methodType;</b>
&nbsp;            }
&nbsp;        } else {
<b class="nc">&nbsp;            samMethodType = METHOD_TYPE_VOO;</b>
<b class="nc">&nbsp;            invokedType = METHOD_TYPE_BI_CONSUMER;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (methodType == null) {</b>
<b class="nc">&nbsp;            methodType = MethodType.methodType(returnType, fieldClass);</b>
&nbsp;        }
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            MethodHandle target = lookup.findVirtual(objectClass, method.getName(), methodType);</b>
<b class="nc">&nbsp;            MethodType instantiatedMethodType = MethodType.methodType(void.class, objectClass, fieldClass);</b>
<b class="nc">&nbsp;            CallSite callSite = LambdaMetafactory.metafactory(</b>
&nbsp;                    lookup,
&nbsp;                    &quot;accept&quot;,
&nbsp;                    invokedType,
&nbsp;                    samMethodType,
&nbsp;                    target,
&nbsp;                    instantiatedMethodType
&nbsp;            );
&nbsp;
<b class="nc">&nbsp;            return callSite</b>
<b class="nc">&nbsp;                    .getTarget()</b>
<b class="nc">&nbsp;                    .invoke();</b>
<b class="nc">&nbsp;        } catch (Throwable e) {</b>
<b class="nc">&nbsp;            throw new JSONException(&quot;create fieldReader error&quot;, e);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public Function&lt;Consumer, ByteArrayValueConsumer&gt; createByteArrayValueConsumerCreator(
&nbsp;            Class objectClass,
&nbsp;            FieldReader[] fieldReaderArray
&nbsp;    ) {
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public Function&lt;Consumer, CharArrayValueConsumer&gt; createCharArrayValueConsumerCreator(
&nbsp;            Class objectClass,
&nbsp;            FieldReader[] fieldReaderArray
&nbsp;    ) {
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-04-09 23:22</div>
</div>
</body>
</html>
