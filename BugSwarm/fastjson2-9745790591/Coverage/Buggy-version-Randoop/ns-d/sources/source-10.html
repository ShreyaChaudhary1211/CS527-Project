


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > JSONPathFilter</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.alibaba.fastjson2</a>
</div>

<h1>Coverage Summary for Class: JSONPathFilter (com.alibaba.fastjson2)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">JSONPathFilter</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
</tr>
  <tr>
    <td class="name">JSONPathFilter$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$EndsWithSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$GroupFilter</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/41)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameArrayOpSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameDecimalOpSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/24)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameExistsFilter</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/29)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameFilter</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/114)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameIntBetweenSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/29)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameIntInSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/30)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameIntOpSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/58)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameLongContainsSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/41)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameMatchFilter</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/34)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameObjectOpSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameRLikeSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameStringContainsSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/13)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameStringInSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$NameStringOpSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/14)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$Operator</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/22)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">JSONPathFilter$StartsWithSegment</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/46)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/489)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.alibaba.fastjson2;
&nbsp;
&nbsp;import com.alibaba.fastjson2.util.IOUtils;
&nbsp;import com.alibaba.fastjson2.writer.FieldWriter;
&nbsp;import com.alibaba.fastjson2.writer.ObjectWriter;
&nbsp;import com.alibaba.fastjson2.writer.ObjectWriterAdapter;
&nbsp;
&nbsp;import java.math.BigDecimal;
&nbsp;import java.math.BigInteger;
&nbsp;import java.util.Collection;
&nbsp;import java.util.List;
&nbsp;import java.util.Map;
&nbsp;import java.util.function.Function;
&nbsp;import java.util.regex.Matcher;
&nbsp;import java.util.regex.Pattern;
&nbsp;
<b class="nc">&nbsp;abstract class JSONPathFilter</b>
&nbsp;        extends JSONPathSegment
&nbsp;        implements JSONPathSegment.EvalSegment {
&nbsp;    abstract boolean apply(JSONPath.Context context, Object object);
&nbsp;
<b class="nc">&nbsp;    enum Operator {</b>
<b class="nc">&nbsp;        EQ,</b>
<b class="nc">&nbsp;        NE,</b>
<b class="nc">&nbsp;        GT,</b>
<b class="nc">&nbsp;        GE,</b>
<b class="nc">&nbsp;        LT,</b>
<b class="nc">&nbsp;        LE,</b>
<b class="nc">&nbsp;        LIKE,</b>
<b class="nc">&nbsp;        NOT_LIKE,</b>
<b class="nc">&nbsp;        RLIKE,</b>
<b class="nc">&nbsp;        NOT_RLIKE,</b>
<b class="nc">&nbsp;        IN,</b>
<b class="nc">&nbsp;        NOT_IN,</b>
<b class="nc">&nbsp;        BETWEEN,</b>
<b class="nc">&nbsp;        NOT_BETWEEN,</b>
<b class="nc">&nbsp;        AND,</b>
<b class="nc">&nbsp;        OR,</b>
<b class="nc">&nbsp;        REG_MATCH,</b>
<b class="nc">&nbsp;        STARTS_WITH,</b>
<b class="nc">&nbsp;        ENDS_WITH,</b>
<b class="nc">&nbsp;        CONTAINS,</b>
<b class="nc">&nbsp;        NOT_CONTAINS</b>
&nbsp;    }
&nbsp;
&nbsp;    static final class NameIntOpSegment
&nbsp;            extends NameFilter {
&nbsp;        final Operator operator;
&nbsp;        final long value;
&nbsp;
&nbsp;        public NameIntOpSegment(
&nbsp;                String name,
&nbsp;                long nameHashCode,
&nbsp;                String[] fieldName2,
&nbsp;                long[] fieldNameNameHash2,
&nbsp;                Function expr,
&nbsp;                Operator operator,
&nbsp;                long value) {
<b class="nc">&nbsp;            super(name, nameHashCode, fieldName2, fieldNameNameHash2, expr);</b>
<b class="nc">&nbsp;            this.operator = operator;</b>
<b class="nc">&nbsp;            this.value = value;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            boolean objInt = fieldValue instanceof Boolean</b>
&nbsp;                    || fieldValue instanceof Byte
&nbsp;                    || fieldValue instanceof Short
&nbsp;                    || fieldValue instanceof Integer
&nbsp;                    || fieldValue instanceof Long;
<b class="nc">&nbsp;            if (objInt) {</b>
&nbsp;                long fieldValueInt;
<b class="nc">&nbsp;                if (fieldValue instanceof Boolean) {</b>
<b class="nc">&nbsp;                    fieldValueInt = (Boolean) fieldValue ? 1 : 0;</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    fieldValueInt = ((Number) fieldValue).longValue();</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                switch (operator) {</b>
&nbsp;                    case LT:
<b class="nc">&nbsp;                        return fieldValueInt &lt; this.value;</b>
&nbsp;                    case LE:
<b class="nc">&nbsp;                        return fieldValueInt &lt;= this.value;</b>
&nbsp;                    case EQ:
<b class="nc">&nbsp;                        return fieldValueInt == this.value;</b>
&nbsp;                    case NE:
<b class="nc">&nbsp;                        return fieldValueInt != this.value;</b>
&nbsp;                    case GT:
<b class="nc">&nbsp;                        return fieldValueInt &gt; this.value;</b>
&nbsp;                    case GE:
<b class="nc">&nbsp;                        return fieldValueInt &gt;= this.value;</b>
&nbsp;                    default:
<b class="nc">&nbsp;                        throw new UnsupportedOperationException();</b>
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            int cmp;
<b class="nc">&nbsp;            if (fieldValue instanceof BigDecimal) {</b>
<b class="nc">&nbsp;                cmp = ((BigDecimal) fieldValue)</b>
<b class="nc">&nbsp;                        .compareTo(</b>
<b class="nc">&nbsp;                                BigDecimal.valueOf(value));</b>
<b class="nc">&nbsp;            } else if (fieldValue instanceof BigInteger) {</b>
<b class="nc">&nbsp;                cmp = ((BigInteger) fieldValue)</b>
<b class="nc">&nbsp;                        .compareTo(</b>
<b class="nc">&nbsp;                                BigInteger.valueOf(value));</b>
<b class="nc">&nbsp;            } else if (fieldValue instanceof Float) {</b>
<b class="nc">&nbsp;                cmp = ((Float) fieldValue)</b>
<b class="nc">&nbsp;                        .compareTo(</b>
<b class="nc">&nbsp;                                Float.valueOf(value));</b>
<b class="nc">&nbsp;            } else if (fieldValue instanceof Double) {</b>
<b class="nc">&nbsp;                cmp = ((Double) fieldValue)</b>
<b class="nc">&nbsp;                        .compareTo(</b>
<b class="nc">&nbsp;                                Double.valueOf(value));</b>
<b class="nc">&nbsp;            } else if (fieldValue instanceof String) {</b>
<b class="nc">&nbsp;                String fieldValueStr = (String) fieldValue;</b>
<b class="nc">&nbsp;                if (IOUtils.isNumber(fieldValueStr)) {</b>
&nbsp;                    try {
<b class="nc">&nbsp;                        cmp = Long.valueOf(Long.parseLong(fieldValueStr)).compareTo(Long.valueOf(value));</b>
<b class="nc">&nbsp;                    } catch (Exception ignored) {</b>
<b class="nc">&nbsp;                        cmp = fieldValueStr.compareTo(Long.toString(value));</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    cmp = fieldValueStr.compareTo(Long.toString(value));</b>
&nbsp;                }
<b class="nc">&nbsp;            } else {</b>
<b class="nc">&nbsp;                throw new UnsupportedOperationException();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            switch (operator) {</b>
&nbsp;                case LT:
<b class="nc">&nbsp;                    return cmp &lt; 0;</b>
&nbsp;                case LE:
<b class="nc">&nbsp;                    return cmp &lt;= 0;</b>
&nbsp;                case EQ:
<b class="nc">&nbsp;                    return cmp == 0;</b>
&nbsp;                case NE:
<b class="nc">&nbsp;                    return cmp != 0;</b>
&nbsp;                case GT:
<b class="nc">&nbsp;                    return cmp &gt; 0;</b>
&nbsp;                case GE:
<b class="nc">&nbsp;                    return cmp &gt;= 0;</b>
&nbsp;                default:
<b class="nc">&nbsp;                    throw new UnsupportedOperationException();</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void set(JSONPath.Context context, Object value) {
<b class="nc">&nbsp;            Object object = context.parent == null</b>
&nbsp;                    ? context.root
&nbsp;                    : context.parent.value;
&nbsp;
<b class="nc">&nbsp;            if (object instanceof List) {</b>
<b class="nc">&nbsp;                List list = (List) object;</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; list.size(); i++) {</b>
<b class="nc">&nbsp;                    Object item = list.get(i);</b>
<b class="nc">&nbsp;                    if (apply(context, item)) {</b>
<b class="nc">&nbsp;                        list.set(i, value);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            throw new JSONException(&quot;UnsupportedOperation &quot;);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameDecimalOpSegment
&nbsp;            extends NameFilter {
&nbsp;        final Operator operator;
&nbsp;        final BigDecimal value;
&nbsp;
&nbsp;        public NameDecimalOpSegment(String name, long nameHashCode, Operator operator, BigDecimal value) {
<b class="nc">&nbsp;            super(name, nameHashCode);</b>
<b class="nc">&nbsp;            this.operator = operator;</b>
<b class="nc">&nbsp;            this.value = value;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            if (fieldValue == null) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;
&nbsp;            BigDecimal fieldValueDecimal;
&nbsp;
<b class="nc">&nbsp;            if (fieldValue instanceof Boolean) {</b>
<b class="nc">&nbsp;                fieldValueDecimal = (Boolean) fieldValue ? BigDecimal.ONE : BigDecimal.ZERO;</b>
<b class="nc">&nbsp;            } else if (fieldValue instanceof Byte</b>
&nbsp;                    || fieldValue instanceof Short
&nbsp;                    || fieldValue instanceof Integer
&nbsp;                    || fieldValue instanceof Long) {
<b class="nc">&nbsp;                fieldValueDecimal = BigDecimal.valueOf(</b>
<b class="nc">&nbsp;                        ((Number) fieldValue).longValue()</b>
&nbsp;                );
<b class="nc">&nbsp;            } else if (fieldValue instanceof BigDecimal) {</b>
<b class="nc">&nbsp;                fieldValueDecimal = ((BigDecimal) fieldValue);</b>
<b class="nc">&nbsp;            } else if (fieldValue instanceof BigInteger) {</b>
<b class="nc">&nbsp;                fieldValueDecimal = new BigDecimal((BigInteger) fieldValue);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                throw new UnsupportedOperationException();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            int cmp = fieldValueDecimal.compareTo(value);</b>
<b class="nc">&nbsp;            switch (operator) {</b>
&nbsp;                case LT:
<b class="nc">&nbsp;                    return cmp &lt; 0;</b>
&nbsp;                case LE:
<b class="nc">&nbsp;                    return cmp &lt;= 0;</b>
&nbsp;                case EQ:
<b class="nc">&nbsp;                    return cmp == 0;</b>
&nbsp;                case NE:
<b class="nc">&nbsp;                    return cmp != 0;</b>
&nbsp;                case GT:
<b class="nc">&nbsp;                    return cmp &gt; 0;</b>
&nbsp;                case GE:
<b class="nc">&nbsp;                    return cmp &gt;= 0;</b>
&nbsp;                default:
<b class="nc">&nbsp;                    throw new UnsupportedOperationException();</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameRLikeSegment
&nbsp;            extends NameFilter {
&nbsp;        final Pattern pattern;
&nbsp;        final boolean not;
&nbsp;
&nbsp;        public NameRLikeSegment(String fieldName, long fieldNameNameHash, Pattern pattern, boolean not) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash);</b>
<b class="nc">&nbsp;            this.pattern = pattern;</b>
<b class="nc">&nbsp;            this.not = not;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            String strPropertyValue = fieldValue.toString();</b>
<b class="nc">&nbsp;            Matcher m = pattern.matcher(strPropertyValue);</b>
<b class="nc">&nbsp;            boolean match = m.matches();</b>
&nbsp;
<b class="nc">&nbsp;            if (not) {</b>
<b class="nc">&nbsp;                match = !match;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return match;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class StartsWithSegment
&nbsp;            extends NameFilter {
&nbsp;        final String prefix;
&nbsp;
&nbsp;        public StartsWithSegment(String fieldName, long fieldNameNameHash, String prefix) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash);</b>
<b class="nc">&nbsp;            this.prefix = prefix;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            String propertyValue = fieldValue.toString();</b>
<b class="nc">&nbsp;            return propertyValue != null &amp;&amp; propertyValue.startsWith(prefix);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class EndsWithSegment
&nbsp;            extends NameFilter {
&nbsp;        final String prefix;
&nbsp;
&nbsp;        public EndsWithSegment(String fieldName, long fieldNameNameHash, String prefix) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash);</b>
<b class="nc">&nbsp;            this.prefix = prefix;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            String propertyValue = fieldValue.toString();</b>
<b class="nc">&nbsp;            return propertyValue != null &amp;&amp; propertyValue.endsWith(prefix);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class GroupFilter
&nbsp;            extends JSONPathSegment
&nbsp;            implements EvalSegment {
&nbsp;        final boolean and;
&nbsp;        final List&lt;JSONPathFilter&gt; filters;
&nbsp;
<b class="nc">&nbsp;        public GroupFilter(List&lt;JSONPathFilter&gt; filters, boolean and) {</b>
<b class="nc">&nbsp;            this.and = and;</b>
<b class="nc">&nbsp;            this.filters = filters;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void accept(JSONReader jsonReader, JSONPath.Context context) {
<b class="nc">&nbsp;            if (context.parent == null) {</b>
<b class="nc">&nbsp;                context.root = jsonReader.readAny();</b>
&nbsp;            }
<b class="nc">&nbsp;            eval(context);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void eval(JSONPath.Context context) {
<b class="nc">&nbsp;            Object object = context.parent == null</b>
&nbsp;                    ? context.root
&nbsp;                    : context.parent.value;
&nbsp;
<b class="nc">&nbsp;            if (object instanceof List) {</b>
<b class="nc">&nbsp;                List list = (List) object;</b>
<b class="nc">&nbsp;                JSONArray array = new JSONArray(list.size());</b>
<b class="nc">&nbsp;                for (int i = 0, l = list.size(); i &lt; l; i++) {</b>
<b class="nc">&nbsp;                    Object item = list.get(i);</b>
<b class="nc">&nbsp;                    boolean match = and;</b>
<b class="nc">&nbsp;                    for (JSONPathFilter filter : filters) {</b>
<b class="nc">&nbsp;                        boolean result = filter.apply(context, item);</b>
<b class="nc">&nbsp;                        if (and) {</b>
<b class="nc">&nbsp;                            if (!result) {</b>
<b class="nc">&nbsp;                                match = false;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        } else {
<b class="nc">&nbsp;                            if (result) {</b>
<b class="nc">&nbsp;                                match = true;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
<b class="nc">&nbsp;                    }</b>
<b class="nc">&nbsp;                    if (match) {</b>
<b class="nc">&nbsp;                        array.add(item);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                context.value = array;</b>
<b class="nc">&nbsp;                context.eval = true;</b>
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            boolean match = and;</b>
<b class="nc">&nbsp;            for (JSONPathFilter filter : filters) {</b>
<b class="nc">&nbsp;                boolean result = filter.apply(context, object);</b>
<b class="nc">&nbsp;                if (and) {</b>
<b class="nc">&nbsp;                    if (!result) {</b>
<b class="nc">&nbsp;                        match = false;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    }
&nbsp;                } else {
<b class="nc">&nbsp;                    if (result) {</b>
<b class="nc">&nbsp;                        match = true;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            if (match) {</b>
<b class="nc">&nbsp;                context.value = object;</b>
&nbsp;            }
<b class="nc">&nbsp;            context.eval = true;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    abstract static class NameFilter
&nbsp;            extends JSONPathFilter {
&nbsp;        final String fieldName;
&nbsp;        final long fieldNameNameHash;
&nbsp;
&nbsp;        final String[] fieldName2;
&nbsp;        final long[] fieldNameNameHash2;
&nbsp;
&nbsp;        final Function function;
&nbsp;
<b class="nc">&nbsp;        public NameFilter(String fieldName, long fieldNameNameHash) {</b>
<b class="nc">&nbsp;            this.fieldName = fieldName;</b>
<b class="nc">&nbsp;            this.fieldNameNameHash = fieldNameNameHash;</b>
<b class="nc">&nbsp;            this.fieldName2 = null;</b>
<b class="nc">&nbsp;            this.fieldNameNameHash2 = null;</b>
<b class="nc">&nbsp;            this.function = null;</b>
&nbsp;        }
&nbsp;
&nbsp;        public NameFilter(String fieldName,
&nbsp;                          long fieldNameNameHash,
&nbsp;                          String[] fieldName2,
&nbsp;                          long[] fieldNameNameHash2,
<b class="nc">&nbsp;                          Function function) {</b>
<b class="nc">&nbsp;            this.fieldName = fieldName;</b>
<b class="nc">&nbsp;            this.fieldNameNameHash = fieldNameNameHash;</b>
<b class="nc">&nbsp;            this.fieldName2 = fieldName2;</b>
<b class="nc">&nbsp;            this.fieldNameNameHash2 = fieldNameNameHash2;</b>
<b class="nc">&nbsp;            this.function = function;</b>
&nbsp;        }
&nbsp;
&nbsp;        abstract boolean apply(Object fieldValue);
&nbsp;
&nbsp;        @Override
&nbsp;        public final void accept(JSONReader jsonReader, JSONPath.Context context) {
<b class="nc">&nbsp;            if (context.parent == null) {</b>
<b class="nc">&nbsp;                context.root = jsonReader.readAny();</b>
&nbsp;            }
<b class="nc">&nbsp;            eval(context);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean remove(JSONPath.Context context) {
<b class="nc">&nbsp;            Object object = context.parent == null</b>
&nbsp;                    ? context.root
&nbsp;                    : context.parent.value;
&nbsp;
<b class="nc">&nbsp;            if (object instanceof List) {</b>
<b class="nc">&nbsp;                List list = (List) object;</b>
<b class="nc">&nbsp;                for (int i = list.size() - 1; i &gt;= 0; i--) {</b>
<b class="nc">&nbsp;                    Object item = list.get(i);</b>
<b class="nc">&nbsp;                    if (apply(context, item)) {</b>
<b class="nc">&nbsp;                        list.remove(i);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            throw new JSONException(&quot;UnsupportedOperation &quot; + getClass());</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public final void eval(JSONPath.Context context) {
<b class="nc">&nbsp;            Object object = context.parent == null</b>
&nbsp;                    ? context.root
&nbsp;                    : context.parent.value;
&nbsp;
<b class="nc">&nbsp;            if (object instanceof List) {</b>
<b class="nc">&nbsp;                List list = (List) object;</b>
<b class="nc">&nbsp;                JSONArray array = new JSONArray(list.size());</b>
<b class="nc">&nbsp;                for (int i = 0, l = list.size(); i &lt; l; i++) {</b>
<b class="nc">&nbsp;                    Object item = list.get(i);</b>
<b class="nc">&nbsp;                    if (apply(context, item)) {</b>
<b class="nc">&nbsp;                        array.add(item);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                context.value = array;</b>
<b class="nc">&nbsp;                context.eval = true;</b>
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (object instanceof Object[]) {</b>
<b class="nc">&nbsp;                Object[] list = (Object[]) object;</b>
<b class="nc">&nbsp;                JSONArray array = new JSONArray(list.length);</b>
<b class="nc">&nbsp;                for (Object item : list) {</b>
<b class="nc">&nbsp;                    if (apply(context, item)) {</b>
<b class="nc">&nbsp;                        array.add(item);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                context.value = array;</b>
<b class="nc">&nbsp;                context.eval = true;</b>
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (object instanceof JSONPath.Sequence) {</b>
<b class="nc">&nbsp;                JSONPath.Sequence sequence = (JSONPath.Sequence) object;</b>
<b class="nc">&nbsp;                JSONArray array = new JSONArray();</b>
<b class="nc">&nbsp;                for (Object value : sequence.values) {</b>
<b class="nc">&nbsp;                    if (value instanceof Collection) {</b>
<b class="nc">&nbsp;                        for (Object valueItem : ((Collection&lt;?&gt;) value)) {</b>
<b class="nc">&nbsp;                            if (apply(context, valueItem)) {</b>
<b class="nc">&nbsp;                                array.add(valueItem);</b>
&nbsp;                            }
<b class="nc">&nbsp;                        }</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (apply(context, value)) {</b>
<b class="nc">&nbsp;                            array.add(value);</b>
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                }</b>
<b class="nc">&nbsp;                context.value = array;</b>
<b class="nc">&nbsp;                context.eval = true;</b>
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (apply(context, object)) {</b>
<b class="nc">&nbsp;                context.value = object;</b>
<b class="nc">&nbsp;                context.eval = true;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public final boolean apply(JSONPath.Context context, Object object) {
<b class="nc">&nbsp;            if (object == null) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            JSONWriter.Context writerContext = context.path.getWriterContext();</b>
&nbsp;
<b class="nc">&nbsp;            if (object instanceof Map) {</b>
<b class="nc">&nbsp;                Object fieldValue = fieldName == null ? object : ((Map&lt;?, ?&gt;) object).get(fieldName);</b>
<b class="nc">&nbsp;                if (fieldValue == null) {</b>
<b class="nc">&nbsp;                    return false;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (fieldName2 != null) {</b>
<b class="nc">&nbsp;                    for (int i = 0; i &lt; fieldName2.length; i++) {</b>
<b class="nc">&nbsp;                        String name = fieldName2[i];</b>
<b class="nc">&nbsp;                        if (fieldValue instanceof Map) {</b>
<b class="nc">&nbsp;                            fieldValue = ((Map) fieldValue).get(name);</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            ObjectWriter objectWriter2 = writerContext.getObjectWriter(fieldValue.getClass());</b>
<b class="nc">&nbsp;                            if (objectWriter2 instanceof ObjectWriterAdapter) {</b>
<b class="nc">&nbsp;                                FieldWriter fieldWriter2 = objectWriter2.getFieldWriter(fieldNameNameHash2[i]);</b>
<b class="nc">&nbsp;                                if (fieldWriter2 == null) {</b>
<b class="nc">&nbsp;                                    return false;</b>
&nbsp;                                }
<b class="nc">&nbsp;                                fieldValue = fieldWriter2.getFieldValue(fieldValue);</b>
<b class="nc">&nbsp;                            } else {</b>
<b class="nc">&nbsp;                                return false;</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        if (fieldValue == null) {</b>
<b class="nc">&nbsp;                            return false;</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (function != null) {</b>
<b class="nc">&nbsp;                    fieldValue = function.apply(fieldValue);</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return apply(fieldValue);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            ObjectWriter objectWriter = writerContext.getObjectWriter(object.getClass());</b>
<b class="nc">&nbsp;            if (objectWriter instanceof ObjectWriterAdapter) {</b>
<b class="nc">&nbsp;                FieldWriter fieldWriter = objectWriter.getFieldWriter(fieldNameNameHash);</b>
<b class="nc">&nbsp;                Object fieldValue = fieldWriter.getFieldValue(object);</b>
&nbsp;
<b class="nc">&nbsp;                if (fieldValue == null) {</b>
<b class="nc">&nbsp;                    return false;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (fieldName2 != null) {</b>
<b class="nc">&nbsp;                    for (int i = 0; i &lt; fieldName2.length; i++) {</b>
<b class="nc">&nbsp;                        String name = fieldName2[i];</b>
<b class="nc">&nbsp;                        if (fieldValue instanceof Map) {</b>
<b class="nc">&nbsp;                            fieldValue = ((Map) fieldValue).get(name);</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            ObjectWriter objectWriter2 = writerContext.getObjectWriter(fieldValue.getClass());</b>
<b class="nc">&nbsp;                            if (objectWriter2 instanceof ObjectWriterAdapter) {</b>
<b class="nc">&nbsp;                                FieldWriter fieldWriter2 = objectWriter2.getFieldWriter(fieldNameNameHash2[i]);</b>
<b class="nc">&nbsp;                                if (fieldWriter2 == null) {</b>
<b class="nc">&nbsp;                                    return false;</b>
&nbsp;                                }
<b class="nc">&nbsp;                                fieldValue = fieldWriter2.getFieldValue(fieldValue);</b>
<b class="nc">&nbsp;                            } else {</b>
<b class="nc">&nbsp;                                return false;</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        if (fieldValue == null) {</b>
<b class="nc">&nbsp;                            return false;</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (function != null) {</b>
<b class="nc">&nbsp;                    fieldValue = function.apply(fieldValue);</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return apply(fieldValue);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (function != null) {</b>
<b class="nc">&nbsp;                Object fieldValue = function.apply(object);</b>
<b class="nc">&nbsp;                return apply(fieldValue);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldName == null) {</b>
<b class="nc">&nbsp;                return apply(object);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameStringOpSegment
&nbsp;            extends NameFilter {
&nbsp;        final Operator operator;
&nbsp;        final String value;
&nbsp;
&nbsp;        public NameStringOpSegment(
&nbsp;                String fieldName,
&nbsp;                long fieldNameNameHash,
&nbsp;                String[] fieldName2,
&nbsp;                long[] fieldNameNameHash2,
&nbsp;                Function expr,
&nbsp;                Operator operator,
&nbsp;                String value
&nbsp;        ) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash, fieldName2, fieldNameNameHash2, expr);</b>
<b class="nc">&nbsp;            this.operator = operator;</b>
<b class="nc">&nbsp;            this.value = value;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            if (!(fieldValue instanceof String)) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            int cmp = ((String) fieldValue).compareTo(this.value);</b>
&nbsp;
<b class="nc">&nbsp;            switch (operator) {</b>
&nbsp;                case LT:
<b class="nc">&nbsp;                    return cmp &lt; 0;</b>
&nbsp;                case LE:
<b class="nc">&nbsp;                    return cmp &lt;= 0;</b>
&nbsp;                case EQ:
<b class="nc">&nbsp;                    return cmp == 0;</b>
&nbsp;                case NE:
<b class="nc">&nbsp;                    return cmp != 0;</b>
&nbsp;                case GT:
<b class="nc">&nbsp;                    return cmp &gt; 0;</b>
&nbsp;                case GE:
<b class="nc">&nbsp;                    return cmp &gt;= 0;</b>
&nbsp;                default:
<b class="nc">&nbsp;                    throw new UnsupportedOperationException();</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameArrayOpSegment
&nbsp;            extends NameFilter {
&nbsp;        final Operator operator;
&nbsp;        final JSONArray array;
&nbsp;
&nbsp;        public NameArrayOpSegment(
&nbsp;                String fieldName,
&nbsp;                long fieldNameNameHash,
&nbsp;                String[] fieldName2,
&nbsp;                long[] fieldNameNameHash2,
&nbsp;                Function function,
&nbsp;                Operator operator,
&nbsp;                JSONArray array
&nbsp;        ) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash, fieldName2, fieldNameNameHash2, function);</b>
<b class="nc">&nbsp;            this.operator = operator;</b>
<b class="nc">&nbsp;            this.array = array;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            switch (operator) {</b>
&nbsp;                case EQ:
<b class="nc">&nbsp;                    return array.equals(fieldValue);</b>
&nbsp;                default:
<b class="nc">&nbsp;                    throw new JSONException(&quot;not support operator : &quot; + operator);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameObjectOpSegment
&nbsp;            extends NameFilter {
&nbsp;        final Operator operator;
&nbsp;        final JSONObject object;
&nbsp;
&nbsp;        public NameObjectOpSegment(
&nbsp;                String fieldName,
&nbsp;                long fieldNameNameHash,
&nbsp;                String[] fieldName2,
&nbsp;                long[] fieldNameNameHash2,
&nbsp;                Function function,
&nbsp;                Operator operator,
&nbsp;                JSONObject object) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash, fieldName2, fieldNameNameHash2, function);</b>
<b class="nc">&nbsp;            this.operator = operator;</b>
<b class="nc">&nbsp;            this.object = object;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            switch (operator) {</b>
&nbsp;                case EQ:
<b class="nc">&nbsp;                    return object.equals(fieldValue);</b>
&nbsp;                default:
<b class="nc">&nbsp;                    throw new JSONException(&quot;not support operator : &quot; + operator);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameStringInSegment
&nbsp;            extends NameFilter {
&nbsp;        private final String[] values;
&nbsp;        private final boolean not;
&nbsp;
&nbsp;        public NameStringInSegment(String fieldName, long fieldNameNameHash, String[] values, boolean not) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash);</b>
<b class="nc">&nbsp;            this.values = values;</b>
<b class="nc">&nbsp;            this.not = not;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            for (String value : values) {</b>
<b class="nc">&nbsp;                if (value == fieldValue) {</b>
<b class="nc">&nbsp;                    return !not;</b>
<b class="nc">&nbsp;                } else if (value != null &amp;&amp; value.equals(fieldValue)) {</b>
<b class="nc">&nbsp;                    return !not;</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return not;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameStringContainsSegment
&nbsp;            extends NameFilter {
&nbsp;        private final String[] values;
&nbsp;        private final boolean not;
&nbsp;
&nbsp;        public NameStringContainsSegment(
&nbsp;                String fieldName,
&nbsp;                long fieldNameNameHash,
&nbsp;                String[] fieldName2,
&nbsp;                long[] fieldNameNameHash2,
&nbsp;                String[] values, boolean not) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash, fieldName2, fieldNameNameHash2, null);</b>
<b class="nc">&nbsp;            this.values = values;</b>
<b class="nc">&nbsp;            this.not = not;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            if (fieldValue instanceof Collection) {</b>
<b class="nc">&nbsp;                Collection collection = (Collection) fieldValue;</b>
&nbsp;
<b class="nc">&nbsp;                boolean containsAll = true;</b>
<b class="nc">&nbsp;                for (String value : values) {</b>
<b class="nc">&nbsp;                    if (!collection.contains(value)) {</b>
<b class="nc">&nbsp;                        containsAll = false;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (containsAll) {</b>
<b class="nc">&nbsp;                    return !not;</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return not;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameMatchFilter
&nbsp;            extends NameFilter {
&nbsp;        final String startsWithValue;
&nbsp;        final String endsWithValue;
&nbsp;        final String[] containsValues;
&nbsp;        final int minLength;
&nbsp;        final boolean not;
&nbsp;
&nbsp;        public NameMatchFilter(
&nbsp;                String fieldName,
&nbsp;                long fieldNameNameHash,
&nbsp;                String startsWithValue,
&nbsp;                String endsWithValue,
&nbsp;                String[] containsValues,
&nbsp;                boolean not) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash);</b>
<b class="nc">&nbsp;            this.startsWithValue = startsWithValue;</b>
<b class="nc">&nbsp;            this.endsWithValue = endsWithValue;</b>
<b class="nc">&nbsp;            this.containsValues = containsValues;</b>
<b class="nc">&nbsp;            this.not = not;</b>
&nbsp;
<b class="nc">&nbsp;            int len = 0;</b>
<b class="nc">&nbsp;            if (startsWithValue != null) {</b>
<b class="nc">&nbsp;                len += startsWithValue.length();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (endsWithValue != null) {</b>
<b class="nc">&nbsp;                len += endsWithValue.length();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (containsValues != null) {</b>
<b class="nc">&nbsp;                for (String item : containsValues) {</b>
<b class="nc">&nbsp;                    len += item.length();</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            this.minLength = len;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        boolean apply(Object arg) {
<b class="nc">&nbsp;            if (!(arg instanceof String)) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            String fieldValue = (String) arg;</b>
<b class="nc">&nbsp;            if (fieldValue.length() &lt; minLength) {</b>
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            int start = 0;</b>
<b class="nc">&nbsp;            if (startsWithValue != null) {</b>
<b class="nc">&nbsp;                if (!fieldValue.startsWith(startsWithValue)) {</b>
<b class="nc">&nbsp;                    return not;</b>
&nbsp;                }
<b class="nc">&nbsp;                start += startsWithValue.length();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (containsValues != null) {</b>
<b class="nc">&nbsp;                for (String containsValue : containsValues) {</b>
<b class="nc">&nbsp;                    int index = fieldValue.indexOf(containsValue, start);</b>
<b class="nc">&nbsp;                    if (index == -1) {</b>
<b class="nc">&nbsp;                        return not;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    start = index + containsValue.length();</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (endsWithValue != null) {</b>
<b class="nc">&nbsp;                if (!fieldValue.endsWith(endsWithValue)) {</b>
<b class="nc">&nbsp;                    return not;</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return !not;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameExistsFilter
&nbsp;            extends JSONPathFilter {
&nbsp;        final String name;
&nbsp;        final long nameHashCode;
&nbsp;
<b class="nc">&nbsp;        public NameExistsFilter(String name, long nameHashCode) {</b>
<b class="nc">&nbsp;            this.name = name;</b>
<b class="nc">&nbsp;            this.nameHashCode = nameHashCode;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void eval(JSONPath.Context context) {
<b class="nc">&nbsp;            Object object = context.parent == null</b>
&nbsp;                    ? context.root
&nbsp;                    : context.parent.value;
&nbsp;
<b class="nc">&nbsp;            JSONArray array = new JSONArray();</b>
<b class="nc">&nbsp;            if (object instanceof List) {</b>
<b class="nc">&nbsp;                List list = (List) object;</b>
<b class="nc">&nbsp;                for (int i = 0, l = list.size(); i &lt; l; i++) {</b>
<b class="nc">&nbsp;                    Object item = list.get(i);</b>
<b class="nc">&nbsp;                    if (item instanceof Map) {</b>
<b class="nc">&nbsp;                        if (((Map) item).containsKey(name)) {</b>
<b class="nc">&nbsp;                            array.add(item);</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                context.value = array;</b>
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (object instanceof Map) {</b>
<b class="nc">&nbsp;                Map map = (Map) object;</b>
<b class="nc">&nbsp;                Object value = map.get(name);</b>
<b class="nc">&nbsp;                context.value = value != null ? object : null;</b>
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (object instanceof JSONPath.Sequence) {</b>
<b class="nc">&nbsp;                List list = ((JSONPath.Sequence) object).values;</b>
<b class="nc">&nbsp;                for (int i = 0, l = list.size(); i &lt; l; i++) {</b>
<b class="nc">&nbsp;                    Object item = list.get(i);</b>
<b class="nc">&nbsp;                    if (item instanceof Map) {</b>
<b class="nc">&nbsp;                        if (((Map) item).containsKey(name)) {</b>
<b class="nc">&nbsp;                            array.add(item);</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                context.value = new JSONPath.Sequence(array);</b>
&nbsp;                return;
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            throw new UnsupportedOperationException();</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void accept(JSONReader jsonReader, JSONPath.Context context) {
<b class="nc">&nbsp;            eval(context);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public String toString() {
<b class="nc">&nbsp;            return &#39;?&#39; + name;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(JSONPath.Context context, Object object) {
<b class="nc">&nbsp;            throw new UnsupportedOperationException();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameIntBetweenSegment
&nbsp;            extends NameFilter {
&nbsp;        private final long begin;
&nbsp;        private final long end;
&nbsp;        private final boolean not;
&nbsp;
&nbsp;        public NameIntBetweenSegment(String fieldName, long fieldNameNameHash, long begin, long end, boolean not) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash);</b>
<b class="nc">&nbsp;            this.begin = begin;</b>
<b class="nc">&nbsp;            this.end = end;</b>
<b class="nc">&nbsp;            this.not = not;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            if (fieldValue instanceof Byte</b>
&nbsp;                    || fieldValue instanceof Short
&nbsp;                    || fieldValue instanceof Integer
&nbsp;                    || fieldValue instanceof Long
&nbsp;            ) {
<b class="nc">&nbsp;                long fieldValueLong = ((Number) fieldValue).longValue();</b>
&nbsp;
<b class="nc">&nbsp;                if (fieldValueLong &gt;= begin &amp;&amp; fieldValueLong &lt;= end) {</b>
<b class="nc">&nbsp;                    return !not;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldValue instanceof Float</b>
&nbsp;                    || fieldValue instanceof Double
&nbsp;            ) {
<b class="nc">&nbsp;                double fieldValueDouble = ((Number) fieldValue).doubleValue();</b>
&nbsp;
<b class="nc">&nbsp;                if (fieldValueDouble &gt;= begin &amp;&amp; fieldValueDouble &lt;= end) {</b>
<b class="nc">&nbsp;                    return !not;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldValue instanceof BigDecimal) {</b>
<b class="nc">&nbsp;                BigDecimal decimal = (BigDecimal) fieldValue;</b>
<b class="nc">&nbsp;                int cmpBegin = decimal.compareTo(BigDecimal.valueOf(begin));</b>
<b class="nc">&nbsp;                int cmpEnd = decimal.compareTo(BigDecimal.valueOf(end));</b>
&nbsp;
<b class="nc">&nbsp;                if (cmpBegin &gt;= 0 &amp;&amp; cmpEnd &lt;= 0) {</b>
<b class="nc">&nbsp;                    return !not;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldValue instanceof BigInteger) {</b>
<b class="nc">&nbsp;                BigInteger bigInt = (BigInteger) fieldValue;</b>
<b class="nc">&nbsp;                int cmpBegin = bigInt.compareTo(BigInteger.valueOf(begin));</b>
<b class="nc">&nbsp;                int cmpEnd = bigInt.compareTo(BigInteger.valueOf(end));</b>
&nbsp;
<b class="nc">&nbsp;                if (cmpBegin &gt;= 0 &amp;&amp; cmpEnd &lt;= 0) {</b>
<b class="nc">&nbsp;                    return !not;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return not;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameLongContainsSegment
&nbsp;            extends NameFilter {
&nbsp;        private final long[] values;
&nbsp;        private final boolean not;
&nbsp;
&nbsp;        public NameLongContainsSegment(
&nbsp;                String fieldName,
&nbsp;                long fieldNameNameHash,
&nbsp;                String[] fieldName2,
&nbsp;                long[] fieldNameNameHash2,
&nbsp;                long[] values, boolean not) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash, fieldName2, fieldNameNameHash2, null);</b>
<b class="nc">&nbsp;            this.values = values;</b>
<b class="nc">&nbsp;            this.not = not;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            if (fieldValue instanceof Collection) {</b>
<b class="nc">&nbsp;                Collection collection = (Collection) fieldValue;</b>
&nbsp;
<b class="nc">&nbsp;                boolean containsAll = true;</b>
<b class="nc">&nbsp;                for (long value : values) {</b>
<b class="nc">&nbsp;                    boolean containsItem = false;</b>
<b class="nc">&nbsp;                    for (Object item : collection) {</b>
&nbsp;                        long longItem;
<b class="nc">&nbsp;                        if (item instanceof Byte</b>
&nbsp;                                || item instanceof Short
&nbsp;                                || item instanceof Integer
&nbsp;                                || item instanceof Long) {
<b class="nc">&nbsp;                            longItem = ((Number) item).longValue();</b>
<b class="nc">&nbsp;                            if (longItem == value) {</b>
<b class="nc">&nbsp;                                containsItem = true;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        if (item instanceof Float) {</b>
<b class="nc">&nbsp;                            if (value == (Float) item) {</b>
<b class="nc">&nbsp;                                containsItem = true;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        if (item instanceof Double) {</b>
<b class="nc">&nbsp;                            if (value == (Double) item) {</b>
<b class="nc">&nbsp;                                containsItem = true;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        if (item instanceof BigDecimal) {</b>
<b class="nc">&nbsp;                            BigDecimal decimal = (BigDecimal) item;</b>
<b class="nc">&nbsp;                            long longValue = decimal.longValue();</b>
<b class="nc">&nbsp;                            if (value == longValue &amp;&amp; decimal.equals(BigDecimal.valueOf(value))) {</b>
<b class="nc">&nbsp;                                containsItem = true;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;
<b class="nc">&nbsp;                        if (item instanceof BigInteger) {</b>
<b class="nc">&nbsp;                            BigInteger bigiInt = (BigInteger) item;</b>
<b class="nc">&nbsp;                            long longValue = bigiInt.longValue();</b>
<b class="nc">&nbsp;                            if (value == longValue &amp;&amp; bigiInt.equals(BigInteger.valueOf(value))) {</b>
<b class="nc">&nbsp;                                containsItem = true;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
<b class="nc">&nbsp;                    }</b>
&nbsp;
<b class="nc">&nbsp;                    if (!containsItem) {</b>
<b class="nc">&nbsp;                        containsAll = false;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (containsAll) {</b>
<b class="nc">&nbsp;                    return !not;</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return not;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static final class NameIntInSegment
&nbsp;            extends NameFilter {
&nbsp;        private final long[] values;
&nbsp;        private final boolean not;
&nbsp;
&nbsp;        public NameIntInSegment(
&nbsp;                String fieldName,
&nbsp;                long fieldNameNameHash,
&nbsp;                String[] fieldName2,
&nbsp;                long[] fieldNameNameHash2,
&nbsp;                Function expr,
&nbsp;                long[] values,
&nbsp;                boolean not) {
<b class="nc">&nbsp;            super(fieldName, fieldNameNameHash, fieldName2, fieldNameNameHash2, expr);</b>
<b class="nc">&nbsp;            this.values = values;</b>
<b class="nc">&nbsp;            this.not = not;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean apply(Object fieldValue) {
<b class="nc">&nbsp;            if (fieldValue instanceof Byte</b>
&nbsp;                    || fieldValue instanceof Short
&nbsp;                    || fieldValue instanceof Integer
&nbsp;                    || fieldValue instanceof Long
&nbsp;            ) {
<b class="nc">&nbsp;                long fieldValueLong = ((Number) fieldValue).longValue();</b>
&nbsp;
<b class="nc">&nbsp;                for (long value : values) {</b>
<b class="nc">&nbsp;                    if (value == fieldValueLong) {</b>
<b class="nc">&nbsp;                        return !not;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldValue instanceof Float</b>
&nbsp;                    || fieldValue instanceof Double
&nbsp;            ) {
<b class="nc">&nbsp;                double fieldValueDouble = ((Number) fieldValue).doubleValue();</b>
&nbsp;
<b class="nc">&nbsp;                for (long value : values) {</b>
<b class="nc">&nbsp;                    if (value == fieldValueDouble) {</b>
<b class="nc">&nbsp;                        return !not;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldValue instanceof BigDecimal) {</b>
<b class="nc">&nbsp;                BigDecimal decimal = (BigDecimal) fieldValue;</b>
<b class="nc">&nbsp;                long longValue = decimal.longValue();</b>
<b class="nc">&nbsp;                for (long value : values) {</b>
<b class="nc">&nbsp;                    if (value == longValue &amp;&amp; decimal.equals(BigDecimal.valueOf(value))) {</b>
<b class="nc">&nbsp;                        return !not;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (fieldValue instanceof BigInteger) {</b>
<b class="nc">&nbsp;                BigInteger bigiInt = (BigInteger) fieldValue;</b>
<b class="nc">&nbsp;                long longValue = bigiInt.longValue();</b>
<b class="nc">&nbsp;                for (long value : values) {</b>
<b class="nc">&nbsp;                    if (value == longValue &amp;&amp; bigiInt.equals(BigInteger.valueOf(value))) {</b>
<b class="nc">&nbsp;                        return !not;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return not;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            return not;</b>
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-04-09 22:02</div>
</div>
</body>
</html>
