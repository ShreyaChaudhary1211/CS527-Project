[]
[<Line: -package de.charite.compbio.jannovar.cmd.db_list;
>, <Line: -import java.io.PrintWriter;
>, <Line: -import org.apache.commons.cli.CommandLine;
>, <Line: -import org.apache.commons.cli.HelpFormatter;
>, <Line: -import org.apache.commons.cli.Option;
>, <Line: -import org.apache.commons.cli.Options;
>, <Line: -import org.apache.commons.cli.ParseException;
>, <Line: -import org.apache.commons.cli.DefaultParser;
>, <Line: -import com.google.common.collect.ImmutableList;
>, <Line: -import de.charite.compbio.jannovar.JannovarOptions;
>, <Line: -import de.charite.compbio.jannovar.cmd.HelpRequestedException;
>, <Line: -public class DatabaseListCommandLineParser {
>, <Line: -	/** options representation for the Apache commons command line parser */
>, <Line: -	protected Options options;
>, <Line: -	/** the Apache commons command line parser */
>, <Line: -	protected DefaultParser parser;
>, <Line: -	/**
>, <Line: -	 * Calls initializeParser().
>, <Line: -	 */
>, <Line: -	public DatabaseListCommandLineParser() {
>, <Line: -		initializeParser();
>, <Line: -	}
>, <Line: -	/**
>, <Line: -	 * Initialize {@link #parser} and {@link #options}.
>, <Line: -	 */
>, <Line: -	private void initializeParser() {
>, <Line: -		options = new Options();
>, <Line: -		options.addOption(Option.builder("h").desc("show this help").longOpt("help").build());
>, <Line: -		options.addOption(Option.builder("s").desc("INI file with data source list").numberOfArgs(1)
>, <Line: -				.longOpt("data-source-list").build());
>, <Line: -		parser = new DefaultParser();
>, <Line: -	}
>, <Line: -	/**
>, <Line: -	 * Parse the command line and
>, <Line: -	 *
>, <Line: -	 * @throws ParseException
>, <Line: -	 *             on problems with the command line
>, <Line: -	 * @throws HelpRequestedException
>, <Line: -	 *             if the user requested help on the command line
>, <Line: -	 */
>, <Line: -	public JannovarOptions parse(String argv[]) throws ParseException, HelpRequestedException {
>, <Line: -		// Parse the command line.
>, <Line: -		CommandLine cmd = parser.parse(options, argv);
>, <Line: -		// Fill the resulting JannovarOptions.
>, <Line: -		JannovarOptions result = new JannovarOptions();
>, <Line: -		result.printProgressBars = true;
>, <Line: -		result.command = JannovarOptions.Command.DB_LIST;
>, <Line: -		if (cmd.hasOption("verbose"))
>, <Line: -			result.verbosity = 2;
>, <Line: -		if (cmd.hasOption("very-verbose"))
>, <Line: -			result.verbosity = 3;
>, <Line: -		if (cmd.hasOption("help")) {
>, <Line: -			printHelp();
>, <Line: -			throw new HelpRequestedException();
>, <Line: -		}
>, <Line: -		// Get data source (INI) file paths.
>, <Line: -		ImmutableList.Builder<String> dsfBuilder = new ImmutableList.Builder<String>();
>, <Line: -		String[] dataSourceLists = cmd.getOptionValues("data-source-list");
>, <Line: -		if (dataSourceLists != null)
>, <Line: -			for (int i = 0; i < dataSourceLists.length; ++i)
>, <Line: -				dsfBuilder.add(dataSourceLists[i]);
>, <Line: -		dsfBuilder.add("bundle:///default_sources.ini");
>, <Line: -		result.dataSourceFiles = dsfBuilder.build();
>, <Line: -		return result;
>, <Line: -	}
>, <Line: -	private void printHelp() {
>, <Line: -		final String HEADER = new StringBuilder().append("Jannovar Command: db-list\n\n")
>, <Line: -				.append("Use this command to list known downloadable database names\n\n")
>, <Line: -				.append("Usage: java -jar de.charite.compbio.jannovar.jar db-list [options]\n\n").toString();
>, <Line: -		System.err.print(HEADER);
>, <Line: -		HelpFormatter hf = new HelpFormatter();
>, <Line: -		PrintWriter pw = new PrintWriter(System.err, true);
>, <Line: -		hf.printOptions(pw, 78, options, 2, 2);
>, <Line: -	}
>, <Line: -}
>]