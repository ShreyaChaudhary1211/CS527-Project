[]
[<Line: -package de.charite.compbio.jped;
>, <Line: -import com.google.common.collect.ImmutableSet;
>, <Line: -import de.charite.compbio.jannovar.JannovarException;
>, <Line: -import de.charite.compbio.jannovar.data.JannovarData;
>, <Line: -import de.charite.compbio.jannovar.filter.CoordinateSortChecker;
>, <Line: -import de.charite.compbio.jannovar.filter.FilterException;
>, <Line: -import de.charite.compbio.jannovar.filter.FlaggedVariant;
>, <Line: -import de.charite.compbio.jannovar.filter.GeneWiseInheritanceFilter;
>, <Line: -import de.charite.compbio.jannovar.filter.VariantContextFilter;
>, <Line: -import de.charite.compbio.jannovar.filter.VariantWiseInheritanceFilter;
>, <Line: -import de.charite.compbio.jannovar.filter.WriterFilter;
>, <Line: -import de.charite.compbio.jannovar.pedigree.ModeOfInheritance;
>, <Line: -import de.charite.compbio.jannovar.pedigree.Pedigree;
>, <Line: -import htsjdk.variant.variantcontext.VariantContext;
>, <Line: -import htsjdk.variant.variantcontext.writer.VariantContextWriter;
>, <Line: -import htsjdk.variant.vcf.VCFFileReader;
>, <Line: -public class FilteredWriter {
>, <Line: -	/** Pedigree */
>, <Line: -	private final Pedigree pedigree;
>, <Line: -	/** Jannovar DB */
>, <Line: -	private final JannovarData jannovarDB;
>, <Line: -	/** mode of inheritance */
>, <Line: -	private final ImmutableSet<ModeOfInheritance> modeOfInheritances;
>, <Line: -	/** source of {@link VariantContext} objects */
>, <Line: -	private final VCFFileReader source;
>, <Line: -	/** sink for {@link VariantContext} objects */
>, <Line: -	private final VariantContextWriter sink;
>, <Line: -	public FilteredWriter(Pedigree pedigree, ImmutableSet<ModeOfInheritance> modeOfInheritances,
>, <Line: -			JannovarData jannovarDB, VCFFileReader source, VariantContextWriter sink) {
>, <Line: -		this.pedigree = pedigree;
>, <Line: -		this.modeOfInheritances = modeOfInheritances;
>, <Line: -		this.jannovarDB = jannovarDB;
>, <Line: -		this.source = source;
>, <Line: -		this.sink = sink;
>, <Line: -	}
>, <Line: -	void run(JPedOptions options) throws JannovarException {
>, <Line: -		// public GeneWiseInheritanceFilter(Pedigree pedigree, JannovarData jannovarDB, ModeOfInheritance
>, <Line: -		// modeOfInheritance,
>, <Line: -		// ImmutableList<String> names, VariantContextFilter next) {
>, <Line: -		VariantContextFilter topFilter = new WriterFilter(sink);
>, <Line: -		if (options.geneWise)
>, <Line: -			topFilter = new GeneWiseInheritanceFilter(pedigree, jannovarDB, modeOfInheritances, topFilter);
>, <Line: -		else
>, <Line: -			topFilter = new VariantWiseInheritanceFilter(pedigree, modeOfInheritances, topFilter);
>, <Line: -		topFilter = new CoordinateSortChecker(topFilter);
>, <Line: -		try {
>, <Line: -			for (VariantContext vc : source)
>, <Line: -				topFilter.put(new FlaggedVariant(vc));
>, <Line: -			topFilter.finish();
>, <Line: -		} catch (FilterException e) {
>, <Line: -			throw new JannovarException("Problem in the filtration.", e);
>, <Line: -		}
>, <Line: -	}
>, <Line: -}
>]