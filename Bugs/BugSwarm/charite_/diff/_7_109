[<Line: +package de.charite.compbio.jannovar.mendel.filter;
>, <Line: + * Check that the VCF file is sorted by coordinate
>, <Line: + * In case of problems, {@link #put} throws a {@link VariantContextFilterException}.
>, <Line: +public class CoordinateSortingChecker implements VariantContextProcessor {
>, <Line: +	/** Next pipeline step */
>, <Line: +	VariantContextProcessor sink;
>, <Line: +	public CoordinateSortingChecker(VariantContextProcessor sink) {
>, <Line: +		this.sink = sink;
>, <Line: +	public void put(VariantContext vc) throws VariantContextFilterException {
>, <Line: +		// Perform sortedness check and throw exception otherwise
>, <Line: +					throw new VariantContextFilterException("Unsorted VCF file, seen " + vc.getContig() + " twice!");
>, <Line: +					throw new VariantContextFilterException("Unsorted VCF file, seen " + vc.getStart() + " < " + prevVC.getStart());
>, <Line: +		// Pass through to next filter
>, <Line: +		sink.put(vc);
>, <Line: +		// Update prevVC reference
>, <Line: +	public void close() {
>, <Line: +		sink.close();
>]
[<Line: -package de.charite.compbio.jannovar.filter;
>, <Line: - * Check that the VCF file is sorted by coordinate.
>, <Line: - * In case of problems, {@link #put} throws a {@link FilterException}.
>, <Line: -public class CoordinateSortChecker implements VariantContextFilter {
>, <Line: -	/** next filter in pipeline */
>, <Line: -	VariantContextFilter nextFilter;
>, <Line: -	public CoordinateSortChecker(VariantContextFilter filter) {
>, <Line: -		this.nextFilter = filter;
>, <Line: -	public void put(FlaggedVariant fv) throws FilterException {
>, <Line: -		VariantContext vc = fv.getVC();
>, <Line: -		// perform sortedness check and throw exception otherwise
>, <Line: -					throw new FilterException("Unsorted VCF file, seen " + vc.getContig() + " twice!");
>, <Line: -					throw new FilterException("Unsorted VCF file, seen " + vc.getStart() + " < " + prevVC.getStart());
>, <Line: -		// pass through to next filter
>, <Line: -		nextFilter.put(fv);
>, <Line: -		// update prevVC reference
>, <Line: -	public void finish() throws FilterException {
>, <Line: -		nextFilter.finish();
>]