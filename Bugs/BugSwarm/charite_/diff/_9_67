[<Line: +package de.charite.compbio.jannovar.vardbs.generic_tsv;
>, <Line: +import com.google.common.collect.ImmutableList;
>, <Line: +import com.google.common.io.Files;
>, <Line: +import de.charite.compbio.jannovar.utils.ResourceUtils;
>, <Line: +import de.charite.compbio.jannovar.vardbs.base.DBAnnotationOptions.MultipleMatchBehaviour;
>, <Line: +import htsjdk.variant.vcf.VCFFileReader;
>, <Line: +import htsjdk.variant.vcf.VCFHeaderLineType;
>, <Line: +import java.io.File;
>, <Line: +import java.io.PrintWriter;
>, <Line: +import java.util.HashMap;
>, <Line: +import java.util.Map;
>, <Line: +import org.junit.Before;
>, <Line: +/**
>, <Line: + * Test base for generic TSV annotation, using part of dbNSFP (shifted 69k bases towards the left).
>, <Line: + * 
>, <Line: + * @author <a href="mailto:manuel.holtgrewe@bihealth.de">Manuel Holtgrewe</a>
>, <Line: + */
>, <Line: +public class GenericTSVAnnotationDriverWithDbnsfpBaseTest {
>, <Line: +	protected String genericTsvPath;
>, <Line: +	protected String fastaPath;
>, <Line: +	protected GenericTSVAnnotationOptions options;
>, <Line: +	// File to annotate
>, <Line: +	protected VCFFileReader vcfReader;
>, <Line: +	@Before
>, <Line: +	public void setUp() throws Exception {
>, <Line: +		// Setup dbSNP VCF file
>, <Line: +		File tmpDir = Files.createTempDir();
>, <Line: +		genericTsvPath = tmpDir + "/dbNSFP.tsv.gz";
>, <Line: +		ResourceUtils.copyResourceToFile("/dbNSFP3.4a_variant.fake.tsv.gz",
>, <Line: +				new File(genericTsvPath));
>, <Line: +		String tbiPath = tmpDir + "/dbNSFP.tsv.gz.tbi";
>, <Line: +		ResourceUtils.copyResourceToFile("/dbNSFP3.4a_variant.fake.tsv.gz.tbi", new File(tbiPath));
>, <Line: +		// Setup reference FASTA file
>, <Line: +		fastaPath = tmpDir + "/chr1.fasta";
>, <Line: +		ResourceUtils.copyResourceToFile("/chr1.fasta", new File(fastaPath));
>, <Line: +		String faiPath = tmpDir + "/chr1.fasta.fai";
>, <Line: +		ResourceUtils.copyResourceToFile("/chr1.fasta.fai", new File(faiPath));
>, <Line: +		// Construct options
>, <Line: +		Map<String, GenericTSVValueColumnDescription> descriptions = new HashMap<>();
>, <Line: +		descriptions.put("AAREF",
>, <Line: +				new GenericTSVValueColumnDescription(5, VCFHeaderLineType.Character, "AAREF",
>, <Line: +						"Reference amino acid", GenericTSVAccumulationStrategy.CHOOSE_FIRST));
>, <Line: +		descriptions.put("RS_DBSNP147",
>, <Line: +				new GenericTSVValueColumnDescription(7, VCFHeaderLineType.String, "RS_DBSNP147",
>, <Line: +						"ID in dbSNP v147", GenericTSVAccumulationStrategy.CHOOSE_FIRST));
>, <Line: +		descriptions.put("HG19POS",
>, <Line: +				new GenericTSVValueColumnDescription(9, VCFHeaderLineType.Integer, "HG19POS",
>, <Line: +						"Position in hg19", GenericTSVAccumulationStrategy.CHOOSE_FIRST));
>, <Line: +		descriptions.put("SIFT_SCORE",
>, <Line: +				new GenericTSVValueColumnDescription(24, VCFHeaderLineType.Float, "SIFT_SCORE",
>, <Line: +						"Sift Score", GenericTSVAccumulationStrategy.CHOOSE_MAX));
>, <Line: +		this.options = new GenericTSVAnnotationOptions(true, false, "DBNSFP_",
>, <Line: +				MultipleMatchBehaviour.BEST_ONLY, new File(genericTsvPath),
>, <Line: +				GenericTSVAnnotationTarget.VARIANT, true, 1, 2, 2, 3, 4, true,
>, <Line: +				ImmutableList.of("AAREF", "RS_DBSNP147", "HG19POS", "SIFT_SCORE"), descriptions);
>, <Line: +		options.setReportOverlapping(true);
>, <Line: +		options.setReportOverlappingAsMatching(false);
>, <Line: +		// Write out file to use in the test
>, <Line: +		String vcfHeader = "##fileformat=VCFv4.0\n"
>, <Line: +				+ "#CHROM\tPOS\tID\tREF\tALT\tQUAL\tFILTER\tINFO\tFORMAT\tindividual\n";
>, <Line: +		String testVCFPath = tmpDir + "/test_var_in_dbnsfp_tsv.vcf";
>, <Line: +		PrintWriter writer = new PrintWriter(testVCFPath);
>, <Line: +		writer.write(vcfHeader);
>, <Line: +		writer.write("1\t119\t.\tT\tA,C,G\t.\t.\t.\tGT\t0/1\n");
>, <Line: +		writer.close();
>, <Line: +		vcfReader = new VCFFileReader(new File(testVCFPath), false);
>, <Line: +	}
>, <Line: +}
>]
[]