[<Line: +import com.googlecode.mp4parser.DataSource;
>, <Line: +import com.googlecode.mp4parser.MemoryDataSourceImpl;
>, <Line: +import static com.googlecode.mp4parser.util.CastUtils.l2i;
>, <Line: +    private boolean isFullBox = true; // default is fullbox cause that's what ISO defines, simple box is apple specifc
>, <Line: +    public MetaBox() {
>, <Line: +        super(TYPE);
>, <Line: +    }
>, <Line: +        ByteBuffer bb = ByteBuffer.allocate(l2i(contentSize));
>, <Line: +        bb.position(4);
>, <Line: +        String isHdlr = IsoTypeReader.read4cc(bb);
>, <Line: +        if ("hdlr".equals(isHdlr)) {
>, <Line: +            isFullBox = false;
>, <Line: +            initContainer(new MemoryDataSourceImpl((ByteBuffer) bb.rewind()), contentSize, boxParser);
>, <Line: +            // we got apple specifc box here
>, <Line: +        } else {
>, <Line: +            isFullBox = true;
>, <Line: +            parseVersionAndFlags((ByteBuffer) bb.rewind());
>, <Line: +            initContainer(new MemoryDataSourceImpl(bb), contentSize - 4, boxParser);
>, <Line: +        }
>, <Line: +        if (isFullBox) {
>, <Line: +            ByteBuffer bb = ByteBuffer.allocate(4);
>, <Line: +            writeVersionAndFlags(bb);
>, <Line: +            writableByteChannel.write((ByteBuffer) bb.rewind());
>, <Line: +        }
>, <Line: +        long t = 0; // bytes to container start
>, <Line: +        if (isFullBox) {
>, <Line: +            t += 4;
>, <Line: +        }
>]
[<Line: -import com.googlecode.mp4parser.DataSource;
>, <Line: -    public MetaBox() {
>, <Line: -        super(TYPE);
>, <Line: -    }
>, <Line: -        ByteBuffer bb = ByteBuffer.allocate(4);
>, <Line: -        parseVersionAndFlags((ByteBuffer) bb.rewind());
>, <Line: -        initContainer(dataSource, contentSize - 4, boxParser);
>, <Line: -        ByteBuffer bb = ByteBuffer.allocate(4);
>, <Line: -        writeVersionAndFlags(bb);
>, <Line: -        writableByteChannel.write((ByteBuffer) bb.rewind());
>, <Line: -        long t = 4; // bytes to container start
>]