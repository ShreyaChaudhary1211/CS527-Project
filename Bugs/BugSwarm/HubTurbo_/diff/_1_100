[]
[<Line: -package service;
>, <Line: -import java.io.IOException;
>, <Line: -import java.util.ArrayList;
>, <Line: -import java.util.List;
>, <Line: -import org.apache.logging.log4j.LogManager;
>, <Line: -import org.apache.logging.log4j.Logger;
>, <Line: -import org.eclipse.egit.github.core.Comment;
>, <Line: -import ui.UI;
>, <Line: -import ui.components.HTStatusBar;
>, <Line: -public class UpdatedIssueMetadata {
>, <Line: -	private static final Logger logger = LogManager.getLogger(UpdatedIssueMetadata.class.getName());
>, <Line: -	private final ServiceManager serviceManager;
>, <Line: -	public UpdatedIssueMetadata(ServiceManager serviceManager) {
>, <Line: -		this.serviceManager = serviceManager;
>, <Line: -	}
>, <Line: -	public void download() {
>, <Line: -		downloadComments();
>, <Line: -		HTStatusBar.addProgressAndDisplayMessage(ModelUpdate.PROGRESS_INTERVAL, "Updating events...");
>, <Line: -		downloadEvents();
>, <Line: -		HTStatusBar.addProgress(ModelUpdate.PROGRESS_INTERVAL);
>, <Line: -	}
>, <Line: -	public void downloadEvents() {
>, <Line: -		int issueCount = 0;
>, <Line: -		for (Integer issueId : UI.getInstance().getColumnControl().getUpdatedIssues()) {
>, <Line: -			++issueCount;
>, <Line: -			List<TurboIssueEvent> events = new ArrayList<>();
>, <Line: -			try {
>, <Line: -				events = serviceManager.getEvents(issueId);
>, <Line: -			} catch (IOException e) {
>, <Line: -				logger.error(e.getLocalizedMessage(), e);
>, <Line: -			}
>, <Line: -			serviceManager.getModel().getIssueWithId(issueId).setEvents(events);
>, <Line: -		}
>, <Line: -		logger.info("Downloaded events for " + issueCount + " issues");
>, <Line: -	}
>, <Line: -	public void downloadComments() {
>, <Line: -		int issueCount = 0;
>, <Line: -		for (Integer issueId : UI.getInstance().getColumnControl().getUpdatedIssues()) {
>, <Line: -			++issueCount;
>, <Line: -			List<Comment> comments = new ArrayList<>();
>, <Line: -			try {
>, <Line: -				comments = serviceManager.getLatestComments(issueId);
>, <Line: -			} catch (IOException e) {
>, <Line: -				logger.error(e.getLocalizedMessage(), e);
>, <Line: -			}
>, <Line: -			serviceManager.getModel().getIssueWithId(issueId).setComments(comments);
>, <Line: -		}
>, <Line: -		logger.info("Downloaded comments for " + issueCount + " issues");
>, <Line: -	}
>, <Line: -}
>]