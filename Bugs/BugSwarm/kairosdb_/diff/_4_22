[]
[<Line: -package org.kairosdb.datastore.remote;
>, <Line: -import com.google.common.collect.ImmutableSortedMap;
>, <Line: -import com.google.inject.Inject;
>, <Line: -import org.kairosdb.core.DataPoint;
>, <Line: -import org.kairosdb.core.DataPointListener;
>, <Line: -import org.kairosdb.core.exception.DatastoreException;
>, <Line: -import org.slf4j.Logger;
>, <Line: -import org.slf4j.LoggerFactory;
>, <Line: -import java.util.SortedMap;
>, <Line: -/**
>, <Line: - Created by bhawkins on 8/29/16.
>, <Line: - */
>, <Line: -public class RemoteListener implements DataPointListener
>, <Line: -{
>, <Line: -	public static final Logger logger = LoggerFactory.getLogger(RemoteListener.class);
>, <Line: -	private final RemoteDatastore m_remoteDatastore;
>, <Line: -	@Inject
>, <Line: -	public RemoteListener(RemoteDatastore remoteDatastore)
>, <Line: -	{
>, <Line: -		m_remoteDatastore = remoteDatastore;
>, <Line: -	}
>, <Line: -	@Override
>, <Line: -	public void dataPoint(String metricName, SortedMap<String, String> tags, DataPoint dataPoint)
>, <Line: -	{
>, <Line: -		try
>, <Line: -		{
>, <Line: -			m_remoteDatastore.putDataPoint(metricName,
>, <Line: -					ImmutableSortedMap.copyOfSorted(tags), dataPoint, 0);
>, <Line: -		}
>, <Line: -		catch (DatastoreException e)
>, <Line: -		{
>, <Line: -			logger.error("Error writing to remote datastore", e);
>, <Line: -		}
>, <Line: -	}
>, <Line: -}
>]