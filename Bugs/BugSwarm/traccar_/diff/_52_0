[<Line: +        if (fuelDropThreshold > 0) {
>, <Line: +            Position lastPosition = Context.getIdentityManager().getLastPosition(position.getDeviceId());
>, <Line: +            if (position.getAttributes().containsKey(Position.KEY_FUEL_LEVEL)
>, <Line: +                    && lastPosition != null && lastPosition.getAttributes().containsKey(Position.KEY_FUEL_LEVEL)) {
>, <Line: +                double drop = lastPosition.getDouble(Position.KEY_FUEL_LEVEL)
>, <Line: +                        - position.getDouble(Position.KEY_FUEL_LEVEL);
>, <Line: +                if (drop >= fuelDropThreshold) {
>, <Line: +                    Event event = new Event(Event.TYPE_DEVICE_FUEL_DROP, position.getDeviceId(), position.getId());
>, <Line: +                    event.set(ATTRIBUTE_FUEL_DROP_THRESHOLD, fuelDropThreshold);
>, <Line: +                    return Collections.singleton(event);
>, <Line: +                }
>]
[<Line: -        Position lastPosition = Context.getIdentityManager().getLastPosition(position.getDeviceId());
>, <Line: -        if (position.getAttributes().containsKey(Position.KEY_FUEL_LEVEL)
>, <Line: -                && lastPosition != null && lastPosition.getAttributes().containsKey(Position.KEY_FUEL_LEVEL)) {
>, <Line: -            double drop = lastPosition.getDouble(Position.KEY_FUEL_LEVEL) - position.getDouble(Position.KEY_FUEL_LEVEL);
>, <Line: -            if (drop >= fuelDropThreshold) {
>, <Line: -                Event event = new Event(Event.TYPE_DEVICE_FUEL_DROP, position.getDeviceId(), position.getId());
>, <Line: -                event.set(ATTRIBUTE_FUEL_DROP_THRESHOLD, fuelDropThreshold);
>, <Line: -                return Collections.singleton(event);
>]