diff --git a/Codec_5/buggy/.defects4j.config b/Codec_5/fixed/.defects4j.config
index 1eace50..4503b41 100644
--- a/Codec_5/buggy/.defects4j.config
+++ b/Codec_5/fixed/.defects4j.config
@@ -1,3 +1,3 @@
 #File automatically generated by Defects4J
 pid=Codec
-vid=5b
+vid=5f
diff --git a/Codec_5/buggy/.git/HEAD b/Codec_5/fixed/.git/HEAD
index 37390c8..f3674e9 100644
--- a/Codec_5/buggy/.git/HEAD
+++ b/Codec_5/fixed/.git/HEAD
@@ -1 +1 @@
-ffac23ba762a093f160751eb4ef67192e666c007
+cf938e23c9a07fc764f52838574eb4c69f648c68
diff --git a/Codec_5/buggy/.git/index b/Codec_5/fixed/.git/index
index 5a55b2d..9d62d4a 100644
Binary files a/Codec_5/buggy/.git/index and b/Codec_5/fixed/.git/index differ
diff --git a/Codec_5/buggy/.git/logs/HEAD b/Codec_5/fixed/.git/logs/HEAD
index db71a8b..9aeeb59 100644
--- a/Codec_5/buggy/.git/logs/HEAD
+++ b/Codec_5/fixed/.git/logs/HEAD
@@ -7,3 +7,4 @@ cf938e23c9a07fc764f52838574eb4c69f648c68 ffac23ba762a093f160751eb4ef67192e666c00
 ffac23ba762a093f160751eb4ef67192e666c007 33cd394ec3b7ca9795c372ae28d15bad776ce496 defects4j <defects4j@localhost> 1709003989 -0800	checkout: moving from ffac23ba762a093f160751eb4ef67192e666c007 to D4J_Codec_5_POST_FIX_REVISION
 33cd394ec3b7ca9795c372ae28d15bad776ce496 55adb2e57ac133603b283bbc76a051eb818b4670 defects4j <defects4j@localhost> 1709003989 -0800	commit: D4J_Codec_5_PRE_FIX_REVISION
 55adb2e57ac133603b283bbc76a051eb818b4670 ffac23ba762a093f160751eb4ef67192e666c007 defects4j <defects4j@localhost> 1709003989 -0800	checkout: moving from 55adb2e57ac133603b283bbc76a051eb818b4670 to D4J_Codec_5_BUGGY_VERSION
+ffac23ba762a093f160751eb4ef67192e666c007 cf938e23c9a07fc764f52838574eb4c69f648c68 defects4j <defects4j@localhost> 1709003989 -0800	checkout: moving from ffac23ba762a093f160751eb4ef67192e666c007 to D4J_Codec_5_FIXED_VERSION
diff --git a/Codec_5/buggy/src/java/org/apache/commons/codec/binary/Base64.java b/Codec_5/fixed/src/java/org/apache/commons/codec/binary/Base64.java
index 2618e5d..19a6959 100644
--- a/Codec_5/buggy/src/java/org/apache/commons/codec/binary/Base64.java
+++ b/Codec_5/fixed/src/java/org/apache/commons/codec/binary/Base64.java
@@ -583,6 +583,9 @@ public class Base64 implements BinaryEncoder, BinaryDecoder {
         // EOF (-1) and first time '=' character is encountered in stream.
         // This approach makes the '=' padding characters completely optional.
         if (eof && modulus != 0) {
+            if (buffer == null || buffer.length - pos < decodeSize) {
+                resizeBuffer();
+            }
             
             x = x << 6;
             switch (modulus) {
